{"version":3,"sources":["webpack://adEngine/webpack/bootstrap","webpack://adEngine/external \"babel-runtime/helpers/createClass\"","webpack://adEngine/external \"babel-runtime/helpers/classCallCheck\"","webpack://adEngine/external \"babel-runtime/core-js/object/get-prototype-of\"","webpack://adEngine/external \"babel-runtime/helpers/possibleConstructorReturn\"","webpack://adEngine/external \"babel-runtime/helpers/inherits\"","webpack://adEngine/external \"babel-runtime/core-js/object/keys\"","webpack://adEngine/external \"babel-runtime/core-js/promise\"","webpack://adEngine/external \"babel-runtime/core-js/json/stringify\"","webpack://adEngine/external \"babel-runtime/helpers/slicedToArray\"","webpack://adEngine/external \"babel-runtime/core-js/object/assign\"","webpack://adEngine/external \"core-decorators\"","webpack://adEngine/external \"babel-runtime/core-js/object/get-own-property-descriptor\"","webpack://adEngine/external \"babel-runtime/helpers/typeof\"","webpack://adEngine/external \"babel-runtime/helpers/get\"","webpack://adEngine/external \"eventemitter3\"","webpack://adEngine/external \"babel-runtime/core-js/symbol\"","webpack://adEngine/external \"ismobilejs\"","webpack://adEngine/external \"babel-runtime/core-js/object/get-own-property-names\"","webpack://adEngine/external \"babel-runtime/core-js/map\"","webpack://adEngine/external \"blockadblock\"","webpack://adEngine/external \"lodash/get\"","webpack://adEngine/external \"lodash/set\"","webpack://adEngine/./src/utils/client.js","webpack://adEngine/./src/utils/dimensions.js","webpack://adEngine/./src/utils/flow-control.js","webpack://adEngine/./src/utils/lazy-queue.js","webpack://adEngine/./src/utils/query-string.js","webpack://adEngine/./src/utils/logger.js","webpack://adEngine/./src/utils/sampler.js","webpack://adEngine/./src/utils/script-loader.js","webpack://adEngine/./src/services/context-service.js","webpack://adEngine/./src/services/slot-service.js","webpack://adEngine/./src/services/events.js","webpack://adEngine/./src/services/btf-blocker-service.js","webpack://adEngine/./src/services/template-service.js","webpack://adEngine/./src/services/custom-ad-loader.js","webpack://adEngine/./src/services/local-cache.js","webpack://adEngine/./src/services/message-bus.js","webpack://adEngine/./src/providers/gpt-size-map.js","webpack://adEngine/./src/providers/gpt-targeting.js","webpack://adEngine/./src/models/ad-slot.js","webpack://adEngine/./src/video/vast-parser.js","webpack://adEngine/./src/video/vast-debugger.js","webpack://adEngine/./src/video/vast-url-builder.js","webpack://adEngine/./src/video/player/porvata/ima/google-ima-setup.js","webpack://adEngine/./src/video/player/porvata/moat/moat-video-tracker-script.js","webpack://adEngine/./src/video/player/porvata/moat/moat-video-tracker.js","webpack://adEngine/./src/video/player/porvata/ima/google-ima-player-factory.js","webpack://adEngine/./src/video/player/porvata/ima/google-ima.js","webpack://adEngine/./src/video/player/porvata/video-settings.js","webpack://adEngine/./src/video/player/porvata/porvata.js","webpack://adEngine/./src/video/player/porvata/index.js","webpack://adEngine/./src/video/index.js","webpack://adEngine/./src/listeners/porvata-listener.js","webpack://adEngine/./src/listeners/scroll-listener.js","webpack://adEngine/./src/listeners/slot-listener.js","webpack://adEngine/./src/listeners/index.js","webpack://adEngine/./src/bidders/base-bidder.js","webpack://adEngine/./src/bidders/prebid/adapters/base-adapter.js","webpack://adEngine/./src/bidders/prebid/adapters/aol.js","webpack://adEngine/./src/bidders/prebid/adapters/appnexus.js","webpack://adEngine/./src/bidders/prebid/adapters/appnexus-ast.js","webpack://adEngine/./src/bidders/prebid/adapters/appnexus-webads.js","webpack://adEngine/./src/bidders/prebid/adapters/audience-network.js","webpack://adEngine/./src/bidders/prebid/adapters/beachfront.js","webpack://adEngine/./src/bidders/prebid/adapters/index-exchange.js","webpack://adEngine/./src/bidders/prebid/adapters/onemobile.js","webpack://adEngine/./src/bidders/prebid/adapters/openx.js","webpack://adEngine/./src/bidders/prebid/adapters/pubmatic.js","webpack://adEngine/./src/bidders/prebid/prebid-helper.js","webpack://adEngine/./src/bidders/prebid/adapters/rubicon.js","webpack://adEngine/./src/bidders/prebid/adapters/rubicon-display.js","webpack://adEngine/./src/bidders/prebid/adapters/wikia.js","webpack://adEngine/./src/bidders/prebid/adapters/wikia-video.js","webpack://adEngine/./src/bidders/prebid/adapters-registry.js","webpack://adEngine/./src/bidders/prebid/price-helper.js","webpack://adEngine/./src/bidders/prebid/prebid-settings.js","webpack://adEngine/./src/bidders/prebid/index.js","webpack://adEngine/./src/bidders/index.js","webpack://adEngine/./src/providers/gpt-provider.js","webpack://adEngine/./src/providers/index.js","webpack://adEngine/./src/services/slot-tweaker.js","webpack://adEngine/./src/services/slot-data-params-updater.js","webpack://adEngine/./src/services/slot-repeater.js","webpack://adEngine/./src/services/tracking-opt-in.js","webpack://adEngine/./src/services/index.js","webpack://adEngine/./src/utils/string-builder.js","webpack://adEngine/./src/utils/try-property.js","webpack://adEngine/./src/utils/viewport-observer.js","webpack://adEngine/./src/utils/index.js","webpack://adEngine/./src/templates/floating-ad.js","webpack://adEngine/./src/ad-engine.js","webpack://adEngine/./src/index.js","webpack://adEngine/./lib/prebid.min.js"],"names":["bab","browser","isMobile","operatingSystem","getIsMobile","userAgent","window","navigator","isMobileJs","device","phone","tablet","isSmartphone","isTablet","enabled","disabled","BlockAdBlock","checkOnLoad","resetOnEnd","loopCheckTime","loopMaxNumber","onDetected","onNotDetected","check","indexOf","appName","appVersion","temp","matches","match","test","exec","slice","join","replace","splice","client","getTopOffset","element","elementWindow","ownerDocument","defaultView","currentElement","hideAgain","topPos","classList","contains","remove","offsetTop","offsetParent","add","frameElement","getViewportHeight","Math","max","document","documentElement","clientHeight","innerHeight","isInViewport","topOffset","bottomOffset","alwaysInViewportPositions","elementPosition","getComputedStyle","position","includes","elementHeight","offsetHeight","elementTop","elementBottom","scrollPosition","scrollY","viewportHeight","viewportTop","viewportBottom","wait","milliseconds","resolve","reject","Error","setTimeout","defer","fn","args","emitter","eventName","options","isObject","hasAddEventListener","addEventListener","hasOnce","once","capture","makeLazyQueue","queue","callback","Array","start","length","shift","push","item","input","path","location","search","substr","queryParameters","queryString","split","forEach","pair","id","value","decodeURIComponent","key","getValues","debugGroup","get","groups","console","info","logger","logGroup","logValues","isSamplingIgnored","name","ignored","getRandomInt","min","floor","random","sampling","sampler","src","type","isAsync","node","script","createElement","body","lastChild","async","parentNode","insertBefore","createScript","onload","onerror","scriptLoader","contextObject","adUnitId","events","delayModules","listeners","porvata","slot","customAdLoader","globalMethodName","maxDelayTimeout","video","moatTracking","partnerCode","slotRepeater","trackingOptIn","slots","state","adStack","targeting","vast","size","onChangeCallbacks","runCallbacks","trigger","newValue","triggerOnChange","segments","seg","segmentsCount","lastKey","i","undefined","__useDefault","newContext","segment","array","context","groupName","slotStates","slotStatuses","isSlotInTheSameViewport","slotHeight","slotOffset","elementId","getElementById","elementOffset","isFirst","distance","adSlot","slotName","getSlotName","disable","enable","setState","status","hasDefinedViewportConflicts","getElement","hasConflict","getViewportConflicts","some","slotService","PAGE_CHANGE_EVENT","PAGE_RENDER_EVENT","emit","event","hasEvent","filter","disableBtf","adSlotKey","slotConfig","aboveTheFold","unblockedSlots","resetState","slotsQueue","atfEnded","fillInCallback","ads","runtime","onRenderEnded","isAboveTheFold","finishAboveTheFold","on","call","wrappedFillInCallback","hasViewportConflict","isEnabled","getStatus","btfBlockerService","templates","template","customConfig","getName","config","getDefaultConfig","set","params","init","templateService","registerCustomAdLoader","methodName","canUseStorage","localStorage","setItem","removeItem","e","LocalCache","createPolyfill","exception","Storage","prototype","data","val","String","getItem","clear","cacheItem","JSON","parse","isExpired","delete","expires","isStorable","expiresValue","parseInt","isNaN","Date","now","localCache","callbacks","isAdEngineMessage","message","AdEngine","messageMatch","matching","keys","onMessage","infinite","messageBus","sizeMap","viewportSize","sizes","builder","googletag","sizeMapping","addSize","build","GptSizeMap","map","index","mappedSizes","setupGptTargeting","tag","pubads","setTargetingValue","setTargeting","onChange","ad","viewed","pos","AdSlot","SLOT_VIEWED_EVENT","adUnit","stringBuilder","videoAdUnit","defaultSizes","viewportConflicts","slotListener","emitStatusChanged","repeat","setStatus","slotTweaker","show","defaultTemplate","hide","PROPERTY_CHANGED_EVENT","VIDEO_VIEWED_EVENT","imaAd","adInfo","lineItemId","getAdId","creativeId","getCreativeId","contentType","getContentType","getWrapperAdIds","getWrapperCreativeIds","vastUrl","extra","currentAd","getAdInfo","vastParams","customParams","encodeURI","cust_params","vpos","sz","vastParser","setAttribute","attribute","setVastAttributesFromVastParams","vastDebugger","availableVideoPositions","baseUrl","correlator","round","getCustomParameters","extraTargeting","getTargeting","encodeURIComponent","isNumeric","n","parseFloat","isFinite","buildVastUrl","aspectRatio","href","getVideoAdUnit","contentSourceId","videoId","numberOfAds","isOptedIn","getOverriddenVast","vastXML","createRequest","adsRequest","google","ima","AdsRequest","overriddenVast","vastResponse","adsResponse","setConfigProperty","autoPlay","adTagUrl","width","height","vastTargeting","linearAdSlotWidth","linearAdSlotHeight","getRenderingSettings","adsRenderingSettings","AdsRenderingSettings","maximumRecommendedBitrate","bitrate","loadVideoTimeout","enablePreloading","uiElements","googleImaSetup","eventMapping","moatapi","initMoatTracking","a","f","c","hasOwnProperty","g","O","adsManager","ids","imaSDK","complete","firstquartile","impression","loaded","midpoint","pause","skip","thirdquartile","volumeChange","d","h","AdEvent","Type","l","b","sendEvent","removeEventListener","func","adVolume","getVolume","k","parentWindow","m","appendChild","container","viewMode","slicer1","slicer2","error","moatVideoTracker","getVideoElement","videoElement","adDisplayContainer","adsLoader","isAdsManagerLoaded","mobileVideoAd","querySelector","eventListeners","getCurrentAd","playerElement","setVastAttributes","autoplay","muted","dispatchEvent","initialize","ViewMode","NORMAL","setAutoPlay","adRequest","destroy","contentComplete","setVastUrl","requestAds","isFullscreen","resize","FULLSCREEN","newStatus","googleImaPlayerFactory","create","videoSettings","getParams","player","getContainer","adsManagerLoadedEvent","renderingSettings","getAdsManager","setAdsManager","isMoatTrackingEnabled","imaLibraryUrl","load","loadScript","getPlayer","AdDisplayContainer","iframe","performance","navigation","TYPE_BACK_FORWARD","contentWindow","AdsLoader","googleIma","getMoatTrackingStatus","sample","VIDEO_FULLSCREEN_CLASS_NAME","STOP_SCROLLING_CLASS_NAME","prepareVideoAdContainer","videoAdContainer","nativeFullscreenOnElement","enter","tryProperty","exit","fullscreenChangeEvent","whichProperty","addChangeListener","removeChangeListener","isSupported","Boolean","nativeFullscreen","fullscreen","muteProtect","defaultVolume","onFullscreenChange","getRemainingTime","newWidth","newHeight","offsetWidth","playVideo","reload","innerWidth","resume","play","volume","updateVideoDOMElement","setVolume","toggleNativeFullscreen","isPlaying","isMuted","mute","restartOnUnmute","rewind","unmute","stop","listener","viewportObserver","addListener","viewportOffsetTop","offsetBottom","viewportOffsetBottom","porvataListener","adProduct","withAudio","isFirstPlay","autoPaused","autoPlayed","viewportListenerId","muteFirstPlay","passback","then","inViewportCallback","isVisible","blockOutOfViewportPausing","setupAutoPlayMethod","Porvata","addOnViewportChangeListener","registerVideoEvents","toggleFullscreen","removeListener","onReady","getListeners","PorvataListener","LOG_GROUP","dispatch","EVENTS","eventKey","errorCode","getError","getErrorCode","getData","onEvent","viewable_impression","ad_error_code","ad_product","getOperatingSystem","getBrowser","content_type","creative_id","event_name","line_item_id","PLAYER_NAME","timestamp","getTime","audio","adCanPlay","click","adError","wikiaAdPlayTriggered","wikiaAdStop","wikiaAdMute","wikiaAdUnmute","getUniqueId","toString","substring","pushSlot","requestAnimationFrameHandleAdded","requestAnimationFrame","threshold","addCallback","callbackId","pageYOffset","scrollTop","slotPosition","viewPortHeight","removeCallback","scrollListener","getIframe","getAdType","isIframeAccessible","isEmpty","AdEngine_adType","adType","page_width","scrollWidth","time_bucket","getHours","viewport_height","response","getResponseInformation","creative_size","slotDataParamsUpdater","updateOnRenderEnd","collapse","success","setDataParam","bidderConfig","resetListener","timeout","onResponse","onResponseCall","onResponseCallbacks","callBids","called","msToTimeout","race","getBestPrice","floorPrice","isSlotSupported","getTargetingParams","BaseBidder","responseCallback","createWithTimeout","hasResponse","addResponseListener","prepareConfigForAdUnit","bidderName","network","code","placement","alias","sizeId","mediaTypes","banner","bids","bidder","placements","placementId","getPlacement","vertical","aliases","appnexus","debugPlacementId","isDebugMode","playerSize","skippable","playback_method","priority","testMode","bidfloor","debugAppId","appId","ix","siteId","dcn","delDomain","unit","publisherId","lazyLoadSlots","isSlotAvailable","lazyLoad","available","isSlotLazy","setupAdUnits","adaptersConfig","adUnits","adapters","getAdapters","adapter","adapterAdUnits","prepareAdUnits","provider","s1","s0","s2","lang","accountId","zoneId","mediaType","inventory","playerWidth","playerHeight","size_id","language","rubicon","pageTargeting","keywords","price","getPrice","supportedMediaTypes","bidRequest","addBidResponse","done","pbjs","que","addBids","bid","createBid","bidResponse","getCreative","bidderCode","cpm","ttl","adUnitCode","creative","style","background","color","fontFamily","textAlign","title","innerText","fontWeight","margin","paddingTop","details","outerHTML","customAdapters","availableAdapters","aol","appnexusAst","appnexusWebads","audienceNetwork","beachfront","indexExchange","onemobile","openx","pubmatic","rubiconDisplay","RubiconDisplay","registerAliases","aliasMap","aliasBidder","setupAdapters","bidders","setupCustomAdapters","wikia","wikiaVideo","registerBidAdapter","getPriorities","priorities","isValidPrice","getStatusCode","Prebid","validResponseStatusCode","getPrebidBestPrice","bestPrices","getBidResponsesForAdUnitCode","slotBids","cpmPrice","transformPriceFromCpm","toFixed","maxCpm","defaultCpm","result","getSettings","standard","alwaysUseBid","adserverTargeting","adId","isCMPEnabled","prebidConfig","debug","enableSendAllBids","bidderSequence","bidderTimeout","userSync","iframeEnabled","enabledBidders","syncDelay","consentManagement","cmpApi","allowAuctionWithoutConsent","setConfig","bidsBackHandler","bidderSettings","removeAdUnits","requestBids","removeAdUnit","slotParams","bidParams","param","timeToRespond","errorResponseStatusCode","require","bidIndex","a9","char","prebid","bidderMarker","biddersRegistry","getBidParameters","wasCalled","prebidPrices","getSlotBestPrice","apply","getSlotTargetingParams","updateBidderMarker","getCurrentSlotPrices","slotPrices","priceFromBidder","bidMarker","gptLazyMethod","decoratedGptLazyMethod","cmd","method","definedSlots","initialized","configure","enableSingleRequest","disableInitialLoad","getSlotElementId","emitRenderEnded","emitImpressionViewable","enableServices","decorate","setupNonPersonalizedAds","doNotDestroyGptSlots","destroySlots","updateCorrelator","setRequestNonPersonalizedAds","parseTargetingParams","getSizes","gptSlot","defineSlot","getAdUnit","getDefaultSizes","addService","setCollapseEmptyDiv","defineSizeMapping","applyTargetingParams","updateOnCreate","bidderTargeting","display","flush","refresh","gptSlots","slotNames","allSlots","getSlots","slotsToDestroy","slotId","destroyGptSlots","domElement","maxHeight","scrollHeight","forceRepaint","slotContainer","parentElement","paddingBottom","readyState","register","action","expand","makeResponsive","attrName","dataset","findNextSiblingForSlot","previousSlotElement","elements","minimalPosition","previousSiblingIndex","insertNewSlotContainer","nextSibling","additionalClasses","className","insertFakePlaceholderAfterLastSelector","lastElement","placeholder","buildString","pattern","definition","repeatSlot","newSlotDefinition","getCopy","repeatConfig","slotNamePattern","limit","updateProperties","querySelectorAll","insertBeforeSelector","isRepeatable","isOptInByQueryParam","string","parameters","fallbackValue","keySegments","obj","properties","property","propertyValue","bind","updateInViewport","newInViewport","inViewport","updateCallback","listenerId","slotNode","containerOffset","end","space","previousElementSibling","fillInUsingProvider","fillIn","getPromises","module","getPromise","extend","providers","gpt","started","promises","startAdQueue","clearTimeout","maxTimeout","all","alert","setupProviders","registerMessageListener","runAdQueue","pushOnScrollQueue","addSlot","versionField","warn"],"mappings":"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AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,2BAA2B;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA,mCAAmC,0BAA0B,EAAE;AAC/D,yCAAyC,eAAe;AACxD;AACA;AACA;AACA;AACA;AACA,8DAA8D,+DAA+D;AAC7H;AACA;AACA;AACA;AACA;AACA,kDAAkD,oBAAoB,WAAW;AACjF;AACA;AACA;AACA,UAAU;AACV;AACA;;AAEA;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;;AAED,mDAAmD,gBAAgB,sBAAsB,OAAO,2BAA2B,0BAA0B,yDAAyD,2BAA2B,EAAE,EAAE,EAAE,eAAe;;AAE9P,oGAAoG,mBAAmB,EAAE,mBAAmB,8HAA8H;;AAE1Q;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,2CAA2C,kBAAkB,kCAAkC,qEAAqE,EAAE,EAAE,OAAO,kBAAkB,EAAE,YAAY;;AAE/M;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uDAAuD;AACvD;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,2CAA2C;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,aAAa,qBAAqB;AAClC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY,oBAAoB;AAChC,YAAY,cAAc;AAC1B;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,uBAAuB,qBAAqB;AAC5C;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,0CAA0C,+BAA+B;AACzE;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,8BAA8B,eAAe;AAC7C;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,YAAY,eAAe;AAC3B,YAAY,SAAS;AACrB,YAAY,KAAK;AACjB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,iBAAiB,8BAA8B;AAC/C;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,EAAE;AACb,WAAW,OAAO;AAClB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,EAAE;AACb,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,aAAa,QAAQ;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,aAAa;AACxB,WAAW,6BAA6B;AACxC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,UAAU,OAAO;AACjB;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,WAAW,aAAa;AACxB,WAAW,6BAA6B;AACxC,YAAY;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA,2CAA2C,SAAS,QAAQ,kBAAkB;AAC9E;AACA;AACA;;AAEA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,0PAA0P,UAAU,aAAa;AACjR;;AAEA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,WAAW,aAAa;AACxB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,0BAA0B,eAAe;AACzC;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,SAAS;AACpB;AACA,WAAW,IAAI;AACf;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB,aAAa,EAAE,UAAU,IAAI,aAAa,cAAc;AACxD;AACA;AACA;AACA;AACA;AACA,GAAG,IAAI;AACP;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,cAAc;AACzB,aAAa,EAAE;AACf;AACA;AACA;AACA;AACA;AACA;AACA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,IAAI;AACf;AACA;AACA;AACA;AACA;AACA;;AAEA,uKAAuK;AACvK;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA,GAAG;AACH,2CAA2C;AAC3C,GAAG,IAAI;AACP;;AAEA;AACA,aAAa,OAAO;AACpB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;;AAEA;AACA;AACA,WAAW,WAAW;AACtB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA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;AACA,8DAA8D,gDAAgD;AAC9G;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,2BAA2B,SAAS,cAAc;AAClD,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,WAAW;AACtB;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,aAAa;;AAExB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,OAAO;;AAEP;AACA;;AAEA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,gBAAgB,EAAE;AAC5D;AACA;AACA;AACA;AACA,CAAC;AACD;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;;AAEA;;AAEA;;AAEA;;AAEA,uCAAuC,6BAA6B,YAAY,EAAE,OAAO,iBAAiB,mBAAmB,uBAAuB,4EAA4E,EAAE,EAAE,sBAAsB,eAAe,EAAE;;AAE3Q,sCAAsC,uCAAuC,gBAAgB;;AAE7F;AACA;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,yBAAyB,4CAA4C;AACrE;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;AACP;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;;AAED,kCAAkC,iCAAiC,eAAe,eAAe,gBAAgB,oBAAoB,MAAM,0CAA0C,+BAA+B,aAAa,qBAAqB,mCAAmC,EAAE,EAAE,cAAc,WAAW,UAAU,EAAE,UAAU,MAAM,yCAAyC,EAAE,UAAU,kBAAkB,EAAE,EAAE,aAAa,EAAE,2BAA2B,0BAA0B,YAAY,EAAE,2CAA2C,8BAA8B,EAAE,OAAO,6EAA6E,EAAE,GAAG,EAAE;;AAErpB;AACA;AACA;AACA;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG,IAAI;AACP;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA,kCAAkC,iCAAiC,eAAe,eAAe,gBAAgB,oBAAoB,MAAM,0CAA0C,+BAA+B,aAAa,qBAAqB,mCAAmC,EAAE,EAAE,cAAc,WAAW,UAAU,EAAE,UAAU,MAAM,yCAAyC,EAAE,UAAU,kBAAkB,EAAE,EAAE,aAAa,EAAE,2BAA2B,0BAA0B,YAAY,EAAE,2CAA2C,8BAA8B,EAAE,OAAO,6EAA6E,EAAE,GAAG,EAAE;;AAErpB,mDAAmD,gBAAgB,sBAAsB,OAAO,2BAA2B,0BAA0B,yDAAyD,2BAA2B,EAAE,EAAE,EAAE,eAAe;;AAE9P;;AAEA;;AAEA;;AAEA;;AAEA,uCAAuC,6BAA6B,YAAY,EAAE,OAAO,iBAAiB,mBAAmB,uBAAuB,4EAA4E,EAAE,EAAE,sBAAsB,eAAe,EAAE;;AAE3Q;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,WAAW,qBAAqB;AAChC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,eAAe,OAAO;AACtB;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,cAAc,IAAI;AAClB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA,aAAa,OAAO;AACpB;AACA,cAAc,eAAe;AAC7B,cAAc,QAAQ;AACtB;;AAEA;AACA,aAAa,OAAO;AACpB;AACA,cAAc,QAAQ;AACtB,cAAc,QAAQ;AACtB,cAAc,QAAQ;AACtB,cAAc,QAAQ;AACtB,cAAc,IAAI;AAClB,cAAc,SAAS;AACvB;;AAEA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA;;AAEA;;AAEA;;AAEA,uCAAuC,6BAA6B,YAAY,EAAE,OAAO,iBAAiB,mBAAmB,uBAAuB,4EAA4E,EAAE,EAAE,sBAAsB,eAAe,EAAE;;AAE3Q;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,uBAAuB,uEAAuE;AAC9F;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA,OAAO;;AAEP;AACA;;AAEA,6BAA6B;AAC7B,uCAAuC;;;AAGvC,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,iEAAiE;AACjE;AACA,kFAAkF;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,+CAA+C;AAC/C;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd,cAAc;AACd,cAAc;AACd,cAAc;AACd,eAAe;AACf,eAAe;AACf,eAAe;AACf,gBAAgB;AAChB;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA,mDAAmD,gBAAgB,sBAAsB,OAAO,2BAA2B,0BAA0B,yDAAyD,2BAA2B,EAAE,EAAE,EAAE,eAAe,GAAG;AACjQ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,cAAc,OAAO;AACrB;AACA,eAAe,OAAO;AACtB;AACA,eAAe,aAAa;AAC5B,eAAe,OAAO;AACtB;AACA;;AAEA;AACA,aAAa,eAAe;AAC5B;;AAEA;AACA,aAAa,eAAe;AAC5B;;AAEA;AACA,aAAa,OAAO;AACpB;AACA;;AAEA;AACA,aAAa,OAAO;AACpB;AACA;;AAEA;AACA,aAAa,OAAO;AACpB;AACA,cAAc,mBAAmB;AACjC,cAAc,qBAAqB;AACnC,cAAc,yBAAyB;AACvC,cAAc,yBAAyB;AACvC,cAAc,0BAA0B;AACxC,cAAc,iBAAiB;AAC/B,cAAc,iBAAiB;AAC/B;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,WAAW;AACvB;AACA,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,iDAAiD,wBAAwB;;AAEzE;AACA;AACA;AACA,oHAAoH;AACpH;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,8CAA8C,iFAAiF;;AAE/H;AACA;AACA,GAAG;AACH;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,6BAA6B;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA,qDAAqD,0BAA0B;AAC/E;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,0EAA0E;;AAE1E;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA,SAAS;AACT;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,2BAA2B;AAC3B;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,gEAAgE;AAChE,OAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,aAAa,EAAE,KAAK,gBAAgB,wBAAwB;AAC5D;AACA;AACA;AACA,uCAAuC;AACvC;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,aAAa;AACxB,WAAW,cAAc;AACzB;AACA,aAAa,OAAO;AACpB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACA,YAAY,mBAAmB;AAC/B;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;AACA;;AAEA;;AAEA;;AAEA;AACA,aAAa,OAAO;AACpB,cAAc,OAAO;AACrB;;AAEA;AACA,aAAa,OAAO;AACpB,cAAc,OAAO;AACrB;;AAEA;AACA;AACA;AACA,aAAa,oCAAoC;AACjD;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,aAAa;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,UAAU;AACrB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,wBAAwB;AACnC,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,WAAW,eAAe;AAC1B,WAAW,wBAAwB;AACnC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA,oGAAoG,mBAAmB,EAAE,mBAAmB,8HAA8H;;AAE1Q;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;;AAED;AACA,UAAU,iBAAiB;AAC3B,UAAU,iBAAiB;AAC3B,gBAAgB,iBAAiB;AACjC,aAAa,iBAAiB;AAC9B,SAAS,kBAAkB;AAC3B,SAAS;AACT;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA,WAAW,IAAI;AACf,WAAW,aAAa;AACxB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAsB;AACtB,gCAAgC,0BAA0B;AAC1D;AACA;AACA,oBAAoB;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,YAAY,OAAO;AACnB;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,OAAO;;AAEP;AACA;;AAEA,kBAAkB,gBAAgB,8LAA8L,8EAA8E,oBAAoB,OAAO,QAAQ,6HAA6H,WAAW,0VAA0V,4BAA4B,kLAAkL,mBAAmB,sBAAsB,wBAAwB,4FAA4F,qGAAqG;;AAEnwC,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yCAAyC;;;AAGzC,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;;AAED,mDAAmD,gBAAgB,sBAAsB,OAAO,2BAA2B,0BAA0B,yDAAyD,2BAA2B,EAAE,EAAE,EAAE,eAAe;;AAE9P,oGAAoG,mBAAmB,EAAE,mBAAmB,8HAA8H;;AAE1Q;;AAEA;AACA,aAAa,SAAS;AACtB,cAAc,+BAA+B;AAC7C;AACA,cAAc,qBAAqB;AACnC;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,WAAW;AACtB,WAAW,OAAO;AAClB;AACA,aAAa,eAAe;AAC5B;AACA;AACA,iBAAiB,sBAAsB;;AAEvC;AACA;AACA;;AAEA,qEAAqE,aAAa;AAClF;AACA;;AAEA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;;AAEA,wEAAwE,eAAe;AACvF;AACA;;AAEA;;AAEA;AACA,0EAA0E,eAAe;AACzF;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;AACA;;AAEA;AACA,sEAAsE,eAAe;AACrF;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,OAAO;;AAEP;AACA;;AAEA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA,iCAAiC,QAAQ,mBAAmB,UAAU,EAAE,EAAE;AAC1E,CAAC;;;AAGD,OAAO;;AAEP;AACA;;AAEA,8BAA8B;;;AAG9B,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F;;AAEA;AACA;AACA;AACA;AACA,aAAa,eAAe;AAC5B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa,OAAO;AACpB;AACA,cAAc,kBAAkB;AAChC,cAAc,kBAAkB;AAChC,cAAc,kBAAkB;AAChC,cAAc,kBAAkB;AAChC,cAAc,mBAAmB;AACjC,cAAc,mBAAmB;AACjC,cAAc,mBAAmB;AACjC;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,4CAA4C,uGAAuG;AACnJ;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,aAAa,4BAA4B;AACzC;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAU,eAAe;AACzB;AACA;AACA;AACA,wCAAwC;AACxC;AACA,8BAA8B;AAC9B,6BAA6B;AAC7B,+BAA+B;AAC/B,mCAAmC;AACnC,SAAS,iCAAiC;AAC1C;AACA;AACA;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA,iBAAiB;;AAEjB;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA,2DAA2D;AAC3D;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA,mDAAmD,gBAAgB,sBAAsB,OAAO,2BAA2B,0BAA0B,yDAAyD,2BAA2B,EAAE,EAAE,EAAE,eAAe;;AAE9P;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,2CAA2C,kBAAkB,kCAAkC,qEAAqE,EAAE,EAAE,OAAO,kBAAkB,EAAE,YAAY;;AAE/M;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA,aAAa,uBAAuB;AACpC,cAAc,OAAO;AACrB;;AAEA;AACA,aAAa,6CAA6C;AAC1D;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT,OAAO;AACP;AACA;;AAEA;AACA;AACA,aAAa,QAAQ;AACrB,cAAc,0BAA0B;AACxC;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,6BAA6B;AACvE,SAAS;AACT;AACA,0CAA0C,wCAAwC;AAClF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAa,eAAe;AAC5B,cAAc,0BAA0B;AACxC;AACA;AACA;AACA,+BAA+B;AAC/B,iCAAiC;AACjC,OAAO;AACP;AACA,OAAO,IAAI;AACX,KAAK;AACL;AACA,oCAAoC;AACpC;AACA,KAAK,IAAI;AACT;AACA;;AAEA;AACA;AACA,aAAa,uCAAuC;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,WAAW;AACX,SAAS;AACT,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA,cAAc,kBAAkB;AAChC,cAAc,SAAS;AACvB;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,cAAc,kBAAkB;AAChC,cAAc,OAAO;AACrB;AACA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;;AAEA;AACA;AACA,aAAa,SAAS;AACtB,cAAc,eAAe;AAC7B;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA,+BAA+B;AAC/B;AACA,OAAO;AACP,iCAAiC;AACjC,OAAO;AACP,KAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK,0DAA0D;AAC/D;;AAEA;AACA;AACA;AACA;AACA,aAAa,SAAS;AACtB,aAAa,OAAO;AACpB,aAAa,OAAO;AACpB,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,6BAA6B;AAC7B;AACA;AACA;AACA,+BAA+B;AAC/B,KAAK;AACL;;AAEA;AACA;AACA,aAAa,SAAS;AACtB,cAAc,eAAe;AAC7B;AACA;AACA;AACA;AACA,KAAK;AACL,wBAAwB;AACxB,KAAK;AACL;AACA,KAAK,EAAE;AACP;;AAEA;AACA;AACA,aAAa,SAAS;AACtB,cAAc,eAAe;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA,iCAAiC;AACjC;AACA,SAAS;AACT;AACA,KAAK;AACL;AACA,KAAK,EAAE;AACP;;AAEA;AACA;AACA,+BAA+B;AAC/B,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;;AAEA;;AAEA,OAAO;;AAEP;AACA;;AAEA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;;AAE5C;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA,mDAAmD,gBAAgB,sBAAsB,OAAO,2BAA2B,0BAA0B,yDAAyD,2BAA2B,EAAE,EAAE,EAAE,eAAe;;AAE9P,oGAAoG,mBAAmB,EAAE,mBAAmB,8HAA8H,GAAG;AAC7Q;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,2CAA2C,kBAAkB,kCAAkC,qEAAqE,EAAE,EAAE,OAAO,kBAAkB,EAAE,YAAY;;AAE/M;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,aAAa,OAAO;AACpB;AACA,cAAc,OAAO;AACrB;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;;AAEP,4BAA4B;AAC5B;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,OAAO;;AAEP;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,4BAA4B;AAC5B;;AAEA;AACA,KAAK;;AAEL;AACA,GAAG;;AAEH;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAmB;AACnB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,oBAAoB,mCAAmC;;AAEvD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL,0CAA0C;AAC1C,KAAK;;AAEL;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,OAAO;;AAEP;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,0CAA0C,gBAAgB,EAAE;AAC5D;AACA;AACA;AACA;AACA,CAAC;AACD;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG,YAAY;AACf;AACA;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;;AAGA,oGAAoG,mBAAmB,EAAE,mBAAmB,8HAA8H;;AAE1Q,mDAAmD,gBAAgB,sBAAsB,OAAO,2BAA2B,0BAA0B,yDAAyD,2BAA2B,EAAE,EAAE,EAAE,eAAe;;AAE9P;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,2CAA2C,kBAAkB,kCAAkC,qEAAqE,EAAE,EAAE,OAAO,kBAAkB,EAAE,YAAY,EAAE;;AAEjN;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY,OAAO;AACnB;AACA,YAAY,MAAM;AAClB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,sBAAsB,OAAO;AAC7B;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY,OAAO;AACnB;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA,GAAG;AACH,6BAA6B,uBAAuB,yCAAyC;AAC7F,GAAG;AACH;AACA,GAAG,IAAI;AACP;;AAEA;AACA;AACA,YAAY,OAAO;AACnB;AACA,YAAY,OAAO;AACnB;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,kBAAkB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,aAAa;AACzB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA,mBAAmB,yBAAyB;AAC5C;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,WAAW,OAAO;AAClB,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB;AACA;AACA;AACA,oFAAoF;AACpF;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6DAA6D,qBAAqB;;AAElF;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA,8DAA8D,8GAA8G;AAC5K;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,WAAW,aAAa;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,WAAW,OAAO;AAClB,WAAW,SAAS;AACpB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,YAAY,SAAS;AACrB,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,YAAY,OAAO;AACnB;AACA,YAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,OAAO;AACnB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH,wEAAwE;AACxE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB,cAAc,OAAO,oCAAoC;AACzD,cAAc,OAAO,oDAAoD,0BAA0B;AACnG,cAAc,OAAO,qCAAqC;AAC1D,cAAc,OAAO,mCAAmC;AACxD,cAAc,OAAO,sCAAsC;AAC3D,cAAc,OAAO,oCAAoC;AACzD;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACA,cAAc,OAAO,2LAA2L,WAAW,UAAU,oBAAoB;AACzP,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACA,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;;AAEA;AACA;AACA,YAAY,0BAA0B;AACtC;AACA;AACA;AACA;;AAEA;AACA;AACA,YAAY,0BAA0B;AACtC;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA,WAAW,OAAO;AAClB;AACA,YAAY,MAAM;AAClB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO;AAClB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO,0FAA0F,0BAA0B;AACtI,WAAW,QAAQ,oEAAoE,cAAc;AACrG,WAAW,OAAO,uFAAuF,6BAA6B,gNAAgN,eAAe,oDAAoD,EAAE;AAC3Z,WAAW,QAAQ,wFAAwF,0BAA0B;AACrI,WAAW,OAAO,gGAAgG,sBAAsB;AACxI,WAAW,OAAO,2IAA2I,8CAA8C;AAC3M,WAAW,OAAO,wJAAwJ,uBAAuB;AACjM,WAAW,OAAO;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAI;AACJ;AACA;AACA;;AAEA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,YAAY,SAAS;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,QAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA;;AAEA,OAAO;;AAEP;AACA;;AAEA;AACA,qEAAqE,mBAAmB,UAAU,EAAE,EAAE;AACtG,CAAC;;;AAGD,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA,uBAAuB;AACvB;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA,kDAAkD;AAClD;AACA,uCAAuC;AACvC;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;AAED;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK,YAAY,eAAe;AAChC;AACA,KAAK;AACL;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA,mDAAmD,gBAAgB,sBAAsB,OAAO,2BAA2B,0BAA0B,yDAAyD,2BAA2B,EAAE,EAAE,EAAE,eAAe;;AAE9P,oGAAoG,mBAAmB,EAAE,mBAAmB,8HAA8H;;AAE1Q;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAoB,kBAAkB;AACtC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;AAEA;AACA,oCAAoC;;AAEpC;AACA,gBAAgB;AAChB,aAAa;AACb;AACA;AACA;AACA,MAAM,KAAK,iCAAiC;AAC5C,WAAW,KAAK,8BAA8B;AAC9C;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;;AAED,oGAAoG,mBAAmB,EAAE,mBAAmB,8HAA8H;;AAE1Q;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F;;AAEA;AACA,aAAa,OAAO;AACpB;AACA,cAAc,OAAO;AACrB;AACA;AACA,oBAAoB;AACpB,cAAc,aAAa;AAC3B,cAAc,cAAc;AAC5B;;AAEA;AACA;AACA,WAAW,kBAAkB;AAC7B;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA,WAAW,cAAc;AACzB,WAAW,QAAQ;AACnB,WAAW,cAAc;AACzB,WAAW,qBAAqB;AAChC,WAAW,kBAAkB;AAC7B,cAAc;AACd;AACA;AACA,mFAAmF;AACnF;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH,cAAc;AACd,sBAAsB;AACtB;AACA,GAAG;AACH;;AAEA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA,aAAa,OAAO;AACpB,cAAc,OAAO;AACrB;;AAEA;AACA;AACA,WAAW,SAAS;AACpB,WAAW,aAAa;AACxB,YAAY,QAAQ;AACpB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,yLAAyL,SAAS,WAAW,EAAE,EAAE;AACjN;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,OAAO;;AAEP;AACA;;AAEA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;;AAGA,kCAAkC,iCAAiC,eAAe,eAAe,gBAAgB,oBAAoB,MAAM,0CAA0C,+BAA+B,aAAa,qBAAqB,mCAAmC,EAAE,EAAE,cAAc,WAAW,UAAU,EAAE,UAAU,MAAM,yCAAyC,EAAE,UAAU,kBAAkB,EAAE,EAAE,aAAa,EAAE,2BAA2B,0BAA0B,YAAY,EAAE,2CAA2C,8BAA8B,EAAE,OAAO,6EAA6E,EAAE,GAAG,EAAE;;AAErpB,mDAAmD,gBAAgB,sBAAsB,OAAO,2BAA2B,0BAA0B,yDAAyD,2BAA2B,EAAE,EAAE,EAAE,eAAe,GAAG;;AAEjQ;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F;AACA;AACA;AACA,8BAA8B;;AAE9B;AACA;AACA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;;AAEA;AACA,aAAa,OAAO;AACpB,cAAc,QAAQ;AACtB,cAAc,cAAc;AAC5B,cAAc,cAAc;AAC5B;;AAEA;AACA;AACA;AACA;AACA,aAAa;AACb;AACA;AACA;AACA,YAAY;AACZ;AACA,UAAU;AACV;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,6BAA6B,QAAQ,gCAAgC;AACrE,WAAW;AACX;AACA;AACA;;AAEA;AACA;AACA,2BAA2B;AAC3B;AACA,WAAW;AACX;;AAEA,yBAAyB;;AAEzB;AACA;AACA;;AAEA;AACA,+BAA+B;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uBAAuB,4HAA4H;AACnJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,+HAA+H;AACpJ;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT,OAAO;AACP;AACA,KAAK;;AAEL;AACA;AACA,KAAK;;AAEL;AACA,2BAA2B;AAC3B;AACA;AACA;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA,SAAS;;AAET;AACA;AACA;AACA;AACA,WAAW;AACX,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,2BAA2B;;AAE3B;AACA,oFAAoF;AACpF;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA,gEAAgE,SAAS,cAAc;AACvF;AACA;AACA;AACA;AACA,SAAS;AACT,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;;AAEA,OAAO;;AAEP;AACA;;AAEA;;;AAGA,mDAAmD,gBAAgB,sBAAsB,OAAO,2BAA2B,0BAA0B,yDAAyD,2BAA2B,EAAE,EAAE,EAAE,eAAe;;AAE9P;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;AAED;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,aAAa,OAAO;AACpB,aAAa,MAAM;AACnB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,2CAA2C;AAC3C;AACA;AACA,KAAK;;AAEL;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,6CAA6C;;AAE7C;AACA,kCAAkC;AAClC;AACA,OAAO;AACP;AACA;;AAEA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,cAAc,MAAM;AACpB;AACA;AACA;AACA;AACA,+BAA+B;AAC/B;AACA,KAAK;;AAEL;AACA;;AAEA;AACA,CAAC;;AAED,OAAO;;AAEP,UAAU;;AAEV;;AAEA;AACA;;AAEA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA,4FAA4F,IAAI,QAAQ,SAAS,WAAW,wEAAwE,IAAI,QAAQ,SAAS,WAAW;AACpO;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,uCAAuC,6BAA6B,YAAY,EAAE,OAAO,iBAAiB,mBAAmB,uBAAuB,4EAA4E,EAAE,EAAE,sBAAsB,eAAe,EAAE;;AAE3Q,+CAA+C,wDAAwD,OAAO,4BAA4B,EAAE,GAAG;;AAE/I;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA,6BAA6B;AAC7B;AACA;AACA,CAAC;;AAED;AACA,oFAAoF,aAAa;AACjG;AACA;;AAEA;AACA,wEAAwE,eAAe;AACvF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW;AACX;AACA,OAAO;AACP;AACA;;AAEA;AACA;;AAEA;AACA,6CAA6C;AAC7C;;AAEA;AACA;;AAEA;AACA,4BAA4B;AAC5B,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,yBAAyB;AACzB;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,yCAAyC,mDAAmD;AAC5F;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;;AAEL;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;;AAEA,+BAA+B,4CAA4C;AAC3E,GAAG;AACH;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA;;AAEA,wCAAwC,iBAAiB,KAAK,KAAK,aAAa,cAAc,yEAAyE,SAAS,qCAAqC,8BAA8B,cAAc,UAAU,OAAO;AAClR,GAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;;AAEA,OAAO;;AAEP;AACA;;;;AAIA,OAAO;;AAEP,CAAC;;AAED;;AAEA;AACA;;AAEA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA,oGAAoG,mBAAmB,EAAE,mBAAmB,8HAA8H;;AAE1Q,mDAAmD,gBAAgB,sBAAsB,OAAO,2BAA2B,0BAA0B,yDAAyD,2BAA2B,EAAE,EAAE,EAAE,eAAe;;AAE9P;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,uCAAuC,6BAA6B,YAAY,EAAE,OAAO,iBAAiB,mBAAmB,uBAAuB,4EAA4E,EAAE,EAAE,sBAAsB,eAAe,EAAE;;AAE3Q,kCAAkC,0BAA0B,0CAA0C,gBAAgB,OAAO,kBAAkB,EAAE,aAAa,EAAE,OAAO,wBAAwB,EAAE;;AAEjM;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAqB,iBAAiB;AACtC,oBAAoB,WAAW;AAC/B,GAAG;AACH;AACA;AACA,qBAAqB,iBAAiB;AACtC,oBAAoB,WAAW;AAC/B,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,aAAa,aAAa;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,aAAa,EAAE;AACf,cAAc,MAAM;AACpB;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA,KAAK;AACL;AACA;AACA;AACA,OAAO;AACP;AACA,OAAO;AACP;AACA,eAAe,mBAAmB;AAClC,GAAG;;AAEH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAoB,yBAAyB;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,iCAAiC;AACjC;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA,KAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH,mBAAmB,yBAAyB;AAC5C;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;;AAEA;AACA;AACA,6BAA6B,qBAAqB;AAClD,MAAM,MAAM,8CAA8C;AAC1D;AACA;AACA;AACA;;AAEA;AACA;AACA,qCAAqC;;AAErC;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;;AAEP;AACA;AACA,yCAAyC;AACzC;AACA;AACA,GAAG;;AAEH;AACA;;AA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DAAkD,kBAAkB,IAAI,KAAK,UAAU,kBAAkB,WAAW,4BAA4B;AAC5rJ;;AAEA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,MAAM;AACjB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,aAAa,cAAc;AAC3B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;;AAEH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,WAAW,mGAAmG;AAC9G;;AAEA;AACA;AACA,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,OAAO;AAClB,WAAW,MAAM;AACjB,WAAW,MAAM;AACjB,aAAa,cAAc;AAC3B;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,0CAA0C;;AAE1C;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;;AAGA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,OAAO;;AAEP;AACA;;;;AAIA,OAAO;;AAEP,CAAC;;AAED;;AAEA;AACA;;AAEA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA,mDAAmD,gBAAgB,sBAAsB,OAAO,2BAA2B,0BAA0B,yDAAyD,2BAA2B,EAAE,EAAE,EAAE,eAAe;;AAE9P,kCAAkC,iCAAiC,eAAe,eAAe,gBAAgB,oBAAoB,MAAM,0CAA0C,+BAA+B,aAAa,qBAAqB,mCAAmC,EAAE,EAAE,cAAc,WAAW,UAAU,EAAE,UAAU,MAAM,yCAAyC,EAAE,UAAU,kBAAkB,EAAE,EAAE,aAAa,EAAE,2BAA2B,0BAA0B,YAAY,EAAE,2CAA2C,8BAA8B,EAAE,OAAO,6EAA6E,EAAE,GAAG,EAAE;;AAErpB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,uCAAuC,6BAA6B,YAAY,EAAE,OAAO,iBAAiB,mBAAmB,uBAAuB,4EAA4E,EAAE,EAAE,sBAAsB,eAAe,EAAE;;AAE3Q;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,GAAG;AACH;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA,oCAAoC;AACpC;;AAEA;AACA,wBAAwB,6BAA6B,GAAG,oCAAoC,GAAG,+BAA+B,GAAG,4DAA4D,GAAG,+BAA+B,GAAG,uDAAuD,GAAG,sDAAsD,GAAG,kDAAkD,GAAG,kDAAkD,GAAG,0CAA0C,GAAG,gDAAgD,GAAG,oDAAoD,GAAG,uBAAuB,GAAG,qGAAqG;AACrtB;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG,IAAI;AACP;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,YAAY;AACZ,YAAY;AACZ;AACA;;AAEA;AACA;AACA;AACA;;AAEA,wBAAwB;AACxB,wBAAwB;AACxB;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA,OAAO;;AAEP;AACA;;;;AAIA,OAAO;;AAEP,CAAC;;AAED;;AAEA;AACA;;AAEA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,uCAAuC,6BAA6B,YAAY,EAAE,OAAO,iBAAiB,mBAAmB,uBAAuB,4EAA4E,EAAE,EAAE,sBAAsB,eAAe,EAAE;;AAE3Q;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,iBAAiB,gEAAgE;AAC5F,WAAW,iBAAiB,+DAA+D;AAC3F,WAAW,UAAU;AACrB;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB;AACjB;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO,iBAAiB;AACnC,WAAW,SAAS,aAAa;AACjC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,WAAW,OAAO,wBAAwB;AAC1C;AACA;AACA;AACA,mEAAmE;AACnE,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO,iBAAiB;AACnC;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO,2BAA2B;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAW,OAAO,iBAAiB;AACnC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,WAAW,OAAO,iBAAiB,0CAA0C;AAC7E;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,CAAC;;AAED,OAAO;;AAEP,CAAC;;AAED;;AAEA;AACA;;AAEA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA,oGAAoG,mBAAmB,EAAE,mBAAmB,8HAA8H;;AAE1Q;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,sCAAsC,uCAAuC,gBAAgB;;AAE7F,uCAAuC,6BAA6B,YAAY,EAAE,OAAO,iBAAiB,mBAAmB,uBAAuB,4EAA4E,EAAE,EAAE,sBAAsB,eAAe,EAAE;;AAE3Q;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB,YAAY,OAAO;AACnB;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,YAAY,EAAE;AACd,YAAY,QAAQ;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,YAAY,MAAM;AAClB,YAAY,OAAO;AACnB,YAAY,QAAQ;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA,iBAAiB,sBAAsB;AACvC;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,YAAY,EAAE;AACd,YAAY,EAAE;AACd,YAAY,QAAQ;AACpB;AACA;AACA;AACA,yBAAyB,EAAE;;AAE3B;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,QAAQ;AACtB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,GAAG;;AAEH;AACA;AACA;AACA,cAAc,MAAM;AACpB,cAAc,OAAO;AACrB,cAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;;AAEA,mBAAmB,6BAA6B;AAChD;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,cAAc,OAAO;AACrB,cAAc,MAAM;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,mBAAmB,oBAAoB;AACvC;AACA;AACA;;AAEA;AACA;AACA,qBAAqB,sBAAsB;AAC3C;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA,OAAO;;AAEP;AACA;;AAEA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;;AAEA,6BAA6B,mCAAmC;;;AAGhE,OAAO;;AAEP;AACA;;AAEA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;AACA;;AAEA,8BAA8B,sCAAsC;;;AAGpE,OAAO;;AAEP;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;;AAGA,OAAO;;AAEP;AACA;;;;AAIA,OAAO;;AAEP,CAAC;;AAED;;AAEA;AACA;;AAEA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA,kCAAkC,iCAAiC,eAAe,eAAe,gBAAgB,oBAAoB,MAAM,0CAA0C,+BAA+B,aAAa,qBAAqB,mCAAmC,EAAE,EAAE,cAAc,WAAW,UAAU,EAAE,UAAU,MAAM,yCAAyC,EAAE,UAAU,kBAAkB,EAAE,EAAE,aAAa,EAAE,2BAA2B,0BAA0B,YAAY,EAAE,2CAA2C,8BAA8B,EAAE,OAAO,6EAA6E,EAAE,GAAG,EAAE;;AAErpB;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,uCAAuC,6BAA6B,YAAY,EAAE,OAAO,iBAAiB,mBAAmB,uBAAuB,4EAA4E,EAAE,EAAE,sBAAsB,eAAe,EAAE;;AAE3Q;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA,GAAG;AACH;AACA;;AAEA;;AAEA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,iBAAiB,oBAAoB;AACrC;AACA;AACA;;AAEA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAc;AACd;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,OAAO;;AAEP;AACA;;;;AAIA,OAAO;;AAEP,CAAC;;AAED;;AAEA;AACA;;AAEA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA,oGAAoG,mBAAmB,EAAE,mBAAmB,8HAA8H;;AAE1Q;;AAEA;;AAEA;;AAEA,uCAAuC,6BAA6B,YAAY,EAAE,OAAO,iBAAiB,mBAAmB,uBAAuB,4EAA4E,EAAE,EAAE,sBAAsB,eAAe,EAAE;;AAE3Q;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,yBAAyB;AACzB;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,YAAY;AACZ;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,YAAY,WAAW;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,YAAY,mBAAmB;AAC/B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA,YAAY,EAAE;AACd,aAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,WAAW;AACX,SAAS;AACT;AACA,KAAK;AACL;AACA;AACA;AACA,GAAG;;AAEH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO;AACP,KAAK;AACL;AACA;AACA;AACA;;AAEA;;AAEA,OAAO;;AAEP;AACA;;;;AAIA,OAAO;;AAEP,CAAC;;AAED;;AAEA;AACA;;AAEA;AACA;;;AAGA,OAAO;;AAEP;AACA;;AAEA;;;AAGA;AACA;AACA,CAAC;AACD;;AAEA,kCAAkC,iCAAiC,eAAe,eAAe,gBAAgB,oBAAoB,MAAM,0CAA0C,+BAA+B,aAAa,qBAAqB,mCAAmC,EAAE,EAAE,cAAc,WAAW,UAAU,EAAE,UAAU,MAAM,yCAAyC,EAAE,UAAU,kBAAkB,EAAE,EAAE,aAAa,EAAE,2BAA2B,0BAA0B,YAAY,EAAE,2CAA2C,8BAA8B,EAAE,OAAO,6EAA6E,EAAE,GAAG,EAAE;;AAErpB,oGAAoG,mBAAmB,EAAE,mBAAmB,8HAA8H;;AAE1Q;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA,uCAAuC,6BAA6B,YAAY,EAAE,OAAO,iBAAiB,mBAAmB,uBAAuB,4EAA4E,EAAE,EAAE,sBAAsB,eAAe,EAAE;;AAE3Q;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA;AACA,aAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,GAAG;AACH;AACA,aAAa,aAAa;AAC1B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,OAAO;AACP;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA;AACA;AACA;AACA,SAAS;AACT;;AAEA;;AAEA;;AAEA;AACA;AACA,OAAO,mBAAmB;;AAE1B;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA,aAAa,WAAW;AACxB,eAAe;AACf;AACA;AACA;AACA,GAAG;AACH;AACA,aAAa,EAAE;AACf,aAAa,WAAW;AACxB,cAAc,MAAM;AACpB;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;AACA,SAAS;;AAET;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,OAAO,GAAG,uCAAuC;;AAEjD;;AAEA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,kHAAkH,uBAAuB;AACzI;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,sEAAsE,2CAA2C,YAAY;AAC7H;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA,OAAO;;AAEP;AACA;;;;AAIA,OAAO;;AAEP,CAAC;;AAED;AACA","file":"ad-engine.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 22);\n","module.exports = require(\"babel-runtime/helpers/createClass\");","module.exports = require(\"babel-runtime/helpers/classCallCheck\");","module.exports = require(\"babel-runtime/core-js/object/get-prototype-of\");","module.exports = require(\"babel-runtime/helpers/possibleConstructorReturn\");","module.exports = require(\"babel-runtime/helpers/inherits\");","module.exports = require(\"babel-runtime/core-js/object/keys\");","module.exports = require(\"babel-runtime/core-js/promise\");","module.exports = require(\"babel-runtime/core-js/json/stringify\");","module.exports = require(\"babel-runtime/helpers/slicedToArray\");","module.exports = require(\"babel-runtime/core-js/object/assign\");","module.exports = require(\"core-decorators\");","module.exports = require(\"babel-runtime/core-js/object/get-own-property-descriptor\");","module.exports = require(\"babel-runtime/helpers/typeof\");","module.exports = require(\"babel-runtime/helpers/get\");","module.exports = require(\"eventemitter3\");","module.exports = require(\"babel-runtime/core-js/symbol\");","module.exports = require(\"ismobilejs\");","module.exports = require(\"babel-runtime/core-js/object/get-own-property-names\");","module.exports = require(\"babel-runtime/core-js/map\");","module.exports = require(\"blockadblock\");","module.exports = require(\"lodash/get\");","module.exports = require(\"lodash/set\");","/* global BlockAdBlock */\nimport isMobileJs from 'ismobilejs';\nimport AdBlockDetect from 'blockadblock';\n\nlet bab = null,\n\tbrowser = null,\n\tisMobile = null,\n\toperatingSystem = null;\n\nfunction getIsMobile() {\n\tif (isMobile === null) {\n\t\tconst { userAgent } = window.navigator;\n\n\t\tisMobile = (typeof isMobileJs === 'function') ? isMobileJs(userAgent) : isMobileJs;\n\t}\n\n\treturn isMobile;\n}\n\nclass Client {\n\tisSmartphone() {\n\t\tconst device = getIsMobile();\n\n\t\treturn device.phone;\n\t}\n\n\tisTablet() {\n\t\tconst device = getIsMobile();\n\n\t\treturn device.tablet;\n\t}\n\n\tisDesktop() {\n\t\treturn !this.isSmartphone() && !this.isTablet();\n\t}\n\n\tcheckBlocking(enabled = null, disabled = null) {\n\t\tif (bab === null) {\n\t\t\tif (typeof AdBlockDetect === 'undefined' || typeof BlockAdBlock === 'undefined') {\n\t\t\t\tif (enabled !== null) enabled();\n\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tbab = new BlockAdBlock({\n\t\t\t\tcheckOnLoad: false,\n\t\t\t\tresetOnEnd: true,\n\t\t\t\tloopCheckTime: 50,\n\t\t\t\tloopMaxNumber: 5\n\t\t\t});\n\t\t}\n\n\t\tif (enabled !== null) bab.onDetected(enabled);\n\t\tif (disabled !== null) bab.onNotDetected(disabled);\n\n\t\tbab.check(true);\n\t}\n\n\tgetDeviceType() {\n\t\tif (this.isTablet()) {\n\t\t\treturn 'tablet';\n\t\t} else if (this.isSmartphone()) {\n\t\t\treturn 'smartphone';\n\t\t}\n\n\t\treturn 'desktop';\n\t}\n\n\tgetOperatingSystem() {\n\t\tif (operatingSystem !== null) {\n\t\t\treturn operatingSystem;\n\t\t}\n\n\t\tconst { userAgent } = window.navigator;\n\n\t\toperatingSystem = 'unknown';\n\t\tif (userAgent.indexOf('Win') !== -1) {\n\t\t\toperatingSystem = 'Windows';\n\t\t}\n\t\tif (userAgent.indexOf('Mac') !== -1) {\n\t\t\toperatingSystem = 'OSX';\n\t\t}\n\t\tif (userAgent.indexOf('Linux') !== -1) {\n\t\t\toperatingSystem = 'Linux';\n\t\t}\n\t\tif (userAgent.indexOf('Android') !== -1) {\n\t\t\toperatingSystem = 'Android';\n\t\t}\n\t\tif (userAgent.indexOf('like Mac') !== -1) {\n\t\t\toperatingSystem = 'iOS';\n\t\t}\n\n\t\treturn operatingSystem;\n\t}\n\n\tgetBrowser() {\n\t\tif (browser !== null) {\n\t\t\treturn browser;\n\t\t}\n\n\t\tconst { appName, appVersion, userAgent } = window.navigator;\n\n\t\tlet temp,\n\t\t\tmatches = userAgent.match(/(opera|chrome|safari|firefox|msie|trident(?=\\/))\\/?\\s*(\\d+)/i) || [];\n\n\t\tif (/trident/i.test(matches[1])) {\n\t\t\ttemp = /\\brv[ :]+(\\d+)/g.exec(userAgent) || [];\n\t\t\tbrowser = `IE ${(temp[1] || '')}`;\n\t\t\treturn browser;\n\t\t}\n\t\tif (matches[1] === 'Chrome') {\n\t\t\ttemp = userAgent.match(/\\b(OPR|Edge)\\/(\\d+)/);\n\t\t\tif (temp !== null) {\n\t\t\t\tbrowser = temp.slice(1).join(' ').replace('OPR', 'Opera');\n\t\t\t\treturn browser;\n\t\t\t}\n\t\t}\n\n\t\tmatches = matches[2] ? [matches[1], matches[2]] : [appName, appVersion, '-?'];\n\t\ttemp = userAgent.match(/version\\/(\\d+)/i);\n\t\tif (temp !== null) {\n\t\t\tmatches.splice(1, 1, temp[1]);\n\t\t}\n\t\tbrowser = matches.join(' ');\n\n\t\treturn browser;\n\t}\n}\n\nexport const client = new Client();\n","export function getTopOffset(element) {\n\tconst elementWindow = element.ownerDocument.defaultView;\n\n\tlet currentElement = element,\n\t\thideAgain = false,\n\t\ttopPos = 0;\n\n\tif (element.classList.contains('hide')) {\n\t\thideAgain = true;\n\t\telement.classList.remove('hide');\n\t}\n\n\tdo {\n\t\ttopPos += currentElement.offsetTop;\n\t\tcurrentElement = currentElement.offsetParent;\n\t} while (currentElement !== null);\n\n\tif (hideAgain) {\n\t\telement.classList.add('hide');\n\t}\n\n\tif (elementWindow && elementWindow.frameElement) {\n\t\ttopPos += getTopOffset(elementWindow.frameElement);\n\t}\n\n\treturn topPos;\n}\n\nexport function getViewportHeight() {\n\treturn Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\n}\n\nexport function isInViewport(element, topOffset = 0, bottomOffset = 0) {\n\tconst alwaysInViewportPositions = ['fixed', 'sticky'],\n\t\telementPosition = window.getComputedStyle(element).position;\n\n\tif (alwaysInViewportPositions.includes(elementPosition)) {\n\t\treturn true;\n\t}\n\n\tconst elementHeight = element.offsetHeight,\n\t\telementTop = getTopOffset(element),\n\t\telementBottom = elementTop + elementHeight,\n\t\tscrollPosition = window.scrollY,\n\t\tviewportHeight = getViewportHeight(),\n\t\tviewportTop = topOffset + scrollPosition,\n\t\tviewportBottom = bottomOffset + scrollPosition + viewportHeight;\n\n\treturn elementTop >= (viewportTop - elementHeight / 2) &&\n\t\telementBottom <= (viewportBottom + elementHeight / 2);\n}\n","export const wait = (milliseconds = 0) => new Promise((resolve, reject) => {\n\tif (typeof milliseconds !== 'number') {\n\t\treject(new Error('Delay value must be a number.'));\n\t\treturn;\n\t}\n\n\tsetTimeout(resolve, milliseconds);\n});\n\nexport const defer = (fn, ...args) => new Promise((resolve, reject) => {\n\tif (typeof fn !== 'function') {\n\t\treject(new Error('Expected a function.'));\n\t\treturn;\n\t}\n\n\tsetTimeout(() => resolve(fn(...args)), 0);\n});\n\nexport function once(emitter, eventName, options = {}) {\n\tconst isObject = typeof emitter === 'object';\n\tconst hasAddEventListener = isObject && (typeof emitter.addEventListener === 'function');\n\tconst hasOnce = isObject && (typeof emitter.once === 'function');\n\n\treturn new Promise((resolve, reject) => {\n\t\tif (typeof options === 'boolean') {\n\t\t\toptions = { capture: options };\n\t\t}\n\n\t\tif (hasOnce) {\n\t\t\temitter.once(eventName, resolve);\n\t\t} else if (hasAddEventListener) {\n\t\t\temitter.addEventListener(eventName, resolve, Object.assign({}, options, { once: true }));\n\t\t} else {\n\t\t\treject(new Error('Emitter does not have `addEventListener` nor `once` method.'));\n\t\t}\n\t});\n}\n","export function makeLazyQueue(queue, callback) {\n\tif (typeof callback !== 'function') {\n\t\tthrow new Error('LazyQueue used with callback not being a function');\n\t} else if (queue instanceof Array) {\n\t\tqueue.start = function () {\n\t\t\twhile (queue.length > 0) {\n\t\t\t\tcallback(queue.shift());\n\t\t\t}\n\t\t\tqueue.push = function (item) {\n\t\t\t\tcallback(item);\n\t\t\t};\n\t\t};\n\t} else {\n\t\tthrow new Error('LazyQueue requires an array as the first parameter');\n\t}\n}\n","class QueryString {\n\tgetValues(input = null) {\n\t\tconst path = input || window.location.search.substr(1),\n\t\t\tqueryParameters = {},\n\t\t\tqueryString = path.split('&');\n\n\t\tif (queryString === '') {\n\t\t\treturn null;\n\t\t}\n\n\t\tqueryString.forEach((pair) => {\n\t\t\tconst [id, value] = pair.split('=');\n\t\t\tif (value) {\n\t\t\t\tqueryParameters[id] = decodeURIComponent(value.replace(/\\+/g, ' '));\n\t\t\t}\n\t\t});\n\n\t\treturn queryParameters;\n\t}\n\n\tget(key) {\n\t\tconst queryParameters = this.getValues();\n\n\t\treturn queryParameters[key];\n\t}\n}\n\nexport const queryString = new QueryString();\n","import { queryString } from './query-string';\n\nconst debugGroup = queryString.get('adengine_debug') || '',\n\tgroups = debugGroup.split(',');\n\nif (debugGroup !== '') {\n\twindow.console.info('AdEngine debug mode - groups:', debugGroup === '1' ? 'all' : groups);\n}\n\nexport function logger(logGroup, ...logValues) {\n\tif (debugGroup === '') {\n\t\treturn;\n\t}\n\n\tif (debugGroup === '1' || groups.indexOf(logGroup) !== -1) {\n\t\twindow.console.info(logGroup, logValues);\n\t}\n}\n","import { queryString } from './query-string';\n\nfunction isSamplingIgnored(name) {\n\tconst ignored = (queryString.get('ignored_samplers') || '').split(',');\n\n\treturn ignored.indexOf(name) !== -1;\n}\n\nfunction getRandomInt(min, max) {\n\treturn Math.floor(Math.random() * (max - min)) + min;\n}\n\nclass Sampler {\n\tsample(name, sampling, max = 100) {\n\t\treturn isSamplingIgnored(name) ? true : getRandomInt(0, max) < sampling;\n\t}\n}\n\nexport const sampler = new Sampler();\n","class ScriptLoader {\n\tcreateScript(src, type = 'text/javascript', isAsync = true, node = null) {\n\t\tconst script = document.createElement('script');\n\n\t\tnode = node || document.body.lastChild;\n\t\tscript.async = isAsync;\n\t\tscript.type = type;\n\t\tscript.src = src;\n\t\tnode.parentNode.insertBefore(script, node);\n\n\t\treturn script;\n\t}\n\n\tloadScript(src, type = 'text/javascript', isAsync = true, node = null) {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tconst script = this.createScript(src, type, isAsync, node);\n\n\t\t\tscript.onload = resolve;\n\t\t\tscript.onerror = reject;\n\t\t});\n\t}\n}\n\nexport const scriptLoader = new ScriptLoader();\n","const contextObject = {\n\t\tadUnitId: '',\n\t\tevents: {},\n\t\tdelayModules: [],\n\t\tlisteners: {\n\t\t\tporvata: [],\n\t\t\tslot: []\n\t\t},\n\t\toptions: {\n\t\t\tcustomAdLoader: {\n\t\t\t\tglobalMethodName: 'loadCustomAd'\n\t\t\t},\n\t\t\tmaxDelayTimeout: 2000,\n\t\t\tvideo: {\n\t\t\t\tmoatTracking: {\n\t\t\t\t\tenabled: true,\n\t\t\t\t\tpartnerCode: 'wikiaimajsint377461931603',\n\t\t\t\t\tsampling: 1\n\t\t\t\t}\n\t\t\t},\n\t\t\tslotRepeater: false,\n\t\t\ttrackingOptIn: false\n\t\t},\n\t\tslots: {},\n\t\tsrc: 'gpt',\n\t\tstate: {\n\t\t\tadStack: [],\n\t\t\tisMobile: false\n\t\t},\n\t\ttargeting: {},\n\t\tvast: {\n\t\t\tsize: [640, 480],\n\t\t\tadUnitId: ''\n\t\t}\n\t},\n\tonChangeCallbacks = {};\n\nfunction runCallbacks(trigger, key, newValue) {\n\tif (!onChangeCallbacks[trigger]) {\n\t\treturn;\n\t}\n\n\tonChangeCallbacks[trigger].forEach((callback) => {\n\t\tcallback(key, newValue);\n\t});\n}\n\nfunction triggerOnChange(key, segments, newValue) {\n\tlet trigger = '';\n\tsegments.forEach((seg) => {\n\t\ttrigger += (trigger === '' ? '' : '.') + seg;\n\t\trunCallbacks(trigger, key, newValue);\n\t});\n}\n\nfunction segment(key, newValue) {\n\tconst segments = key.split('.'),\n\t\tsegmentsCount = segments.length;\n\tlet seg = contextObject,\n\t\tlastKey = null;\n\n\tfor (let i = 0; i < segmentsCount; i += 1) {\n\t\tlastKey = segments[i];\n\t\tif (i < segmentsCount - 1) {\n\t\t\tseg[lastKey] = seg[lastKey] || {};\n\t\t\tseg = seg[lastKey];\n\t\t}\n\t}\n\n\tif (newValue !== undefined) {\n\t\tseg[lastKey] = newValue;\n\t\ttriggerOnChange(key, segments, newValue);\n\t}\n\n\treturn seg[lastKey];\n}\n\nclass Context {\n\tconstructor() {\n\t\tthis.__useDefault = true;\n\t}\n\n\textend(newContext) {\n\t\tObject.assign(contextObject, newContext);\n\t}\n\n\tset(key, value) {\n\t\tsegment(key, value);\n\t}\n\n\tget(key) {\n\t\treturn segment(key);\n\t}\n\n\tpush(key, value) {\n\t\tconst array = segment(key);\n\n\t\tif (array) {\n\t\t\tarray.push(value);\n\t\t}\n\t}\n\n\tonChange(key, callback) {\n\t\tonChangeCallbacks[key] = onChangeCallbacks[key] || [];\n\t\tonChangeCallbacks[key].push(callback);\n\t}\n}\n\nexport const context = new Context();\n","import { getTopOffset, logger } from '../utils';\n\nconst groupName = 'slot-service';\nconst slots = {};\nconst slotStates = {};\nconst slotStatuses = {};\n\nfunction isSlotInTheSameViewport(slotHeight, slotOffset, viewportHeight, elementId) {\n\tconst element = document.getElementById(elementId);\n\n\t// According to https://developer.mozilla.org/en-US/docs/Web/API/HTMLElement/offsetParent\n\t// Hidden element does not have offsetParent\n\tif (element.offsetParent === null) {\n\t\treturn false;\n\t}\n\n\tconst elementHeight = element.offsetHeight,\n\t\telementOffset = getTopOffset(element),\n\t\tisFirst = elementOffset < slotOffset,\n\t\tdistance = isFirst ? slotOffset - elementOffset - elementHeight :\n\t\t\telementOffset - slotOffset - slotHeight;\n\n\treturn distance < viewportHeight;\n}\n\nclass SlotService {\n\tadd(adSlot) {\n\t\tconst slotName = adSlot.getSlotName();\n\n\t\tslots[slotName] = adSlot;\n\n\t\tif (slotStates[slotName] === false) {\n\t\t\tadSlot.disable(slotStatuses[slotName]);\n\t\t}\n\t\tif (slotStates[slotName] === true) {\n\t\t\tadSlot.enable();\n\t\t}\n\t}\n\n\tremove(adSlot) {\n\t\tconst slotName = adSlot.getSlotName();\n\n\t\tadSlot.disable('Marked for remove');\n\t\tdelete slots[slotName];\n\t\tdelete slotStates[slotName];\n\t\tdelete slotStatuses[slotName];\n\t}\n\n\tget(id) {\n\t\treturn slots[id];\n\t}\n\n\t/**\n\t * @deprecated since 12.0.0\n\t * Use get function\n\t */\n\tgetBySlotName(slotName) {\n\t\treturn this.get(slotName);\n\t}\n\n\tforEach(callback) {\n\t\tObject.keys(slots).forEach((id) => {\n\t\t\tcallback(slots[id]);\n\t\t});\n\t}\n\n\tenable(slotName) {\n\t\tsetState(slotName, true);\n\t}\n\n\tdisable(slotName, status = null) {\n\t\tsetState(slotName, false, status);\n\t}\n\n\thasViewportConflict(adSlot) {\n\t\tif (!adSlot.hasDefinedViewportConflicts() || adSlot.getElement() === null) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst slotHeight = adSlot.getElement().offsetHeight,\n\t\t\tslotOffset = getTopOffset(adSlot.getElement()),\n\t\t\tviewportHeight = window.innerHeight || document.documentElement.clientHeight || document.body.clientHeight;\n\n\t\tconst hasConflict = adSlot.getViewportConflicts().some(\n\t\t\telementId => isSlotInTheSameViewport(slotHeight, slotOffset, viewportHeight, elementId)\n\t\t);\n\t\tlogger(groupName, 'hasViewportConflict', adSlot.getSlotName(), hasConflict);\n\n\t\treturn hasConflict;\n\t}\n}\n\nexport const slotService = new SlotService();\n\nfunction setState(slotName, state, status = null) {\n\tconst slot = slotService.get(slotName);\n\tslotStates[slotName] = state;\n\tslotStatuses[slotName] = status;\n\n\tif (slot) {\n\t\tif (state) {\n\t\t\tslot.enable();\n\t\t} else {\n\t\t\tslot.disable(status);\n\t\t}\n\t}\n}\n","import EventEmitter from 'eventemitter3';\n\nclass EventService extends EventEmitter {\n\tPAGE_CHANGE_EVENT = Symbol('PAGE_CHANGE_EVENT');\n\tPAGE_RENDER_EVENT = Symbol('PAGE_RENDER_EVENT');\n\n\tpageChange(...args) {\n\t\tthis.emit(this.PAGE_CHANGE_EVENT, ...args);\n\t}\n\n\tpageRender(...args) {\n\t\tthis.emit(this.PAGE_RENDER_EVENT, ...args);\n\t}\n\n\thasEvent(event) {\n\t\treturn Object.getOwnPropertyNames(this).some(\n\t\t\tname => (typeof this[name] === 'symbol' && this[name] === event)\n\t\t);\n\t}\n\n\temit(event, ...args) {\n\t\tif (!this.hasEvent(event)) {\n\t\t\tthrow new Error(`Event \"${event}\" is not registered. Please register an event first.`);\n\t\t}\n\n\t\tsuper.emit(event, ...args);\n\t}\n\n\ton(event, ...args) {\n\t\tif (!this.hasEvent(event)) {\n\t\t\tthrow new Error('You can\\'t listen for an event which is not registered yet.');\n\t\t}\n\n\t\tsuper.on(event, ...args);\n\t}\n\n\taddListener(event, ...args) {\n\t\tif (!this.hasEvent(event)) {\n\t\t\tthrow new Error('You can\\'t listen for an event which is not registered yet.');\n\t\t}\n\n\t\tsuper.addListener(event, ...args);\n\t}\n\n\tonce(event, ...args) {\n\t\tif (!this.hasEvent(event)) {\n\t\t\tthrow new Error('You can\\'t listen for an event which is not registered yet.');\n\t\t}\n\n\t\tsuper.once(event, ...args);\n\t}\n\n\tregisterEvent(name) {\n\t\tif (typeof name !== 'string') {\n\t\t\tthrow new Error('Event name must be a string.');\n\t\t}\n\n\t\tif (this[name] !== undefined) {\n\t\t\tthrow new Error(`Event or property \"${name}\" already exists.`);\n\t\t}\n\n\t\tthis[name] = Symbol(name);\n\n\t\treturn this[name];\n\t}\n\n\tgetRegisteredEventNames() {\n\t\treturn Object.getOwnPropertyNames(this).filter(name => typeof this[name] === 'symbol');\n\t}\n}\n\nexport const events = new EventService();\n","import { logger, makeLazyQueue } from '../utils';\nimport { context } from './context-service';\nimport { slotService } from './slot-service';\nimport { events } from './events';\n\nconst logGroup = 'btf-blocker';\n\nfunction disableBtf() {\n\tconst slots = context.get('slots');\n\n\tObject.keys(slots).forEach((adSlotKey) => {\n\t\tconst slotConfig = slots[adSlotKey];\n\n\t\tif (!slotConfig.aboveTheFold && this.unblockedSlots.indexOf(slotConfig.slotName) === -1) {\n\t\t\tslotService.disable(slotConfig.slotName, 'blocked');\n\t\t}\n\t});\n}\n\nclass BtfBlockerService {\n\tconstructor() {\n\t\tthis.resetState();\n\t}\n\n\tresetState() {\n\t\tthis.slotsQueue = [];\n\t\tthis.atfEnded = false;\n\t\tthis.unblockedSlots = [];\n\n\t\tmakeLazyQueue(this.slotsQueue, ({ adSlot, fillInCallback }) => {\n\t\t\tlogger(logGroup, adSlot.getSlotName(), 'Filling delayed BTF slot');\n\t\t\tfillInCallback(adSlot);\n\t\t});\n\n\t\tif (window.ads && window.ads.runtime) {\n\t\t\twindow.ads.runtime.disableBtf = false;\n\t\t}\n\t}\n\n\tinit() {\n\t\tcontext.push('listeners.slot', {\n\t\t\tonRenderEnded: (adSlot) => {\n\t\t\t\tlogger(logGroup, adSlot.getSlotName(), 'Slot rendered');\n\t\t\t\tif (!this.atfEnded && adSlot.isAboveTheFold()) {\n\t\t\t\t\tthis.finishAboveTheFold();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tevents.on(events.PAGE_CHANGE_EVENT, () => {\n\t\t\tthis.resetState();\n\t\t});\n\t}\n\n\tfinishAboveTheFold() {\n\t\tthis.atfEnded = true;\n\n\t\tif (window.ads.runtime.disableBtf) {\n\t\t\tdisableBtf.call(this);\n\t\t}\n\n\t\tthis.slotsQueue.start();\n\t}\n\n\tpush(adSlot, fillInCallback) {\n\t\tfunction wrappedFillInCallback() {\n\t\t\tif (slotService.hasViewportConflict(adSlot)) {\n\t\t\t\tslotService.disable(adSlot.getSlotName(), 'viewport-conflict');\n\t\t\t}\n\n\t\t\tif (!adSlot.isEnabled()) {\n\t\t\t\tlogger(logGroup, adSlot.getSlotName(), 'Slot blocked', adSlot.getStatus());\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlogger(logGroup, adSlot.getSlotName(), 'Filling in slot');\n\t\t\tfillInCallback(adSlot);\n\t\t}\n\n\t\tif (!this.atfEnded && !adSlot.isAboveTheFold()) {\n\t\t\tthis.slotsQueue.push({ adSlot, fillInCallback: wrappedFillInCallback });\n\t\t\tlogger(logGroup, adSlot.getSlotName(), 'BTF slot pushed to queue');\n\t\t\treturn;\n\t\t}\n\n\t\twrappedFillInCallback(adSlot);\n\t}\n\n\tunblock(slotName) {\n\t\tlogger(logGroup, slotName, 'Unblocking slot');\n\n\t\tthis.unblockedSlots.push(slotName);\n\t\tslotService.enable(slotName);\n\t}\n}\n\nexport const btfBlockerService = new BtfBlockerService();\n","import { logger } from '../utils/logger';\nimport { context } from './context-service';\n\nconst logGroup = 'template-service',\n\ttemplates = {};\n\nclass TemplateService {\n\tregister(template, customConfig = null) {\n\t\tif (typeof template.getName !== 'function') {\n\t\t\tthrow new Error('Template does not implement getName method.');\n\t\t}\n\t\tconst name = template.getName();\n\n\t\tlet config = {};\n\n\t\tif (typeof template.getDefaultConfig === 'function') {\n\t\t\tconfig = template.getDefaultConfig();\n\t\t}\n\n\t\tif (customConfig) {\n\t\t\tconfig = Object.assign(config, customConfig);\n\t\t}\n\n\t\tcontext.set(`templates.${name}`, config);\n\t\ttemplates[name] = template;\n\t}\n\n\tinit(name, slot = null, params = {}) {\n\t\tlogger(logGroup, 'Load template', name, slot, params);\n\t\tif (!templates[name]) {\n\t\t\tthrow new Error(`Template ${name} does not exist.`);\n\t\t}\n\n\t\treturn new templates[name](slot).init(params);\n\t}\n}\n\nexport const templateService = new TemplateService();\n","import { slotService } from './slot-service';\nimport { templateService } from './template-service';\n\nexport function registerCustomAdLoader(methodName) {\n\twindow[methodName] = (params) => {\n\t\tconst slot = slotService.get(params.slotName);\n\n\t\ttemplateService.init(params.type, slot, params);\n\t};\n}\n","/* global Storage */\nimport { logger } from '../utils';\n\nconst logGroup = 'local-cache';\n\nlet canUseStorage;\n\nclass LocalCache {\n\tcanUseStorage() {\n\t\tif (typeof canUseStorage === 'undefined') {\n\t\t\tcanUseStorage = false;\n\t\t\tif (window.localStorage) {\n\t\t\t\ttry {\n\t\t\t\t\twindow.localStorage.setItem('test', '1');\n\t\t\t\t\twindow.localStorage.removeItem('test');\n\t\t\t\t\tcanUseStorage = true;\n\t\t\t\t} catch (e) {\n\t\t\t\t\t/* There are two known possibilities here:\n\t\t\t\t\t *\n\t\t\t\t\t * 1) The browser isn't allowing access due to a\n\t\t\t\t\t * privacy setting (which can happen in Safari).\n\t\t\t\t\t *\n\t\t\t\t\t * 2) The allowed disk space for storage is used\n\t\t\t\t\t * up. However, this is more likely to happen in\n\t\t\t\t\t * calls to LocalCache.set().\n\t\t\t\t\t */\n\t\t\t\t\ttry {\n\t\t\t\t\t\tLocalCache.createPolyfill();\n\t\t\t\t\t\tcanUseStorage = true;\n\t\t\t\t\t} catch (exception) {\n\t\t\t\t\t\tlogger(logGroup, 'Local Storage polyfill error: ', exception);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn canUseStorage;\n\t}\n\n\tcreatePolyfill() {\n\t\tlogger(logGroup, 'Local Storage polyfill being created');\n\t\tStorage.prototype.data = {};\n\n\t\tStorage.prototype.setItem = function setItem(id, val) {\n\t\t\tthis.data[id] = String(val);\n\t\t};\n\n\t\tStorage.prototype.getItem = function getItem(id) {\n\t\t\treturn this.data[id] ? this.data[id] : null;\n\t\t};\n\n\t\tStorage.prototype.removeItem = function removeItem(id) {\n\t\t\tdelete this.data[id];\n\t\t};\n\n\t\tStorage.prototype.clear = function clear() {\n\t\t\tthis.data = {};\n\t\t};\n\t}\n\n\tget(key) {\n\t\tif (!this.canUseStorage()) {\n\t\t\treturn false;\n\t\t}\n\n\t\tlet cacheItem = window.localStorage.getItem(key);\n\n\t\tif (cacheItem) {\n\t\t\t// De-serialize\n\t\t\tcacheItem = JSON.parse(cacheItem);\n\n\t\t\t// Check if item has expired\n\t\t\tif (this.isExpired(cacheItem)) {\n\t\t\t\tthis.delete(key);\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\treturn cacheItem.data;\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tset(key, value, expires = null) {\n\t\tif (!this.canUseStorage() || !this.isStorable(value)) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst cacheItem = { data: value };\n\t\tconst expiresValue = parseInt(expires, 10);\n\n\t\tif (!isNaN(expiresValue)) {\n\t\t\t// Set expiration as a JS timestamp\n\t\t\tcacheItem.expires = (expiresValue * 1000) + Date.now();\n\t\t}\n\n\t\ttry {\n\t\t\twindow.localStorage.setItem(key, JSON.stringify(cacheItem));\n\t\t} catch (e) {\n\t\t\t// Local Storage is at capacity\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tdelete(key) {\n\t\tif (!this.canUseStorage()) {\n\t\t\treturn;\n\t\t}\n\n\t\twindow.localStorage.removeItem(key);\n\t}\n\n\tisStorable(value) {\n\t\tif (\n\t\t\t// Functions might be a security risk\n\t\t\ttypeof value === 'function' ||\n\t\t\t// NaN\n\t\t\t(typeof value === 'number' && isNaN(value)) ||\n\t\t\t// undefined\n\t\t\ttypeof value === 'undefined'\n\t\t) {\n\t\t\treturn false;\n\t\t}\n\n\t\treturn true;\n\t}\n\n\tisExpired(cacheItem) {\n\t\treturn cacheItem.expires && Date.now() >= parseInt(cacheItem.expires, 10);\n\t}\n}\n\nexport const localCache = new LocalCache();\n","import { logger } from '../utils';\n\nconst callbacks = [],\n\tlogGroup = 'message-bus';\n\nfunction isAdEngineMessage(message) {\n\ttry {\n\t\treturn !!JSON.parse(message.data).AdEngine;\n\t} catch (e) {\n\t\treturn false;\n\t}\n}\n\nfunction messageMatch(match, message) {\n\tlet matching = true;\n\n\tif (match.keys) {\n\t\tconst data = JSON.parse(message.data).AdEngine;\n\t\tmatch.keys.forEach((key) => {\n\t\t\tmatching = matching && data[key];\n\t\t});\n\t}\n\n\treturn matching;\n}\n\nfunction onMessage(message) {\n\tlet i = 0,\n\t\tcallback;\n\n\tif (isAdEngineMessage(message)) {\n\t\tlogger(logGroup, 'Message received', message);\n\n\t\tfor (i = 0; i < callbacks.length; i += 1) {\n\t\t\tcallback = callbacks[i];\n\t\t\tif (messageMatch(callback.match, message)) {\n\t\t\t\tlogger(logGroup, 'Matching message', message, callback);\n\n\t\t\t\tcallback.fn(JSON.parse(message.data).AdEngine);\n\n\t\t\t\tif (!callback.match.infinite) {\n\t\t\t\t\tcallbacks.splice(i, 1);\n\t\t\t\t}\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n}\n\nclass MessageBus {\n\tinit() {\n\t\tlogger(logGroup, 'Register message listener');\n\t\twindow.addEventListener('message', onMessage);\n\t}\n\n\tregister(match, callback) {\n\t\tcallbacks.push({\n\t\t\tmatch,\n\t\t\tfn: callback\n\t\t});\n\t}\n}\n\nexport const messageBus = new MessageBus();\n","import { logger } from '../utils';\n\nconst logGroup = 'gpt-size-map';\n\nexport class GptSizeMap {\n\tconstructor(sizeMap) {\n\t\tthis.sizeMap = sizeMap || [];\n\t\tlogger(logGroup, this.sizeMap, 'creating new size map');\n\t}\n\n\taddSize(viewportSize, sizes) {\n\t\tlogger(logGroup, viewportSize, sizes, 'adding new size mapping');\n\t\tthis.sizeMap.push({\n\t\t\tviewportSize,\n\t\t\tsizes\n\t\t});\n\t}\n\n\tbuild() {\n\t\tlogger(logGroup, this.sizeMap, 'creating GPT size mapping builder');\n\t\tconst builder = window.googletag && window.googletag.sizeMapping();\n\n\t\tif (!builder) {\n\t\t\tlogger(logGroup, 'cannot create GPT size mapping builder');\n\t\t\treturn null;\n\t\t}\n\n\t\tthis.sizeMap.forEach(({ viewportSize, sizes }) => {\n\t\t\tbuilder.addSize(viewportSize, sizes);\n\t\t});\n\n\t\treturn builder.build();\n\t}\n\n\tisEmpty() {\n\t\treturn !this.sizeMap.length;\n\t}\n\n\tmapAllSizes(callback) {\n\t\treturn new GptSizeMap(this.sizeMap.map(({ viewportSize, sizes }, index) => {\n\t\t\tconst mappedSizes = callback(sizes, viewportSize, index);\n\n\t\t\tlogger(\n\t\t\t\tlogGroup,\n\t\t\t\tviewportSize,\n\t\t\t\tsizes,\n\t\t\t\tmappedSizes,\n\t\t\t\t'mapping viewport sizes'\n\t\t\t);\n\n\t\t\treturn {\n\t\t\t\tviewportSize,\n\t\t\t\tsizes: mappedSizes\n\t\t\t};\n\t\t}));\n\t}\n\n\ttoString() {\n\t\tlogger(logGroup, this.sizeMap, 'casting to string');\n\t\tconst map = {};\n\n\t\tthis.sizeMap.forEach(({ viewportSize, sizes }) => {\n\t\t\tmap[viewportSize.join('x')] = sizes;\n\t\t});\n\n\t\treturn JSON.stringify(map);\n\t}\n}\n","import { context } from '../services';\n\nexport function setupGptTargeting() {\n\tconst tag = window.googletag.pubads(),\n\t\ttargeting = context.get('targeting');\n\n\tfunction setTargetingValue(key, value) {\n\t\tif (typeof value === 'function') {\n\t\t\ttag.setTargeting(key, value());\n\t\t} else {\n\t\t\ttag.setTargeting(key, value);\n\t\t}\n\t}\n\n\tObject.keys(targeting).forEach((key) => {\n\t\tsetTargetingValue(key, targeting[key]);\n\t});\n\n\tcontext.onChange('targeting', (trigger, value) => {\n\t\tconst segments = trigger.split('.'),\n\t\t\tkey = segments[segments.length - 1];\n\n\t\tsetTargetingValue(key, value);\n\t});\n}\n","import EventEmitter from 'eventemitter3';\nimport { context, slotTweaker, templateService } from '../services';\nimport { stringBuilder } from '../utils';\nimport { slotListener } from '../listeners';\n\nexport class AdSlot extends EventEmitter {\n\tstatic PROPERTY_CHANGED_EVENT = 'propertyChanged';\n\tstatic SLOT_VIEWED_EVENT = 'slotViewed';\n\tstatic VIDEO_VIEWED_EVENT = 'videoViewed';\n\n\tconstructor(ad) {\n\t\tsuper();\n\n\t\tthis.config = context.get(`slots.${ad.id}`) || {};\n\t\tthis.enabled = !this.config.disabled;\n\t\tthis.viewed = false;\n\t\tthis.element = null;\n\t\tthis.status = null;\n\n\t\tthis.config.slotName = this.config.slotName || ad.id;\n\t\tthis.config.targeting = this.config.targeting || {};\n\t\tthis.config.targeting.src = this.config.targeting.src || context.get('src');\n\t\tthis.config.targeting.pos = this.config.targeting.pos || this.getSlotName();\n\n\t\tthis.once(AdSlot.SLOT_VIEWED_EVENT, () => {\n\t\t\tthis.viewed = true;\n\t\t});\n\t}\n\n\tgetAdUnit() {\n\t\tif (!this.adUnit) {\n\t\t\tthis.adUnit = stringBuilder.build(\n\t\t\t\tthis.config.adUnit || context.get('adUnitId'),\n\t\t\t\t{\n\t\t\t\t\tslotConfig: this.config\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\n\t\treturn this.adUnit;\n\t}\n\n\tgetVideoAdUnit() {\n\t\treturn stringBuilder.build(this.config.videoAdUnit || context.get('vast.adUnitId'), {\n\t\t\tslotConfig: this.config\n\t\t});\n\t}\n\n\tgetElement() {\n\t\tif (!this.element) {\n\t\t\tthis.element = document.getElementById(this.getSlotName());\n\t\t}\n\n\t\treturn this.element;\n\t}\n\n\tgetSlotName() {\n\t\treturn this.config.slotName;\n\t}\n\n\tgetSizes() {\n\t\treturn this.config.sizes;\n\t}\n\n\tgetTargeting() {\n\t\treturn this.config.targeting;\n\t}\n\n\tgetDefaultSizes() {\n\t\treturn this.config.defaultSizes;\n\t}\n\n\tgetViewportConflicts() {\n\t\treturn this.config.viewportConflicts || [];\n\t}\n\n\thasDefinedViewportConflicts() {\n\t\treturn this.getViewportConflicts().length > 0;\n\t}\n\n\tgetStatus() {\n\t\treturn this.status;\n\t}\n\n\tsetStatus(status = null) {\n\t\tthis.status = status;\n\t\tif (status !== null) {\n\t\t\tslotListener.emitStatusChanged(this);\n\t\t}\n\t}\n\n\tisAboveTheFold() {\n\t\treturn !!this.config.aboveTheFold;\n\t}\n\n\tisEnabled() {\n\t\treturn this.enabled;\n\t}\n\n\tisViewed() {\n\t\treturn this.viewed;\n\t}\n\n\tisRepeatable() {\n\t\treturn !!this.config.repeat;\n\t}\n\n\tgetCopy() {\n\t\treturn JSON.parse(JSON.stringify(this.config));\n\t}\n\n\tenable() {\n\t\tthis.enabled = true;\n\t}\n\n\tdisable(status = null) {\n\t\tthis.enabled = false;\n\t\tthis.setStatus(status);\n\t}\n\n\tsetConfigProperty(key, value) {\n\t\tcontext.set(`slots.${this.config.slotName}.${key}`, value);\n\t}\n\n\tsuccess(status = 'success') {\n\t\tslotTweaker.show(this);\n\t\tthis.setStatus(status);\n\n\t\tif (this.config.defaultTemplate) {\n\t\t\ttemplateService.init(this.config.defaultTemplate, this);\n\t\t}\n\t}\n\n\tcollapse(status = 'collapse') {\n\t\tslotTweaker.hide(this);\n\t\tthis.setStatus(status);\n\t}\n}\n","import { queryString } from '../utils';\n\nclass VastParser {\n\tgetAdInfo(imaAd) {\n\t\tconst adInfo = {};\n\n\t\tif (imaAd) {\n\t\t\tadInfo.lineItemId = imaAd.getAdId();\n\t\t\tadInfo.creativeId = imaAd.getCreativeId();\n\t\t\tadInfo.contentType = imaAd.getContentType();\n\n\t\t\tconst [lineItemId] = imaAd.getWrapperAdIds() || [];\n\t\t\tif (lineItemId !== undefined) {\n\t\t\t\tadInfo.lineItemId = lineItemId;\n\t\t\t}\n\n\t\t\tconst [creativeId] = imaAd.getWrapperCreativeIds() || [];\n\t\t\tif (creativeId !== undefined) {\n\t\t\t\tadInfo.creativeId = creativeId;\n\t\t\t}\n\t\t}\n\n\t\treturn adInfo;\n\t}\n\n\tparse(vastUrl, extra = {}) {\n\t\tconst currentAd = this.getAdInfo(extra.imaAd),\n\t\t\tvastParams = queryString.getValues(vastUrl.substr(1 + vastUrl.indexOf('?'))),\n\t\t\tcustomParams = queryString.getValues(encodeURI(vastParams.cust_params));\n\n\t\treturn {\n\t\t\tcontentType: currentAd.contentType || extra.contentType,\n\t\t\tcreativeId: currentAd.creativeId || extra.creativeId,\n\t\t\tcustomParams,\n\t\t\tlineItemId: currentAd.lineItemId || extra.lineItemId,\n\t\t\tposition: vastParams.vpos,\n\t\t\tsize: vastParams.sz\n\t\t};\n\t}\n}\n\nexport const vastParser = new VastParser();\n","import { vastParser } from './vast-parser';\n\nfunction setAttribute(element, attribute, value) {\n\tif (!element || !value) {\n\t\treturn;\n\t}\n\n\telement.setAttribute(attribute, value);\n}\n\nclass VastDebugger {\n\tsetVastAttributesFromVastParams(element, status, vastParams) {\n\t\tsetAttribute(element, 'data-vast-content-type', vastParams.contentType);\n\t\tsetAttribute(element, 'data-vast-creative-id', vastParams.creativeId);\n\t\tsetAttribute(element, 'data-vast-line-item-id', vastParams.lineItemId);\n\t\tsetAttribute(element, 'data-vast-position', vastParams.position);\n\t\tsetAttribute(element, 'data-vast-size', vastParams.size);\n\t\tsetAttribute(element, 'data-vast-status', status);\n\t\tsetAttribute(element, 'data-vast-params', JSON.stringify(vastParams.customParams));\n\t}\n\n\tsetVastAttributes(element, vastUrl, status, imaAd) {\n\t\tconst vastParams = vastParser.parse(vastUrl, {\n\t\t\timaAd\n\t\t});\n\n\t\tthis.setVastAttributesFromVastParams(element, status, vastParams);\n\t}\n}\n\nexport const vastDebugger = new VastDebugger();\n","import { context, slotService, trackingOptIn } from '../services';\n\nconst availableVideoPositions = ['preroll', 'midroll', 'postroll'],\n\tbaseUrl = 'https://pubads.g.doubleclick.net/gampad/ads?',\n\tcorrelator = Math.round(Math.random() * 10000000000);\n\nfunction getCustomParameters(slot, extraTargeting = {}) {\n\tconst params = Object.assign({}, context.get('targeting'), slot.getTargeting(), extraTargeting);\n\n\treturn encodeURIComponent(\n\t\tObject.keys(params)\n\t\t\t.filter(key => params[key])\n\t\t\t.map(key => `${key}=${params[key]}`)\n\t\t\t.join('&')\n\t);\n}\n\nfunction isNumeric(n) {\n\treturn !isNaN(parseFloat(n)) && isFinite(n);\n}\n\nexport function buildVastUrl(aspectRatio, slotName, options = {}) {\n\tconst params = [\n\t\t\t'output=vast',\n\t\t\t'env=vp',\n\t\t\t'gdfp_req=1',\n\t\t\t'impl=s',\n\t\t\t'unviewed_position_start=1',\n\t\t\t`sz=${(aspectRatio > 1 || !isNumeric(aspectRatio) ? '640x480' : '320x480')}`,\n\t\t\t`url=${encodeURIComponent(window.location.href)}`,\n\t\t\t`description_url=${encodeURIComponent(window.location.href)}`,\n\t\t\t`correlator=${correlator}`\n\t\t],\n\t\tslot = slotService.get(slotName);\n\n\tif (slot) {\n\t\tparams.push(`iu=${slot.getVideoAdUnit()}`);\n\t\tparams.push(`cust_params=${getCustomParameters(slot, options.targeting)}`);\n\t} else {\n\t\tthrow Error('Slot does not exist!');\n\t}\n\n\tif (options.contentSourceId && options.videoId) {\n\t\tparams.push(`cmsid=${options.contentSourceId}`);\n\t\tparams.push(`vid=${options.videoId}`);\n\t}\n\n\tif (options.vpos && availableVideoPositions.indexOf(options.vpos) > -1) {\n\t\tparams.push(`vpos=${options.vpos}`);\n\t}\n\n\tif (options.numberOfAds !== undefined) {\n\t\tparams.push(`pmad=${options.numberOfAds}`);\n\t}\n\n\tparams.push(`npa=${trackingOptIn.isOptedIn() ? 0 : 1}`);\n\n\treturn baseUrl + params.join('&');\n}\n","import { context, slotService } from '../../../../services';\nimport { logger, queryString } from '../../../../utils';\nimport { buildVastUrl } from '../../../vast-url-builder';\n\nconst logGroup = 'google-ima-setup';\n\nfunction getOverriddenVast() {\n\tif (queryString.get('porvata_override_vast') === '1') {\n\t\tconst vastXML = window.localStorage.getItem('porvata_vast');\n\t\tlogger(logGroup, 'Overridden VAST', vastXML);\n\n\t\treturn vastXML;\n\t}\n\n\treturn null;\n}\n\nfunction createRequest(params) {\n\tconst adSlot = slotService.get(params.slotName),\n\t\tadsRequest = new window.google.ima.AdsRequest(),\n\t\toverriddenVast = getOverriddenVast();\n\n\tif (params.vastResponse || overriddenVast) {\n\t\tadsRequest.adsResponse = overriddenVast || params.vastResponse;\n\t}\n\n\tif (context.get('options.porvata.audio.exposeToSlot')) {\n\t\tconst key = context.get('options.porvata.audio.key'),\n\t\t\tsegment = context.get('options.porvata.audio.segment');\n\n\t\tadSlot.setConfigProperty('audioSegment', params.autoPlay ? '' : segment);\n\t\tadSlot.setConfigProperty(`targeting.${key}`, params.autoPlay ? 'no' : 'yes');\n\t}\n\n\tadsRequest.adTagUrl = params.vastUrl || buildVastUrl(params.width / params.height, params.slotName, {\n\t\ttargeting: params.vastTargeting\n\t});\n\tadsRequest.linearAdSlotWidth = params.width;\n\tadsRequest.linearAdSlotHeight = params.height;\n\n\treturn adsRequest;\n}\n\nfunction getRenderingSettings(params = {}) {\n\tconst adsRenderingSettings = new window.google.ima.AdsRenderingSettings(),\n\t\tmaximumRecommendedBitrate = 68000; // 2160p High Frame Rate\n\n\tif (!context.get('state.isMobile')) {\n\t\tadsRenderingSettings.bitrate = maximumRecommendedBitrate;\n\t}\n\n\tadsRenderingSettings.loadVideoTimeout = params.loadVideoTimeout || 15000;\n\tadsRenderingSettings.enablePreloading = true;\n\tadsRenderingSettings.uiElements = [];\n\n\treturn adsRenderingSettings;\n}\n\nexport const googleImaSetup = {\n\tcreateRequest,\n\tgetRenderingSettings\n};\n","// Fixes for MOAT script incompatibility\nlet eventMapping = {},\n\tlisteners = [],\n\tmoatapi = {};\n\n// MOAT CODE START\n/* Copyright (c) 2011-2016 Moat Inc. All Rights Reserved. */\n// eslint-disable-next-line\nexport function initMoatTracking(a,f,c){if(!1===f.hasOwnProperty(\"partnerCode\"))return!1;var g=document.createElement(\"script\");c=c||a&&(\"undefined\"!==typeof a.O?a.O.parentNode:document.body)||document.body;listeners=[];moatapi={adsManager:a,ids:f,imaSDK:!0,events:[]};eventMapping={complete:\"AdVideoComplete\",firstquartile:\"AdVideoFirstQuartile\",impression:\"AdImpression\",loaded:\"AdLoaded\",midpoint:\"AdVideoMidpoint\",pause:\"AdPaused\",skip:\"AdSkipped\",start:\"AdVideoStart\",thirdquartile:\"AdVideoThirdQuartile\",volumeChange:\"AdVolumeChange\"};if(google&&google.ima&&a){var d=\"_moatApi\"+Math.floor(1E8*Math.random()),h;for(h in google.ima.AdEvent.Type){var l=function(b){if(moatapi.sendEvent){for(b=listeners.length-1;0<=b;b--)a.removeEventListener(listeners[b].type,listeners[b].func);moatapi.sendEvent(moatapi.events)}else moatapi.events.push({type:eventMapping[b.type]||b.type,adVolume:a.getVolume()})};a.addEventListener(google.ima.AdEvent.Type[h],l);listeners.push({type:google.ima.AdEvent.Type[h],func:l})}}var d= \"undefined\"!==typeof d?d:\"\",e,k;try{e=c.ownerDocument,k=e.defaultView||e.parentWindow}catch(m){e=document,k=window}k[d]=moatapi;g.type=\"text/javascript\";c&&c.appendChild(g);g.src=\"https://z.moatads.com/\"+f.partnerCode+\"/moatvideo.js#\"+d};\n// MOAT CODE END\n","import { logger } from '../../../../utils';\nimport { context } from '../../../../services';\nimport { initMoatTracking } from './moat-video-tracker-script';\n\nconst logGroup = 'moat-video-tracker';\n\nclass MoatVideoTracker {\n\tinit(adsManager, container, viewMode, slicer1, slicer2) {\n\t\tconst ids = {\n\t\t\tpartnerCode: context.get('options.video.moatTracking.partnerCode'),\n\t\t\tviewMode,\n\t\t\tslicer1,\n\t\t\tslicer2\n\t\t};\n\n\t\ttry {\n\t\t\tinitMoatTracking(adsManager, ids, container);\n\t\t\tlogger(logGroup, 'MOAT video tracking initialized');\n\t\t} catch (error) {\n\t\t\tlogger(logGroup, 'MOAT video tracking initalization error', error);\n\t\t}\n\t}\n}\n\nexport const moatVideoTracker = new MoatVideoTracker();\n","import { googleImaSetup } from './google-ima-setup';\nimport { moatVideoTracker } from '../moat/moat-video-tracker';\nimport { vastDebugger } from '../../../vast-debugger';\n\nfunction getVideoElement() {\n\tconst videoElement = document.createElement('video');\n\n\tvideoElement.setAttribute('preload', 'none');\n\n\treturn videoElement;\n}\n\nclass GoogleImaPlayer {\n\tconstructor(adDisplayContainer, adsLoader, params) {\n\t\tthis.isAdsManagerLoaded = false;\n\t\tthis.status = '';\n\t\tthis.adDisplayContainer = adDisplayContainer;\n\t\tthis.adsLoader = adsLoader;\n\t\tthis.adsManager = null;\n\t\tthis.params = params;\n\t\tthis.mobileVideoAd = params.container.querySelector('video');\n\t\tthis.eventListeners = {};\n\t\tthis.vastUrl = '';\n\t}\n\n\tsetVastUrl(vastUrl) {\n\t\tthis.vastUrl = vastUrl;\n\t}\n\n\tsetAdsManager(adsManager) {\n\t\tthis.adsManager = adsManager;\n\t\tthis.isAdsManagerLoaded = true;\n\t}\n\n\taddEventListener(eventName, callback) {\n\t\tif (eventName.indexOf('wikia') !== -1) {\n\t\t\tthis.eventListeners[eventName] = this.eventListeners[eventName] || [];\n\t\t\tthis.eventListeners[eventName].push(callback);\n\t\t\treturn;\n\t\t}\n\n\t\tif (this.isAdsManagerLoaded) {\n\t\t\tthis.adsManager.addEventListener(eventName, callback);\n\t\t} else {\n\t\t\tthis.adsLoader.addEventListener('adsManagerLoaded', () => {\n\t\t\t\tthis.adsManager.addEventListener(eventName, callback);\n\t\t\t});\n\t\t}\n\t}\n\n\tsetVastAttributes(status) {\n\t\tconst currentAd = this.adsManager && this.adsManager.getCurrentAd && this.adsManager.getCurrentAd(),\n\t\t\tplayerElement = this.params.container.querySelector('.video-player');\n\n\t\tvastDebugger.setVastAttributes(playerElement, this.vastUrl, status, currentAd);\n\t}\n\n\tsetAutoPlay(value) {\n\t\t// mobileVideoAd DOM element is present on mobile only\n\t\tif (this.mobileVideoAd) {\n\t\t\tthis.mobileVideoAd.autoplay = value;\n\t\t\tthis.mobileVideoAd.muted = value;\n\t\t}\n\t\tthis.params.autoPlay = value;\n\t}\n\n\tplayVideo(width, height) {\n\t\tconst callback = () => {\n\t\t\tthis.dispatchEvent('wikiaAdPlayTriggered');\n\t\t\t// https://developers.google.com/interactive-media-ads/docs/sdks/html5/v3/apis#ima.AdDisplayContainer.initialize\n\t\t\tthis.adDisplayContainer.initialize();\n\t\t\tthis.adsManager.init(Math.round(width), Math.round(height), window.google.ima.ViewMode.NORMAL);\n\t\t\tthis.adsManager.start();\n\t\t\tthis.adsLoader.removeEventListener('adsManagerLoaded', callback);\n\t\t};\n\n\t\tif (this.isAdsManagerLoaded) {\n\t\t\tcallback();\n\t\t} else {\n\t\t\t// When adsManager is not loaded yet video can't start without click on mobile\n\t\t\t// Muted auto play is workaround to run video on adsManagerLoaded event\n\t\t\tthis.setAutoPlay(true);\n\t\t\tthis.adsLoader.addEventListener('adsManagerLoaded', callback, false);\n\t\t}\n\t}\n\n\treload() {\n\t\tconst adRequest = googleImaSetup.createRequest(this.params);\n\n\t\tthis.adsManager.destroy();\n\t\tthis.adsLoader.contentComplete();\n\t\tthis.setVastUrl(adRequest.adTagUrl);\n\t\tthis.adsLoader.requestAds(adRequest);\n\t}\n\n\tresize(width, height, isFullscreen = false) {\n\t\tconst viewMode = window.google.ima.ViewMode;\n\n\t\tif (this.adsManager) {\n\t\t\tthis.adsManager.resize(\n\t\t\t\tMath.round(width),\n\t\t\t\tMath.round(height),\n\t\t\t\tisFullscreen ? viewMode.FULLSCREEN : viewMode.NORMAL\n\t\t\t);\n\t\t}\n\t}\n\n\tdispatchEvent(eventName) {\n\t\tif (this.eventListeners[eventName] && this.eventListeners[eventName].length > 0) {\n\t\t\tthis.eventListeners[eventName].forEach((callback) => {\n\t\t\t\tcallback({});\n\t\t\t});\n\t\t}\n\t}\n\n\tsetStatus(newStatus) {\n\t\treturn () => {\n\t\t\tthis.status = newStatus;\n\t\t};\n\t}\n\n\tgetStatus() {\n\t\treturn this.status;\n\t}\n\n\tgetAdsManager() {\n\t\treturn this.adsManager;\n\t}\n}\n\nexport const googleImaPlayerFactory = {\n\tcreate(adDisplayContainer, adsLoader, videoSettings) {\n\t\tconst adRequest = googleImaSetup.createRequest(videoSettings.getParams()),\n\t\t\tplayer = new GoogleImaPlayer(adDisplayContainer, adsLoader, videoSettings.getParams()),\n\t\t\tvideoElement = getVideoElement();\n\n\t\tif (player.mobileVideoAd) {\n\t\t\tvideoSettings.getContainer().classList.add('mobile-porvata');\n\t\t}\n\n\t\tadsLoader.addEventListener('adsManagerLoaded', (adsManagerLoadedEvent) => {\n\t\t\tconst renderingSettings = googleImaSetup.getRenderingSettings(videoSettings),\n\t\t\t\tadsManager = adsManagerLoadedEvent.getAdsManager(videoElement, renderingSettings);\n\t\t\tplayer.setAdsManager(adsManager);\n\n\t\t\tif (videoSettings.isMoatTrackingEnabled()) {\n\t\t\t\tmoatVideoTracker.init(\n\t\t\t\t\tadsManager,\n\t\t\t\t\tvideoSettings.getContainer(),\n\t\t\t\t\twindow.google.ima.ViewMode.NORMAL,\n\t\t\t\t\tvideoSettings.get('src'),\n\t\t\t\t\t`${videoSettings.get('adProduct')}/${videoSettings.get('slotName')}`\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tplayer.dispatchEvent('wikiaAdsManagerLoaded');\n\n\t\t\tadsManager.addEventListener('loaded', () => player.setVastAttributes('success'));\n\t\t\tadsManager.addEventListener('adError', () => player.setVastAttributes('error'));\n\t\t}, false);\n\n\t\tadsLoader.addEventListener('adError', () => player.setVastAttributes('error'));\n\n\t\tplayer.setVastUrl(adRequest.adTagUrl);\n\t\tadsLoader.requestAds(adRequest);\n\t\tif (videoSettings.get('autoPlay')) {\n\t\t\tplayer.setAutoPlay(true);\n\t\t}\n\n\t\tplayer.addEventListener('resume', player.setStatus('playing'));\n\t\tplayer.addEventListener('start', player.setStatus('playing'));\n\t\tplayer.addEventListener('pause', player.setStatus('paused'));\n\t\tplayer.addEventListener('wikiaAdStop', player.setStatus('stopped'));\n\t\tplayer.addEventListener('allAdsCompleted', player.setStatus('stopped'));\n\n\t\treturn player;\n\t}\n};\n","import { googleImaPlayerFactory } from './google-ima-player-factory';\nimport { scriptLoader } from '../../../../utils';\n\nconst imaLibraryUrl = '//imasdk.googleapis.com/js/sdkloader/ima3.js';\n\nfunction load() {\n\tif (window.google && window.google.ima) {\n\t\treturn new Promise((resolve) => {\n\t\t\tresolve();\n\t\t});\n\t}\n\n\treturn scriptLoader.loadScript(imaLibraryUrl);\n}\n\nfunction getPlayer(videoSettings) {\n\tconst adDisplayContainer = new window.google.ima.AdDisplayContainer(videoSettings.getContainer()),\n\t\tiframe = videoSettings.getContainer().querySelector('div > iframe');\n\n\t// Reload iframe in order to make IMA work when user is moving back/forward to the page with player\n\t// https://groups.google.com/forum/#!topic/ima-sdk/Q6Y56CcXkpk\n\t// https://github.com/googleads/videojs-ima/issues/110\n\tif (window.performance && window.performance.navigation.type === window.performance.navigation.TYPE_BACK_FORWARD) {\n\t\tiframe.contentWindow.location.href = iframe.src;\n\t}\n\n\tconst adsLoader = new window.google.ima.AdsLoader(adDisplayContainer);\n\n\treturn googleImaPlayerFactory.create(adDisplayContainer, adsLoader, videoSettings);\n}\n\nexport const googleIma = {\n\tload,\n\tgetPlayer\n};\n","import { context } from '../../../services';\nimport { sampler } from '../../../utils';\n\nfunction getMoatTrackingStatus(params) {\n\tconst sampling = context.get('options.video.moatTracking.sampling');\n\n\tif (typeof params.moatTracking === 'boolean') {\n\t\treturn params.moatTracking;\n\t}\n\n\tif (!context.get('options.video.moatTracking.enabled')) {\n\t\treturn false;\n\t}\n\n\tif (sampling === 100) {\n\t\treturn true;\n\t}\n\n\tif (sampling > 0) {\n\t\treturn sampler.sample('moat_video_tracking', sampling);\n\t}\n\n\treturn false;\n}\n\nexport class VideoSettings {\n\tconstructor(params = {}) {\n\t\tthis.params = params;\n\t\tthis.moatTracking = getMoatTrackingStatus(params);\n\t}\n\n\tget(key) {\n\t\treturn this.params[key];\n\t}\n\n\tgetContainer() {\n\t\treturn this.get('container');\n\t}\n\n\tgetParams() {\n\t\treturn this.params;\n\t}\n\n\tisMoatTrackingEnabled() {\n\t\treturn this.moatTracking;\n\t}\n}\n","import { googleIma } from './ima/google-ima';\nimport { PorvataListener } from '../../../listeners';\nimport { VideoSettings } from './video-settings';\nimport { viewportObserver, tryProperty, whichProperty } from '../../../utils';\n\nconst VIDEO_FULLSCREEN_CLASS_NAME = 'video-player-fullscreen';\nconst STOP_SCROLLING_CLASS_NAME = 'stop-scrolling';\n\nconst prepareVideoAdContainer = (params) => {\n\tconst videoAdContainer = params.container.querySelector('div');\n\n\tvideoAdContainer.classList.add('video-player');\n\tvideoAdContainer.classList.add('hide');\n\n\treturn videoAdContainer;\n};\n\nconst nativeFullscreenOnElement = (element) => {\n\tconst enter = tryProperty(element, [\n\t\t'webkitRequestFullscreen',\n\t\t'mozRequestFullScreen',\n\t\t'msRequestFullscreen',\n\t\t'requestFullscreen'\n\t]);\n\tconst exit = tryProperty(document, [\n\t\t'webkitExitFullscreen',\n\t\t'mozCancelFullScreen',\n\t\t'msExitFullscreen',\n\t\t'exitFullscreen'\n\t]);\n\tconst fullscreenChangeEvent = (whichProperty(document, [\n\t\t'onwebkitfullscreenchange',\n\t\t'onmozfullscreenchange',\n\t\t'onmsfullscreenchange',\n\t\t'onfullscreenchange'\n\t]) || '')\n\t\t.replace(/^on/, '')\n\t\t.replace('msfullscreenchange', 'MSFullscreenChange');\n\tconst addChangeListener = (...args) => document.addEventListener(fullscreenChangeEvent, ...args);\n\tconst removeChangeListener = (...args) => document.removeEventListener(fullscreenChangeEvent, ...args);\n\tconst isSupported = () => Boolean(enter && exit);\n\n\treturn {\n\t\tenter,\n\t\texit,\n\t\taddChangeListener,\n\t\tremoveChangeListener,\n\t\tisSupported\n\t};\n};\n\nexport class PorvataPlayer {\n\tconstructor(ima, params) {\n\t\tthis.ima = ima;\n\t\tthis.container = prepareVideoAdContainer(params);\n\t\tthis.mobileVideoAd = params.container.querySelector('video');\n\t\tthis.params = params;\n\n\t\tconst nativeFullscreen = nativeFullscreenOnElement(this.container);\n\n\t\tthis.fullscreen = Boolean(params.isFullscreen);\n\t\tthis.nativeFullscreen = nativeFullscreen;\n\t\tthis.width = params.width;\n\t\tthis.height = params.height;\n\t\tthis.muteProtect = false;\n\t\tthis.defaultVolume = 0.75;\n\n\t\tif (nativeFullscreen.isSupported()) {\n\t\t\tnativeFullscreen.addChangeListener(() => this.onFullscreenChange());\n\t\t}\n\t}\n\n\taddEventListener(eventName, callback) {\n\t\tthis.ima.addEventListener(eventName, callback);\n\t}\n\n\tgetRemainingTime() {\n\t\treturn this.ima.getAdsManager().getRemainingTime();\n\t}\n\n\tisFullscreen() {\n\t\treturn this.fullscreen;\n\t}\n\n\tisMuted() {\n\t\treturn this.ima.getAdsManager().getVolume() === 0;\n\t}\n\n\tisMobilePlayerMuted() {\n\t\tconst mobileVideoAd = this.container.querySelector('video');\n\t\treturn mobileVideoAd && mobileVideoAd.autoplay && mobileVideoAd.muted;\n\t}\n\n\tisPaused() {\n\t\treturn this.ima.getStatus() === 'paused';\n\t}\n\n\tisPlaying() {\n\t\treturn this.ima.getStatus() === 'playing';\n\t}\n\n\tpause() {\n\t\tthis.ima.getAdsManager().pause();\n\t}\n\n\tplay(newWidth, newHeight) {\n\t\tif (newWidth !== undefined && newHeight !== undefined) {\n\t\t\tthis.width = newWidth;\n\t\t\tthis.height = newHeight;\n\t\t}\n\t\tif (!this.width || !this.height || this.isFullscreen()) {\n\t\t\tthis.width = this.params.container.offsetWidth;\n\t\t\tthis.height = this.params.container.offsetHeight;\n\t\t}\n\n\t\tthis.ima.playVideo(this.width, this.height);\n\t}\n\n\treload() {\n\t\tthis.ima.reload();\n\t}\n\n\tresize(newWidth, newHeight) {\n\t\tif (isFinite(newWidth) && isFinite(newHeight)) {\n\t\t\tthis.width = newWidth;\n\t\t\tthis.height = newHeight;\n\t\t}\n\n\t\tif (this.isFullscreen()) {\n\t\t\tthis.ima.resize(window.innerWidth, window.innerHeight, true);\n\t\t} else {\n\t\t\tthis.ima.resize(this.width, this.height, false);\n\t\t}\n\t}\n\n\tresume() {\n\t\tthis.ima.getAdsManager().resume();\n\t}\n\n\trewind() {\n\t\tthis.params.autoPlay = false;\n\t\tthis.ima.setAutoPlay(false);\n\t\tthis.ima.dispatchEvent('wikiaAdRestart');\n\t\tthis.play();\n\t}\n\n\tsetVolume(volume) {\n\t\tthis.updateVideoDOMElement(volume);\n\t\tthis.ima.getAdsManager().setVolume(volume);\n\n\t\t// This is hack for Safari, because it can't dispatch original IMA event (volumeChange)\n\t\tthis.ima.dispatchEvent('wikiaVolumeChange');\n\t}\n\n\ttoggleFullscreen() {\n\t\tconst isFullscreen = this.isFullscreen();\n\t\tconst { nativeFullscreen } = this;\n\n\t\tthis.muteProtect = true;\n\n\t\tif (nativeFullscreen.isSupported()) {\n\t\t\tconst toggleNativeFullscreen = isFullscreen ? nativeFullscreen.exit : nativeFullscreen.enter;\n\t\t\ttoggleNativeFullscreen();\n\t\t} else {\n\t\t\tthis.onFullscreenChange();\n\t\t}\n\t}\n\n\tonFullscreenChange() {\n\t\tthis.fullscreen = !this.fullscreen;\n\n\t\tif (this.isFullscreen()) {\n\t\t\tthis.container.classList.add(VIDEO_FULLSCREEN_CLASS_NAME);\n\t\t\tdocument.documentElement.classList.add(STOP_SCROLLING_CLASS_NAME);\n\t\t} else {\n\t\t\tthis.container.classList.remove(VIDEO_FULLSCREEN_CLASS_NAME);\n\t\t\tdocument.documentElement.classList.remove(STOP_SCROLLING_CLASS_NAME);\n\n\t\t\tif (this.muteProtect) {\n\t\t\t\tthis.muteProtect = false;\n\t\t\t} else if (this.isPlaying() && !this.isMuted()) {\n\t\t\t\tthis.mute();\n\t\t\t}\n\t\t}\n\n\t\tthis.resize();\n\t\tthis.ima.dispatchEvent('wikiaFullscreenChange');\n\t}\n\n\tupdateVideoDOMElement(volume) {\n\t\tif (this.mobileVideoAd) {\n\t\t\tthis.mobileVideoAd.muted = volume === 0;\n\t\t\tthis.mobileVideoAd.volume = volume;\n\t\t}\n\t}\n\n\tmute() {\n\t\tthis.setVolume(0);\n\t}\n\n\tunmute() {\n\t\tthis.setVolume(this.defaultVolume);\n\n\t\tif (this.params.autoPlay && this.params.restartOnUnmute) {\n\t\t\tthis.rewind();\n\t\t}\n\t}\n\n\tvolumeToggle() {\n\t\tif (this.isMuted()) {\n\t\t\tthis.unmute();\n\t\t\tthis.ima.dispatchEvent('wikiaAdUnmute');\n\t\t} else {\n\t\t\tthis.mute();\n\t\t\tthis.ima.dispatchEvent('wikiaAdMute');\n\t\t}\n\t}\n\n\tstop() {\n\t\tthis.ima.getAdsManager().stop();\n\t\tthis.ima.dispatchEvent('wikiaAdStop');\n\t}\n}\n\nexport class Porvata {\n\t/**\n\t * @private\n\t * @returns listener id\n\t */\n\tstatic addOnViewportChangeListener(params, listener) {\n\t\treturn viewportObserver.addListener(params.container, listener, {\n\t\t\toffsetTop: params.viewportOffsetTop || 0,\n\t\t\toffsetBottom: params.viewportOffsetBottom || 0\n\t\t});\n\t}\n\n\tstatic inject(params) {\n\t\tconst porvataListener = new PorvataListener({\n\t\t\tadProduct: params.adProduct,\n\t\t\tposition: params.slotName,\n\t\t\tsrc: params.src,\n\t\t\twithAudio: !params.autoPlay\n\t\t});\n\n\t\tlet isFirstPlay = true,\n\t\t\tautoPaused = false,\n\t\t\tautoPlayed = false,\n\t\t\tviewportListenerId = null;\n\n\t\tfunction muteFirstPlay(video) {\n\t\t\tvideo.addEventListener('loaded', () => {\n\t\t\t\tif (isFirstPlay) {\n\t\t\t\t\tvideo.mute();\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tparams.vastTargeting = params.vastTargeting || {\n\t\t\tpassback: 'porvata'\n\t\t};\n\n\t\tconst videoSettings = new VideoSettings(params);\n\n\t\tporvataListener.init();\n\n\t\treturn googleIma.load()\n\t\t\t.then(() => googleIma.getPlayer(videoSettings))\n\t\t\t.then(ima => new PorvataPlayer(ima, params))\n\t\t\t.then((video) => {\n\t\t\t\tfunction inViewportCallback(isVisible) {\n\t\t\t\t\t// Play video automatically only for the first time\n\t\t\t\t\tif (isVisible && !autoPlayed && params.autoPlay) {\n\t\t\t\t\t\tvideo.play();\n\t\t\t\t\t\tautoPlayed = true;\n\t\t\t\t\t// Don't resume when video was paused manually\n\t\t\t\t\t} else if (isVisible && autoPaused) {\n\t\t\t\t\t\tvideo.resume();\n\t\t\t\t\t// Pause video once it's out of viewport and set autoPaused to distinguish manual and auto pause\n\t\t\t\t\t} else if (!isVisible && video.isPlaying() && !params.blockOutOfViewportPausing) {\n\t\t\t\t\t\tvideo.pause();\n\t\t\t\t\t\tautoPaused = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tfunction setupAutoPlayMethod() {\n\t\t\t\t\tif (params.blockOutOfViewportPausing) {\n\t\t\t\t\t\tif (params.autoPlay && !autoPlayed) {\n\t\t\t\t\t\t\tautoPlayed = true;\n\t\t\t\t\t\t\tvideo.play();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tviewportListenerId = Porvata.addOnViewportChangeListener(params, inViewportCallback);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tporvataListener.registerVideoEvents(video);\n\n\t\t\t\tvideo.addEventListener('adCanPlay', () => {\n\t\t\t\t\tvideo.ima.dispatchEvent('wikiaAdStarted');\n\t\t\t\t});\n\t\t\t\tvideo.addEventListener('allAdsCompleted', () => {\n\t\t\t\t\tif (video.isFullscreen()) {\n\t\t\t\t\t\tvideo.toggleFullscreen();\n\t\t\t\t\t}\n\n\t\t\t\t\tvideo.ima.setAutoPlay(false);\n\t\t\t\t\tvideo.ima.dispatchEvent('wikiaAdCompleted');\n\t\t\t\t\tif (viewportListenerId) {\n\t\t\t\t\t\tviewportObserver.removeListener(viewportListenerId);\n\t\t\t\t\t\tviewportListenerId = null;\n\t\t\t\t\t}\n\t\t\t\t\tisFirstPlay = false;\n\t\t\t\t\tporvataListener.params.withAudio = true;\n\t\t\t\t});\n\t\t\t\tvideo.addEventListener('wikiaAdRestart', () => {\n\t\t\t\t\tisFirstPlay = false;\n\t\t\t\t});\n\t\t\t\tvideo.addEventListener('start', () => {\n\t\t\t\t\tvideo.ima.dispatchEvent('wikiaAdPlay');\n\t\t\t\t\tif (!viewportListenerId && !autoPlayed) {\n\t\t\t\t\t\tsetupAutoPlayMethod();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tvideo.addEventListener('resume', () => {\n\t\t\t\t\tvideo.ima.dispatchEvent('wikiaAdPlay');\n\t\t\t\t\tautoPaused = false;\n\t\t\t\t});\n\t\t\t\tvideo.addEventListener('pause', () => {\n\t\t\t\t\tvideo.ima.dispatchEvent('wikiaAdPause');\n\t\t\t\t});\n\n\t\t\t\tif (params.autoPlay) {\n\t\t\t\t\tmuteFirstPlay(video);\n\t\t\t\t}\n\n\t\t\t\tif (params.onReady) {\n\t\t\t\t\tparams.onReady(video);\n\t\t\t\t}\n\n\t\t\t\tvideo.addEventListener('wikiaAdsManagerLoaded', () => {\n\t\t\t\t\tsetupAutoPlayMethod();\n\t\t\t\t});\n\n\t\t\t\treturn video;\n\t\t\t});\n\t}\n}\n","export * from './porvata';\nexport * from './video-settings';\nexport * from './moat/moat-video-tracker';\nexport * from './ima/google-ima-player-factory';\n","export * from './vast-debugger';\nexport * from './vast-parser';\nexport * from './vast-url-builder';\nexport * from './player/porvata';\n","import { client, logger } from '../utils';\nimport { context, slotService } from '../services';\nimport { AdSlot } from '../models';\nimport { vastParser } from '../video';\n\nfunction getListeners() {\n\treturn context.get('listeners.porvata');\n}\n\nexport class PorvataListener {\n\tstatic EVENTS = {\n\t\tadCanPlay: 'ad_can_play',\n\t\tcomplete: 'completed',\n\t\tclick: 'clicked',\n\t\tfirstquartile: 'first_quartile',\n\t\timpression: 'impression',\n\t\tloaded: 'loaded',\n\t\tmidpoint: 'midpoint',\n\t\tpause: 'paused',\n\t\tresume: 'resumed',\n\t\tstart: 'started',\n\t\tthirdquartile: 'third_quartile',\n\t\tviewable_impression: 'viewable_impression',\n\t\tadError: 'error',\n\t\twikiaAdPlayTriggered: 'play_triggered',\n\t\twikiaAdStop: 'closed',\n\t\twikiaAdMute: 'mute',\n\t\twikiaAdUnmute: 'unmute'\n\t};\n\tstatic LOG_GROUP = 'porvata-listener';\n\tstatic PLAYER_NAME = 'porvata';\n\n\tconstructor(params) {\n\t\tthis.params = params;\n\t\tthis.listeners = getListeners().filter(listener => !listener.isEnabled || listener.isEnabled());\n\t\tthis.logger = (...args) => logger(PorvataListener.LOG_GROUP, ...args);\n\t}\n\n\tinit() {\n\t\tthis.dispatch('init');\n\t}\n\n\tregisterVideoEvents(video) {\n\t\tthis.video = video;\n\t\tthis.dispatch('ready');\n\n\t\tObject.keys(PorvataListener.EVENTS).forEach((eventKey) => {\n\t\t\tvideo.addEventListener(eventKey, (event) => {\n\t\t\t\tconst errorCode = event.getError && event.getError().getErrorCode();\n\n\t\t\t\tthis.dispatch(PorvataListener.EVENTS[eventKey], errorCode);\n\t\t\t});\n\t\t});\n\t}\n\n\tdispatch(eventName, errorCode = 0) {\n\t\tconst data = this.getData(eventName, errorCode);\n\n\t\tthis.logger(eventName, data);\n\t\tthis.listeners.forEach((listener) => {\n\t\t\tlistener.onEvent(eventName, this.params, data);\n\t\t});\n\n\t\tif (this.params.position && eventName === PorvataListener.EVENTS.viewable_impression) {\n\t\t\tconst adSlot = slotService.get(this.params.position);\n\t\t\tadSlot.emit(AdSlot.VIDEO_VIEWED_EVENT);\n\t\t}\n\t}\n\n\tgetData(eventName, errorCode) {\n\t\tconst imaAd = this.video && this.video.ima.getAdsManager() && this.video.ima.getAdsManager().getCurrentAd(),\n\t\t\t{ contentType, creativeId, lineItemId } = vastParser.getAdInfo(imaAd);\n\n\t\treturn {\n\t\t\tad_error_code: errorCode,\n\t\t\tad_product: this.params.adProduct,\n\t\t\tbrowser: `${client.getOperatingSystem()} ${client.getBrowser()}`,\n\t\t\tcontent_type: contentType || '(none)',\n\t\t\tcreative_id: creativeId || 0,\n\t\t\tevent_name: eventName,\n\t\t\tline_item_id: lineItemId || 0,\n\t\t\tplayer: PorvataListener.PLAYER_NAME,\n\t\t\tposition: this.params.position || '(none)',\n\t\t\ttimestamp: new Date().getTime(),\n\t\t\taudio: this.params.withAudio ? 1 : 0\n\t\t};\n\t}\n}\n","import { getTopOffset } from '../utils/dimensions';\n\nconst callbacks = {};\n\nfunction getUniqueId() {\n\treturn ((1 + Math.random()) * 0x1000000).toString(16).substring(1);\n}\n\nfunction pushSlot(adStack, node) {\n\tadStack.push({\n\t\tid: node.id\n\t});\n}\n\nclass ScrollListener {\n\tinit() {\n\t\tlet requestAnimationFrameHandleAdded = false;\n\n\t\tdocument.addEventListener('scroll', (event) => {\n\t\t\tif (!requestAnimationFrameHandleAdded) {\n\t\t\t\twindow.requestAnimationFrame(() => {\n\t\t\t\t\trequestAnimationFrameHandleAdded = false;\n\t\t\t\t\tObject.keys(callbacks).forEach((id) => {\n\t\t\t\t\t\tif (typeof callbacks[id] === 'function') {\n\t\t\t\t\t\t\tcallbacks[id](event, id);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t});\n\t\t\t\trequestAnimationFrameHandleAdded = true;\n\t\t\t}\n\t\t});\n\t}\n\n\taddSlot(adStack, id, threshold = 0) {\n\t\tconst node = document.getElementById(id);\n\n\t\tif (!node) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.addCallback((event, callbackId) => {\n\t\t\tconst scrollPosition = window.scrollY || window.pageYOffset || document.documentElement.scrollTop,\n\t\t\t\tslotPosition = getTopOffset(node),\n\t\t\t\tviewPortHeight = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\n\n\t\t\tif (scrollPosition + viewPortHeight > slotPosition - threshold) {\n\t\t\t\tthis.removeCallback(callbackId);\n\t\t\t\tpushSlot(adStack, node);\n\t\t\t}\n\t\t});\n\t}\n\n\taddCallback(callback) {\n\t\tconst id = getUniqueId();\n\t\tcallbacks[id] = callback;\n\n\t\treturn id;\n\t}\n\n\tremoveCallback(id) {\n\t\tdelete callbacks[id];\n\t}\n}\n\nexport const scrollListener = new ScrollListener();\n","import { logger, client } from '../utils';\nimport { AdSlot } from '../models';\nimport { context, slotTweaker, slotDataParamsUpdater } from '../services';\n\nconst logGroup = 'slot-listener';\n\nlet listeners = null;\n\nfunction getIframe(adSlot) {\n\treturn adSlot.getElement().querySelector('div[id*=\"_container_\"] iframe');\n}\n\nfunction getAdType(event, adSlot) {\n\tconst iframe = getIframe(adSlot);\n\n\tlet isIframeAccessible = false;\n\n\tif (event.isEmpty) {\n\t\treturn 'collapse';\n\t}\n\n\ttry {\n\t\tisIframeAccessible = !!iframe.contentWindow.document.querySelector;\n\t} catch (e) {\n\t\tlogger(logGroup, 'getAdType', 'iframe is not accessible');\n\t}\n\n\tif (isIframeAccessible && iframe.contentWindow.AdEngine_adType) {\n\t\treturn iframe.contentWindow.AdEngine_adType;\n\t}\n\n\treturn 'success';\n}\n\nfunction getData(adSlot, { adType, event }) {\n\tconst data = {\n\t\tbrowser: `${client.getOperatingSystem()} ${client.getBrowser()}`,\n\t\tstatus: adType || adSlot.getStatus(),\n\t\tpage_width: window.document.body.scrollWidth || '',\n\t\ttime_bucket: (new Date()).getHours(),\n\t\ttimestamp: new Date().getTime(),\n\t\tviewport_height: window.innerHeight || 0\n\t};\n\n\tif (event) {\n\t\tif (event.slot) {\n\t\t\tconst response = event.slot.getResponseInformation();\n\n\t\t\tif (response) {\n\t\t\t\tdata.creative_id = response.creativeId;\n\t\t\t\tdata.line_item_id = response.lineItemId;\n\t\t\t}\n\t\t}\n\n\t\tif (event.size && event.size.length) {\n\t\t\tdata.creative_size = event.size.join('x');\n\t\t}\n\t}\n\n\treturn data;\n}\n\nfunction dispatch(methodName, adSlot, adInfo = {}) {\n\tif (!listeners) {\n\t\tlisteners = context.get('listeners.slot').filter(listener => !listener.isEnabled || listener.isEnabled());\n\t}\n\n\tconst data = getData(adSlot, adInfo);\n\n\tlisteners.forEach((listener) => {\n\t\tif (typeof listener[methodName] !== 'function') {\n\t\t\treturn;\n\t\t}\n\n\t\tlistener[methodName](adSlot, data);\n\t});\n\tlogger(logGroup, methodName, adSlot, adInfo, data);\n}\n\nclass SlotListener {\n\temitRenderEnded(event, adSlot) {\n\t\tconst adType = getAdType(event, adSlot);\n\n\t\tslotDataParamsUpdater.updateOnRenderEnd(adSlot, event);\n\n\t\tswitch (adType) {\n\t\t\tcase 'collapse':\n\t\t\t\tadSlot.collapse();\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tadSlot.success();\n\t\t\t\tbreak;\n\t\t}\n\n\t\tdispatch('onRenderEnded', adSlot, { adType, event });\n\t}\n\n\temitImpressionViewable(event, adSlot) {\n\t\tadSlot.emit(AdSlot.SLOT_VIEWED_EVENT);\n\t\tdispatch('onImpressionViewable', adSlot, { event });\n\t\tslotTweaker.setDataParam(adSlot, 'slotViewed', true);\n\t}\n\n\temitStatusChanged(adSlot) {\n\t\tslotTweaker.setDataParam(adSlot, 'slotResult', adSlot.getStatus());\n\t\tdispatch('onStatusChanged', adSlot);\n\t}\n}\n\nexport const slotListener = new SlotListener();\n","export * from './porvata-listener';\nexport * from './scroll-listener';\nexport * from './slot-listener';\n","import { logger, makeLazyQueue } from './../utils';\n\nexport class BaseBidder {\n\tconstructor(bidderConfig, resetListener, timeout = 2000) {\n\t\tthis.logGroup = 'bidder';\n\t\tthis.bidderConfig = bidderConfig;\n\t\tthis.timeout = timeout;\n\n\t\tthis.resetState();\n\n\t\tif (resetListener) {\n\t\t\tresetListener(this.resetState);\n\t\t}\n\n\t\tthis.onResponse = () => this.onResponseCall();\n\t}\n\n\tstatic responseCallback(callback) {\n\t\tcallback();\n\t}\n\n\taddResponseListener(callback) {\n\t\tthis.onResponseCallbacks.push(callback);\n\t}\n\n\tcall() {\n\t\tthis.response = false;\n\n\t\tif (this.callBids) {\n\t\t\tthis.callBids(this.onResponse);\n\t\t}\n\n\t\tthis.called = true;\n\t}\n\n\tcreateWithTimeout(func, msToTimeout = 2000) {\n\t\tconst timeout = new Promise((resolve, reject) => {\n\t\t\tsetTimeout(reject, msToTimeout);\n\t\t});\n\n\t\treturn Promise.race([new Promise(func), timeout]);\n\t}\n\n\tgetName() {\n\t\treturn this.name;\n\t}\n\n\tgetSlotBestPrice(slotName) {\n\t\tif (this.getBestPrice) {\n\t\t\treturn this.getBestPrice(slotName);\n\t\t}\n\n\t\treturn {};\n\t}\n\n\tgetSlotTargetingParams(slotName, floorPrice) {\n\t\tif (!this.called || !this.isSlotSupported(slotName) || !this.getTargetingParams) {\n\t\t\treturn {};\n\t\t}\n\n\t\treturn this.getTargetingParams(slotName, floorPrice);\n\t}\n\n\thasResponse() {\n\t\treturn this.response;\n\t}\n\n\tisSlotSupported(slotName) {\n\t\tif (this.isSupported) {\n\t\t\treturn this.isSupported(slotName);\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tonResponseCall() {\n\t\t// this.calculatePrices();\n\t\tif (this.onResponseCallbacks) {\n\t\t\tthis.onResponseCallbacks.start();\n\t\t}\n\n\t\tthis.response = true;\n\t}\n\n\tresetState() {\n\t\tthis.called = false;\n\t\tthis.response = false;\n\t\tthis.onResponseCallbacks = [];\n\n\t\tmakeLazyQueue(this.onResponseCallbacks, BaseBidder.responseCallback);\n\t}\n\n\twaitForResponse() {\n\t\treturn this.createWithTimeout((resolve) => {\n\t\t\tif (this.hasResponse()) {\n\t\t\t\tresolve();\n\t\t\t} else {\n\t\t\t\tthis.addResponseListener(resolve);\n\t\t\t}\n\t\t}, this.timeout);\n\t}\n\n\twasCalled() {\n\t\treturn this.called;\n\t}\n}\n","export class BaseAdapter {\n\tconstructor({ enabled, slots }) {\n\t\tthis.enabled = enabled;\n\t\tthis.slots = slots;\n\t}\n\n\tprepareAdUnits() {\n\t\treturn Object\n\t\t\t.keys(this.slots)\n\t\t\t.map(\n\t\t\t\tslotName => this.prepareConfigForAdUnit(slotName, this.slots[slotName])\n\t\t\t);\n\t}\n}\n","import { BaseAdapter } from './base-adapter';\n\nexport class Aol extends BaseAdapter {\n\tconstructor(options) {\n\t\tsuper(options);\n\n\t\tthis.bidderName = 'aol';\n\t\tthis.network = '9435.1';\n\t}\n\n\tprepareConfigForAdUnit(code, {\n\t\tsizes, placement, alias, sizeId\n\t}) {\n\t\treturn {\n\t\t\tcode,\n\t\t\tmediaTypes: {\n\t\t\t\tbanner: {\n\t\t\t\t\tsizes\n\t\t\t\t}\n\t\t\t},\n\t\t\tbids: [\n\t\t\t\t{\n\t\t\t\t\tbidder: this.bidderName,\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tplacement,\n\t\t\t\t\t\tnetwork: this.network,\n\t\t\t\t\t\talias,\n\t\t\t\t\t\tsizeId\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\t}\n}\n","import { BaseAdapter } from './base-adapter';\nimport { context } from './../../../services/context-service';\n\nexport class Appnexus extends BaseAdapter {\n\tconstructor(options) {\n\t\tsuper(options);\n\n\t\tthis.bidderName = 'appnexus';\n\t\tthis.placements = options.placements;\n\t\t/* this.recoveryPlacements = {\n\t\t\tatf: '11823778',\n\t\t\tbtf: '11823724',\n\t\t\thivi: '11823799'\n\t\t} */\n\t}\n\n\tprepareConfigForAdUnit(code, { sizes, position = 'mobile' }) {\n\t\treturn {\n\t\t\tcode,\n\t\t\tmediaTypes: {\n\t\t\t\tbanner: {\n\t\t\t\t\tsizes\n\t\t\t\t}\n\t\t\t},\n\t\t\tbids: [\n\t\t\t\t{\n\t\t\t\t\tbidder: this.bidderName,\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tplacementId: this.getPlacement(position)\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\t}\n\n\tgetPlacement(position) {\n\t\tif (position === 'mobile') {\n\t\t\tconst vertical = context.get('targeting.mappedVerticalName');\n\n\t\t\tposition = vertical && this.placements[vertical] ? vertical : 'other';\n\t\t}\n\n\t\treturn this.placements[position];\n\t}\n}\n","import { BaseAdapter } from './base-adapter';\nimport { queryString } from './../../../utils/query-string';\n\nexport class AppnexusAst extends BaseAdapter {\n\tconstructor(options) {\n\t\tsuper(options);\n\n\t\tthis.bidderName = 'appnexusAst';\n\t\tthis.aliases = {\n\t\t\tappnexus: [this.bidderName]\n\t\t};\n\t\tthis.debugPlacementId = '5768085';\n\t\tthis.isDebugMode = queryString.get('appnexusast_debug_mode') === '1';\n\t}\n\n\tprepareConfigForAdUnit(code, { placementId }) {\n\t\treturn {\n\t\t\tcode,\n\t\t\tmediaTypes: {\n\t\t\t\tvideo: {\n\t\t\t\t\tcontext: 'outstream',\n\t\t\t\t\tplayerSize: [640, 480]\n\t\t\t\t}\n\t\t\t},\n\t\t\tbids: [\n\t\t\t\t{\n\t\t\t\t\tbidder: this.bidderName,\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tplacementId: this.isDebugMode ? this.debugPlacementId : placementId,\n\t\t\t\t\t\tvideo: {\n\t\t\t\t\t\t\tskippable: false,\n\t\t\t\t\t\t\tplayback_method: ['auto_play_sound_off']\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\t}\n}\n","import { BaseAdapter } from './base-adapter';\n\nexport class AppnexusWebads extends BaseAdapter {\n\tconstructor(options) {\n\t\tsuper(options);\n\n\t\tthis.bidderName = 'appnexusWebAds';\n\t\tthis.aliases = {\n\t\t\tappnexus: [this.bidderName]\n\t\t};\n\t\tthis.priority = 0;\n\t}\n\n\tprepareConfigForAdUnit(code, { placementId, sizes }) {\n\t\treturn {\n\t\t\tcode,\n\t\t\tmediaTypes: {\n\t\t\t\tbanner: {\n\t\t\t\t\tsizes\n\t\t\t\t}\n\t\t\t},\n\t\t\tbids: [\n\t\t\t\t{\n\t\t\t\t\tbidder: this.bidderName,\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tplacementId\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\t}\n}\n","import { BaseAdapter } from './base-adapter';\nimport { queryString } from './../../../utils/query-string';\n\nexport class AudienceNetwork extends BaseAdapter {\n\tconstructor(options) {\n\t\tsuper(options);\n\n\t\tthis.bidderName = 'audienceNetwork';\n\t\tthis.testMode = queryString.get('audiencenetworktest') === 'true';\n\t}\n\n\tprepareConfigForAdUnit(code, { sizes, placementId }) {\n\t\treturn {\n\t\t\tcode,\n\t\t\tmediaTypes: {\n\t\t\t\tbanner: {\n\t\t\t\t\tsizes\n\t\t\t\t}\n\t\t\t},\n\t\t\tbids: [\n\t\t\t\t{\n\t\t\t\t\tbidder: this.bidderName,\n\t\t\t\t\tparams: {\n\t\t\t\t\t\ttestMode: this.testMode,\n\t\t\t\t\t\tplacementId\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\t}\n}\n","import { BaseAdapter } from './base-adapter';\nimport { queryString } from './../../../utils/query-string';\n\nexport class Beachfront extends BaseAdapter {\n\tconstructor(options) {\n\t\tsuper(options);\n\n\t\tthis.bidderName = 'beachfront';\n\t\tthis.bidfloor = 0.01;\n\t\tthis.debugAppId = '2e55f7ad-3558-49eb-a3e1-056ccd0e74e2';\n\t\tthis.isDebugMode = queryString.get('beachfront_debug_mode') === '1';\n\t}\n\n\tprepareConfigForAdUnit(code, { appId }) {\n\t\treturn {\n\t\t\tcode,\n\t\t\tmediaTypes: {\n\t\t\t\tvideo: {\n\t\t\t\t\tplayerSize: [640, 480]\n\t\t\t\t}\n\t\t\t},\n\t\t\tbids: [\n\t\t\t\t{\n\t\t\t\t\tbidder: this.bidderName,\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tbidfloor: this.bidfloor,\n\t\t\t\t\t\tappId: this.isDebugMode ? this.debugAppId : appId\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\t}\n}\n","import { BaseAdapter } from './base-adapter';\n\nexport class IndexExchange extends BaseAdapter {\n\tconstructor(options) {\n\t\tsuper(options);\n\n\t\tthis.bidderName = 'indexExchange';\n\t\tthis.aliases = {\n\t\t\tix: [this.bidderName]\n\t\t};\n\t\t/* this.recoveryConfig = {\n\t\t\tTOP_LEADERBOARD: {\n\t\t\t\tsizes: [\n\t\t\t\t\t[728, 90],\n\t\t\t\t\t[970, 250]\n\t\t\t\t],\n\t\t\t\tsiteId: 215807\n\t\t\t},\n\t\t\tTOP_RIGHT_BOXAD: {\n\t\t\t\tsizes: [\n\t\t\t\t\t[300, 250],\n\t\t\t\t\t[300, 600]\n\t\t\t\t],\n\t\t\t\tsiteId: 215808\n\t\t\t},\n\t\t\tINCONTENT_BOXAD_1: {\n\t\t\t\tsizes: [\n\t\t\t\t\t[160, 600],\n\t\t\t\t\t[300, 600],\n\t\t\t\t\t[300, 250]\n\t\t\t\t],\n\t\t\t\tsiteId: 215809\n\t\t\t},\n\t\t\tBOTTOM_LEADERBOARD: {\n\t\t\t\tsizes: [\n\t\t\t\t\t[728, 90],\n\t\t\t\t\t[970, 250]\n\t\t\t\t],\n\t\t\t\tsiteId: 215810\n\t\t\t}\n\t\t}; */\n\t}\n\n\tprepareConfigForAdUnit(code, { sizes, siteId }) {\n\t\treturn {\n\t\t\tcode,\n\t\t\tmediaTypes: {\n\t\t\t\tbanner: {\n\t\t\t\t\tsizes\n\t\t\t\t}\n\t\t\t},\n\t\t\tbids: sizes.map(size => ({\n\t\t\t\tbidder: this.bidderName,\n\t\t\t\tparams: {\n\t\t\t\t\tsiteId,\n\t\t\t\t\tsize\n\t\t\t\t}\n\t\t\t}))\n\t\t};\n\t}\n}\n","import { BaseAdapter } from './base-adapter';\n\nexport class Onemobile extends BaseAdapter {\n\tconstructor(options) {\n\t\tsuper(options);\n\n\t\tthis.bidderName = 'onemobile';\n\t\tthis.siteId = '2c9d2b50015e5e9a6540a64f3eac0266';\n\t}\n\n\tprepareConfigForAdUnit(code, { sizes, pos }) {\n\t\treturn {\n\t\t\tcode,\n\t\t\tmediaTypes: {\n\t\t\t\tbanner: {\n\t\t\t\t\tsizes\n\t\t\t\t}\n\t\t\t},\n\t\t\tbids: [\n\t\t\t\t{\n\t\t\t\t\tbidder: this.bidderName,\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tdcn: this.siteId,\n\t\t\t\t\t\tpos\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\t}\n}\n","import { BaseAdapter } from './base-adapter';\n\nexport class Openx extends BaseAdapter {\n\tconstructor(options) {\n\t\tsuper(options);\n\n\t\tthis.bidderName = 'openx';\n\t\tthis.delDomain = 'wikia-d.openx.net';\n\t}\n\n\tprepareConfigForAdUnit(code, { sizes, unit }) {\n\t\treturn {\n\t\t\tcode,\n\t\t\tmediaTypes: {\n\t\t\t\tbanner: {\n\t\t\t\t\tsizes\n\t\t\t\t}\n\t\t\t},\n\t\t\tbids: [\n\t\t\t\t{\n\t\t\t\t\tbidder: this.bidderName,\n\t\t\t\t\tparams: {\n\t\t\t\t\t\tunit,\n\t\t\t\t\t\tdelDomain: this.delDomain\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\t}\n}\n","import { BaseAdapter } from './base-adapter';\n\nexport class Pubmatic extends BaseAdapter {\n\tconstructor(options) {\n\t\tsuper(options);\n\n\t\tthis.bidderName = 'pubmatic';\n\t\tthis.publisherId = '156260';\n\t}\n\n\tprepareConfigForAdUnit(code, { sizes, ids }) {\n\t\treturn {\n\t\t\tcode,\n\t\t\tmediaTypes: {\n\t\t\t\tbanner: {\n\t\t\t\t\tsizes\n\t\t\t\t}\n\t\t\t},\n\t\t\tbids: ids.map(adSlot => ({\n\t\t\t\tbidder: this.bidderName,\n\t\t\t\tparams: {\n\t\t\t\t\tadSlot,\n\t\t\t\t\tpublisherId: this.publisherId\n\t\t\t\t}\n\t\t\t}))\n\t\t};\n\t}\n}\n","import { context } from './../../services/context-service';\nimport { getAdapters } from './adapters-registry';\n\nconst lazyLoadSlots = [\n\t'BOTTOM_LEADERBOARD'\n];\n\nfunction isSlotAvailable(code, lazyLoad = 'off') {\n\tlet available = true;\n\tconst isSlotLazy = lazyLoadSlots.indexOf(code) !== -1;\n\n\tif (lazyLoad !== 'off' && ((lazyLoad === 'pre' && isSlotLazy) || (lazyLoad === 'post' && !isSlotLazy))) {\n\t\tavailable = false;\n\t}\n\n\treturn available;\n}\n\nexport function setupAdUnits(adaptersConfig) {\n\tconst adUnits = [];\n\tconst adapters = getAdapters(adaptersConfig);\n\n\tadapters.forEach((adapter) => {\n\t\tif (adapter && adapter.enabled) {\n\t\t\tconst adapterAdUnits = adapter.prepareAdUnits();\n\n\t\t\tadapterAdUnits.forEach((adUnit) => {\n\t\t\t\tif (adUnit && isSlotAvailable(adUnit.code)) {\n\t\t\t\t\tadUnits.push(adUnit);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n\n\treturn adUnits;\n}\n\nexport function getTargeting(slotName) {\n\tconst provider = context.get('state.isMobile') ? 'mobile' : 'gpt',\n\t\ts1 = context.get('targeting.wikiIsTop1000') ? context.get('targeting.s1') : 'not a top1k wiki';\n\n\treturn {\n\t\tpos: [slotName],\n\t\tsrc: [provider],\n\t\ts0: [context.get('targeting.s0') || ''],\n\t\ts1: [s1],\n\t\ts2: [context.get('targeting.s2') || ''],\n\t\tlang: [context.get('targeting.wikiLanguage') || 'en']\n\t};\n}\n","import { BaseAdapter } from './base-adapter';\nimport { context } from './../../../services/context-service';\nimport { getTargeting } from './../prebid-helper';\n\nexport class Rubicon extends BaseAdapter {\n\tconstructor(options) {\n\t\tsuper(options);\n\n\t\tthis.bidderName = 'rubicon';\n\t\tthis.accountId = 7450;\n\t}\n\n\tprepareConfigForAdUnit(code, {\n\t\tsiteId, zoneId, sizeId, position\n\t}) {\n\t\tif (code === 'FEATURED' && !context.get('bidders.rubiconInFV')) {\n\t\t\treturn null;\n\t\t}\n\n\t\tconst targeting = getTargeting(code);\n\n\t\treturn {\n\t\t\tcode,\n\t\t\tmediaType: 'video',\n\t\t\tmediaTypes: {\n\t\t\t\tvideo: {\n\t\t\t\t\tplayerSize: [640, 480]\n\t\t\t\t}\n\t\t\t},\n\t\t\tbids: [\n\t\t\t\t{\n\t\t\t\t\tbidder: this.bidderName,\n\t\t\t\t\tparams: {\n\t\t\t\t\t\taccountId: this.accountId,\n\t\t\t\t\t\tsiteId,\n\t\t\t\t\t\tzoneId,\n\t\t\t\t\t\tname: code,\n\t\t\t\t\t\tposition,\n\t\t\t\t\t\tinventory: targeting,\n\t\t\t\t\t\tvideo: {\n\t\t\t\t\t\t\tplayerWidth: '640',\n\t\t\t\t\t\t\tplayerHeight: '480',\n\t\t\t\t\t\t\tsize_id: sizeId,\n\t\t\t\t\t\t\tlanguage: targeting.lang[0]\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\t}\n}\n","import { BaseAdapter } from './base-adapter';\nimport { getTargeting } from './../prebid-helper';\n\nexport class RubiconDisplay extends BaseAdapter {\n\tconstructor(options) {\n\t\tsuper(options);\n\n\t\tthis.bidderName = 'rubicon_display';\n\t\tthis.aliases = {\n\t\t\trubicon: [this.bidderName]\n\t\t};\n\t\tthis.accountId = 7450;\n\t}\n\n\tprepareConfigForAdUnit(code, {\n\t\tsiteId, zoneId, sizes, position, targeting\n\t}) {\n\t\tconst pageTargeting = getTargeting(code);\n\n\t\tObject\n\t\t\t.keys(targeting || {})\n\t\t\t.forEach((key) => {\n\t\t\t\tpageTargeting[key] = targeting[key];\n\t\t\t});\n\n\t\treturn {\n\t\t\tcode,\n\t\t\tmediaTypes: {\n\t\t\t\tbanner: {\n\t\t\t\t\tsizes\n\t\t\t\t}\n\t\t\t},\n\t\t\tbids: [\n\t\t\t\t{\n\t\t\t\t\tbidder: this.bidderName,\n\t\t\t\t\tparams: {\n\t\t\t\t\t\taccountId: this.accountId,\n\t\t\t\t\t\tsiteId,\n\t\t\t\t\t\tzoneId,\n\t\t\t\t\t\tname: code,\n\t\t\t\t\t\tposition,\n\t\t\t\t\t\tkeywords: ['rp.fastlane'],\n\t\t\t\t\t\tinventory: pageTargeting\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\t}\n}\n","import { BaseAdapter } from './base-adapter';\nimport { queryString } from './../../../utils/query-string';\n\nexport class Wikia extends BaseAdapter {\n\tconstructor(options) {\n\t\tsuper(options);\n\n\t\tthis.bidderName = 'wikia';\n\t\tthis.enabled = !!(queryString.get('wikia_adapter'));\n\n\t\tif (this.enabled) {\n\t\t\tthis.price = this.getPrice();\n\t\t}\n\n\t\tthis.create = () => this;\n\t}\n\n\tprepareConfigForAdUnit(code, { sizes }) {\n\t\treturn {\n\t\t\tcode,\n\t\t\tmediaTypes: {\n\t\t\t\tbanner: {\n\t\t\t\t\tsizes\n\t\t\t\t}\n\t\t\t},\n\t\t\tbids: [\n\t\t\t\t{\n\t\t\t\t\tbidder: this.bidderName\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\t}\n\n\tgetSpec() {\n\t\treturn {\n\t\t\tcode: this.bidderName,\n\t\t\tsupportedMediaTypes: ['banner']\n\t\t};\n\t}\n\n\tgetPrice() {\n\t\tconst price = queryString.get('wikia_adapter');\n\n\t\treturn parseInt(price, 10) / 100;\n\t}\n\n\tcallBids(bidRequest, addBidResponse, done) {\n\t\twindow.pbjs.que.push(() => {\n\t\t\tthis.addBids(bidRequest, addBidResponse, done);\n\t\t});\n\t}\n\n\taddBids(bidRequest, addBidResponse, done) {\n\t\tbidRequest.bids.forEach((bid) => {\n\t\t\tconst bidResponse = window.pbjs.createBid(1),\n\t\t\t\t[width, height] = bid.sizes[0];\n\n\t\t\tbidResponse.ad = this.getCreative(bid.sizes[0]);\n\t\t\tbidResponse.bidderCode = bidRequest.bidderCode;\n\t\t\tbidResponse.cpm = this.price;\n\t\t\tbidResponse.ttl = 300;\n\t\t\tbidResponse.mediaType = 'banner';\n\t\t\tbidResponse.width = width;\n\t\t\tbidResponse.height = height;\n\n\t\t\taddBidResponse(bid.adUnitCode, bidResponse);\n\t\t\tdone();\n\t\t});\n\t}\n\n\tgetCreative(size) {\n\t\tconst creative = document.createElement('div');\n\n\t\tcreative.style.background = '#00b7e0';\n\t\tcreative.style.color = '#fff';\n\t\tcreative.style.fontFamily = 'sans-serif';\n\t\tcreative.style.height = '100%';\n\t\tcreative.style.textAlign = 'center';\n\t\tcreative.style.width = '100%';\n\n\t\tconst title = document.createElement('p');\n\n\t\ttitle.innerText = 'Wikia Creative';\n\t\ttitle.style.fontWeight = 'bold';\n\t\ttitle.style.margin = '0';\n\t\ttitle.style.paddingTop = '10px';\n\n\t\tconst details = document.createElement('small');\n\n\t\tdetails.innerText = `price: ${this.price}, ${size}: ${size.join('x')}`;\n\n\t\tcreative.appendChild(title);\n\t\tcreative.appendChild(details);\n\n\t\treturn creative.outerHTML;\n\t}\n}\n","import { BaseAdapter } from './base-adapter';\nimport { buildVastUrl } from './../../../video/vast-url-builder';\nimport { queryString } from './../../../utils/query-string';\n\nexport class WikiaVideo extends BaseAdapter {\n\tconstructor(options) {\n\t\tsuper(options);\n\n\t\tthis.bidderName = 'wikiaVideo';\n\t\tthis.enabled = !!(queryString.get('wikia_video_adapter'));\n\n\t\tif (this.enabled) {\n\t\t\tthis.price = this.getPrice();\n\t\t}\n\n\t\tthis.create = () => this;\n\t}\n\n\tprepareConfigForAdUnit(code) {\n\t\treturn {\n\t\t\tcode,\n\t\t\tmediaTypes: {\n\t\t\t\tvideo: {\n\t\t\t\t\tcontext: 'outstream',\n\t\t\t\t\tplayerSize: [640, 480]\n\t\t\t\t}\n\t\t\t},\n\t\t\tbids: [\n\t\t\t\t{\n\t\t\t\t\tbidder: this.bidderName\n\t\t\t\t}\n\t\t\t]\n\t\t};\n\t}\n\n\tgetSpec() {\n\t\treturn {\n\t\t\tcode: this.bidderName,\n\t\t\tsupportedMediaTypes: ['video']\n\t\t};\n\t}\n\n\tgetPrice() {\n\t\tconst price = queryString.get('wikia_video_adapter');\n\n\t\treturn parseInt(price, 10) / 100;\n\t}\n\n\tcallBids(bidRequest, addBidResponse, done) {\n\t\twindow.pbjs.que.push(() => {\n\t\t\tthis.addBids(bidRequest, addBidResponse, done);\n\t\t});\n\t}\n\n\taddBids(bidRequest, addBidResponse, done) {\n\t\tbidRequest.bids.forEach((bid) => {\n\t\t\tconst bidResponse = window.pbjs.createBid(1),\n\t\t\t\t[width, height] = bid.sizes[0];\n\n\t\t\tbidResponse.bidderCode = bidRequest.bidderCode;\n\t\t\tbidResponse.cpm = this.price;\n\t\t\tbidResponse.creativeId = 'foo123_wikiaVideoCreativeId';\n\t\t\tbidResponse.ttl = 300;\n\t\t\tbidResponse.mediaType = 'video';\n\t\t\tbidResponse.width = width;\n\t\t\tbidResponse.height = height;\n\t\t\tbidResponse.vastUrl = buildVastUrl(\n\t\t\t\tbidResponse.width / bidResponse.height,\n\t\t\t\tbid.adUnitCode,\n\t\t\t\t{\n\t\t\t\t\tsrc: 'test',\n\t\t\t\t\tpos: 'outstream',\n\t\t\t\t\tpassback: 'wikiaVideo'\n\t\t\t\t}\n\t\t\t);\n\n\t\t\taddBidResponse(bid.adUnitCode, bidResponse);\n\t\t\tdone();\n\t\t});\n\t}\n}\n","import { Aol } from './adapters/aol';\nimport { Appnexus } from './adapters/appnexus';\nimport { AppnexusAst } from './adapters/appnexus-ast';\nimport { AppnexusWebads } from './adapters/appnexus-webads';\nimport { AudienceNetwork } from './adapters/audience-network';\nimport { Beachfront } from './adapters/beachfront';\nimport { IndexExchange } from './adapters/index-exchange';\nimport { Onemobile } from './adapters/onemobile';\nimport { Openx } from './adapters/openx';\nimport { Pubmatic } from './adapters/pubmatic';\nimport { Rubicon } from './adapters/rubicon';\nimport { RubiconDisplay } from './adapters/rubicon-display';\nimport { Wikia } from './adapters/wikia';\nimport { WikiaVideo } from './adapters/wikia-video';\n\nconst adapters = [];\nconst customAdapters = [];\nconst availableAdapters = {\n\taol: Aol,\n\tappnexus: Appnexus,\n\tappnexusAst: AppnexusAst,\n\tappnexusWebads: AppnexusWebads,\n\taudienceNetwork: AudienceNetwork,\n\tbeachfront: Beachfront,\n\tindexExchange: IndexExchange,\n\tonemobile: Onemobile,\n\topenx: Openx,\n\tpubmatic: Pubmatic,\n\trubicon: Rubicon,\n\trubiconDisplay: RubiconDisplay\n};\n\nfunction registerAliases() {\n\tadapters\n\t\t.filter(adapter => adapter.aliases)\n\t\t.forEach((adapter) => {\n\t\t\twindow.pbjs.que.push(() => {\n\t\t\t\tconst aliasMap = adapter.aliases;\n\n\t\t\t\tObject.keys(aliasMap)\n\t\t\t\t\t.forEach((bidderName) => {\n\t\t\t\t\t\taliasMap[bidderName].forEach((alias) => {\n\t\t\t\t\t\t\twindow.pbjs.aliasBidder(bidderName, alias);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t});\n\t\t});\n}\n\nfunction setupAdapters(bidders) {\n\tObject\n\t\t.keys(availableAdapters)\n\t\t.forEach((key) => {\n\t\t\tif (bidders[key]) {\n\t\t\t\tconst adapter = new availableAdapters[key](bidders[key]);\n\n\t\t\t\tadapters.push(adapter);\n\t\t\t}\n\t\t});\n\n\tsetupCustomAdapters(bidders);\n}\n\nfunction setupCustomAdapters(bidders) {\n\tif (bidders.wikia) {\n\t\tcustomAdapters.push(new Wikia(bidders.wikia));\n\t}\n\n\tif (bidders.wikiaVideo) {\n\t\tcustomAdapters.push(new WikiaVideo(bidders.wikiaVideo));\n\t}\n\n\tcustomAdapters.forEach((adapter) => {\n\t\tadapters.push(adapter);\n\n\t\twindow.pbjs.que.push(() => {\n\t\t\twindow.pbjs.registerBidAdapter(adapter.create, adapter.bidderName);\n\t\t});\n\t});\n}\n\nexport function getPriorities() {\n\tconst priorities = {};\n\n\tadapters.forEach((adapter) => {\n\t\tpriorities[adapter.bidderName] = adapter.priority || 1;\n\t});\n\n\treturn priorities;\n}\n\nexport function getAdapters(config) {\n\tif (adapters.length === 0 && config) {\n\t\tsetupAdapters(config);\n\t\tregisterAliases();\n\t}\n\n\treturn adapters;\n}\n","import { Prebid } from './';\nimport { getAdapters } from './adapters-registry';\n\nfunction isValidPrice(bid) {\n\treturn bid.getStatusCode && bid.getStatusCode() === Prebid.validResponseStatusCode;\n}\n\nexport function getPrebidBestPrice(slotName) {\n\tconst bestPrices = {};\n\n\tif (window.pbjs && window.pbjs.getBidResponsesForAdUnitCode) {\n\t\tconst slotBids = window.pbjs.getBidResponsesForAdUnitCode(slotName).bids || [];\n\n\t\tgetAdapters().forEach((adapter) => {\n\t\t\tbestPrices[adapter.bidderName] = '';\n\t\t});\n\n\t\tslotBids.forEach((bid) => {\n\t\t\tif (isValidPrice(bid)) {\n\t\t\t\tconst { bidderCode, cpm } = bid;\n\t\t\t\tconst cpmPrice = transformPriceFromCpm(cpm);\n\n\t\t\t\tbestPrices[bidderCode] = Math.max(bestPrices[bidderCode] || 0, parseFloat(cpmPrice)).toFixed(2).toString();\n\t\t\t}\n\t\t});\n\t}\n\n\treturn bestPrices;\n}\n\nexport function transformPriceFromCpm(cpm, maxCpm = 20) {\n\tconst defaultCpm = 20;\n\n\tif (maxCpm < defaultCpm) {\n\t\tmaxCpm = defaultCpm;\n\t}\n\n\tlet result = Math.floor(maxCpm).toFixed(2);\n\n\tif (cpm === 0) {\n\t\tresult = '0.00';\n\t} else if (cpm < 0.05) {\n\t\tresult = '0.01';\n\t} else if (cpm < 5.00) {\n\t\tresult = (Math.floor(cpm * 20) / 20).toFixed(2);\n\t} else if (cpm < 10.00) {\n\t\tresult = (Math.floor(cpm * 10) / 10).toFixed(2);\n\t} else if (cpm < 20.00) {\n\t\tresult = (Math.floor(cpm * 2) / 2).toFixed(2);\n\t} else if (cpm < maxCpm) {\n\t\tresult = Math.floor(cpm).toFixed(2);\n\t}\n\n\treturn result;\n}\n","import { transformPriceFromCpm } from './price-helper';\n\nexport function getSettings() {\n\treturn {\n\t\tstandard: {\n\t\t\talwaysUseBid: false,\n\t\t\tadserverTargeting: [{\n\t\t\t\tkey: 'hb_bidder',\n\t\t\t\tval: ({ bidderCode }) => bidderCode\n\t\t\t}, {\n\t\t\t\tkey: 'hb_adid',\n\t\t\t\tval: ({ adId }) => adId\n\t\t\t}, {\n\t\t\t\tkey: 'hb_pb',\n\t\t\t\tval: bidResponse => transformPriceFromCpm(bidResponse.cpm)\n\t\t\t}, {\n\t\t\t\tkey: 'hb_size',\n\t\t\t\tval: ({ size }) => size\n\t\t\t}]\n\t\t}\n\t};\n}\n","import { BaseBidder } from './../base-bidder';\nimport { queryString } from './../../utils/query-string';\nimport { getPriorities } from './adapters-registry';\nimport { getPrebidBestPrice} from './price-helper';\nimport { getSettings } from './prebid-settings';\nimport { setupAdUnits } from './prebid-helper';\n\nexport class Prebid extends BaseBidder {\n\tconstructor(...args) {\n\t\tsuper(...args);\n\n\t\tthis.logGroup = 'prebid-bidder';\n\t\tthis.name = 'prebid';\n\t\tthis.adUnits = setupAdUnits(this.bidderConfig);\n\t\tthis.isCMPEnabled = false;\n\t\tthis.prebidConfig = {\n\t\t\tdebug: queryString.get('pbjs_debug') === '1',\n\t\t\tenableSendAllBids: true,\n\t\t\tbidderSequence: 'random',\n\t\t\tbidderTimeout: this.timeout,\n\t\t\tuserSync: {\n\t\t\t\tiframeEnabled: true,\n\t\t\t\tenabledBidders: [],\n\t\t\t\tsyncDelay: 6000\n\t\t\t}\n\t\t};\n\n\t\tif (this.isCMPEnabled) {\n\t\t\tthis.prebidConfig.consentManagement = {\n\t\t\t\tcmpApi: 'iab',\n\t\t\t\ttimeout: this.timeout,\n\t\t\t\tallowAuctionWithoutConsent: false\n\t\t\t};\n\t\t}\n\n\t\twindow.pbjs = window.pbjs || {};\n\t\twindow.pbjs.que = window.pbjs.que || [];\n\t\twindow.pbjs.que.push(() => {\n\t\t\twindow.pbjs.setConfig(this.prebidConfig);\n\t\t});\n\t}\n\n\tstatic validResponseStatusCode = 1;\n\tstatic errorResponseStatusCode = 2;\n\n\tcallBids(bidsBackHandler) {\n\t\tif (this.adUnits.length > 0) {\n\t\t\twindow.pbjs.que.push(() => {\n\t\t\t\twindow.pbjs.bidderSettings = getSettings();\n\t\t\t});\n\n\t\t\twindow.pbjs.que.push(() => {\n\t\t\t\tthis.removeAdUnits();\n\n\t\t\t\twindow.pbjs.requestBids({\n\t\t\t\t\tadUnits: this.adUnits,\n\t\t\t\t\tbidsBackHandler\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n\n\tremoveAdUnits() {\n\t\t(window.pbjs.adUnits || []).forEach((adUnit) => {\n\t\t\twindow.pbjs.removeAdUnit(adUnit.code);\n\t\t});\n\t}\n\n\tgetBestPrice(slotName) {\n\t\treturn getPrebidBestPrice(slotName);\n\t}\n\n\tgetTargetingParams(slotName) {\n\t\tlet slotParams = {};\n\n\t\tif (window.pbjs && typeof window.pbjs.getBidResponsesForAdUnitCode === 'function') {\n\t\t\tconst bids = window.pbjs.getBidResponsesForAdUnitCode(slotName).bids || [];\n\n\t\t\tif (bids.length) {\n\t\t\t\tlet bidParams = null;\n\t\t\t\tconst priorities = getPriorities();\n\n\t\t\t\tbids.forEach((param) => {\n\t\t\t\t\tif (!bidParams) {\n\t\t\t\t\t\tbidParams = param;\n\t\t\t\t\t} else if (bidParams.cpm === param.cpm) {\n\t\t\t\t\t\tif (priorities[bidParams.bidder] === priorities[param.bidder]) {\n\t\t\t\t\t\t\tbidParams = bidParams.timeToRespond > param.timeToRespond ? param : bidParams;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbidParams = priorities[bidParams.bidder] < priorities[param.bidder] ? param : bidParams;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tbidParams = bidParams.cpm < param.cpm ? param : bidParams;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tslotParams = bidParams.adserverTargeting;\n\t\t\t}\n\t\t}\n\n\t\treturn slotParams || {};\n\t}\n\n\tisSupported(slotName) {\n\t\treturn this.adUnits && this.adUnits.some(\n\t\t\tadUnit => adUnit.code === slotName\n\t\t);\n\t}\n}\n","// import A9 from './a9/index';\nimport { Prebid } from './prebid/index';\n\n\nrequire('./../../lib/prebid.min');\n\nconst bidIndex = {\n\ta9: {\n\t\tpos: 2,\n\t\tchar: '9'\n\t},\n\tprebid: {\n\t\tpos: 4,\n\t\tchar: 'P'\n\t}\n};\n\nlet bidderMarker = ['x', 'x', 'x', 'x', 'x'];\nconst biddersRegistry = {};\n\nfunction getBidParameters(slotName) {\n\tlet floorPrice = 0;\n\tconst slotParams = {};\n\n\tif (biddersRegistry.prebid && biddersRegistry.prebid.wasCalled()) {\n\t\tconst prebidPrices = biddersRegistry.prebid.getSlotBestPrice(slotName);\n\n\t\tfloorPrice = Math.max.apply(\n\t\t\tnull,\n\t\t\tObject\n\t\t\t\t.keys(prebidPrices)\n\t\t\t\t.filter(key => !isNaN(parseFloat(prebidPrices[key])) && parseFloat(prebidPrices[key]) > 0)\n\t\t\t\t.map(key => parseFloat(prebidPrices[key]))\n\t\t);\n\t}\n\n\tObject.keys(biddersRegistry).forEach((bidderName) => {\n\t\tconst bidder = biddersRegistry[bidderName];\n\n\t\tif (bidder && bidder.wasCalled()) {\n\t\t\tconst params = bidder.getSlotTargetingParams(slotName, floorPrice);\n\n\t\t\tObject\n\t\t\t\t.keys(params)\n\t\t\t\t.forEach((key) => {\n\t\t\t\t\tslotParams[key] = params[key];\n\t\t\t\t});\n\n\t\t\tif (bidder.hasResponse()) {\n\t\t\t\tbidderMarker = updateBidderMarker(bidder.getName(), bidderMarker);\n\t\t\t}\n\t\t}\n\t});\n\n\tslotParams.bid = bidderMarker.join('');\n\n\treturn slotParams;\n}\n\nfunction getCurrentSlotPrices(slotName) {\n\tconst slotPrices = {};\n\n\tObject.keys(biddersRegistry).forEach((bidder) => {\n\t\tbidder = biddersRegistry[bidder];\n\n\t\tif (bidder && bidder.isSlotSupported(slotName)) {\n\t\t\tconst priceFromBidder = bidder.getSlotBestPrice(slotName);\n\n\t\t\tObject.keys(priceFromBidder).forEach((bidderName) => {\n\t\t\t\tslotPrices[bidderName] = priceFromBidder[bidderName];\n\t\t\t});\n\t\t}\n\t});\n\n\treturn slotPrices;\n}\nfunction requestBids({ config, resetListener, timeout }) {\n\tif (config.prebid) {\n\t\tbiddersRegistry.prebid = new Prebid(config.prebid, resetListener, timeout);\n\t\tbiddersRegistry.prebid.call();\n\t}\n\n\t//if (bidders.a9) {\n\t//\tbiddersRegistry.a9 = new A9(bidders.a9, resetListener, timeout);\n\t//}\n}\n\nfunction updateBidderMarker(bidderName, bidMarker) {\n\tif (!bidIndex[bidderName]) {\n\t\treturn bidMarker;\n\t}\n\n\tconst bidder = bidIndex[bidderName];\n\tbidMarker[bidder.pos] = bidder.char;\n\n\treturn bidMarker;\n}\n\nexport const bidders = {\n\trequestBids,\n\tgetBidParameters\n};\n","import { decorate } from 'core-decorators';\nimport { logger, defer } from '../utils';\nimport { GptSizeMap } from './gpt-size-map';\nimport { setupGptTargeting } from './gpt-targeting';\nimport { slotListener } from '../listeners';\nimport { bidders } from './../bidders';\nimport { events, slotService, slotDataParamsUpdater, trackingOptIn } from '../services';\n\nconst logGroup = 'gpt-provider';\n\nexport const gptLazyMethod = method => function decoratedGptLazyMethod(...args) {\n\treturn window.googletag.cmd.push(() => method.apply(this, args));\n};\n\nlet definedSlots = [];\nlet initialized = false;\n\nfunction configure() {\n\tconst tag = window.googletag.pubads();\n\n\ttag.enableSingleRequest();\n\ttag.disableInitialLoad();\n\ttag.addEventListener('slotRenderEnded', (event) => {\n\t\tconst id = event.slot.getSlotElementId();\n\t\tconst slot = slotService.get(id);\n\n\t\t// IE doesn't allow us to inspect GPT iframe at this point.\n\t\t// Let's launch our callback in a setTimeout instead.\n\t\tdefer(() => slotListener.emitRenderEnded(event, slot));\n\t});\n\n\ttag.addEventListener('impressionViewable', (event) => {\n\t\tconst id = event.slot.getSlotElementId(),\n\t\t\tslot = slotService.get(id);\n\n\t\tslotListener.emitImpressionViewable(event, slot);\n\t});\n\twindow.googletag.enableServices();\n}\n\nexport class GptProvider {\n\tconstructor() {\n\t\twindow.googletag = window.googletag || {};\n\t\twindow.googletag.cmd = window.googletag.cmd || [];\n\n\t\tthis.init();\n\t}\n\n\t@decorate(gptLazyMethod)\n\tinit() {\n\t\tif (initialized) {\n\t\t\treturn;\n\t\t}\n\n\t\tsetupGptTargeting();\n\t\tconfigure();\n\t\tthis.setupNonPersonalizedAds();\n\t\tevents.on(events.PAGE_CHANGE_EVENT, (options = {}) => {\n\t\t\tif (!options.doNotDestroyGptSlots) {\n\t\t\t\tthis.destroySlots();\n\t\t\t}\n\t\t});\n\t\tevents.on(events.PAGE_RENDER_EVENT, () => this.updateCorrelator());\n\t\tinitialized = true;\n\t}\n\n\tsetupNonPersonalizedAds() {\n\t\tconst tag = window.googletag.pubads();\n\n\t\ttag.setRequestNonPersonalizedAds(trackingOptIn.isOptedIn() ? 0 : 1);\n\t}\n\n\t@decorate(gptLazyMethod)\n\tfillIn(adSlot) {\n\t\tconst targeting = this.parseTargetingParams(adSlot.getTargeting());\n\t\tconst sizeMap = new GptSizeMap(adSlot.getSizes());\n\n\t\tconst gptSlot = window.googletag.defineSlot(adSlot.getAdUnit(), adSlot.getDefaultSizes(), adSlot.getSlotName())\n\t\t\t.addService(window.googletag.pubads())\n\t\t\t.setCollapseEmptyDiv(true)\n\t\t\t.defineSizeMapping(sizeMap.build());\n\n\t\tthis.applyTargetingParams(gptSlot, targeting);\n\t\tslotDataParamsUpdater.updateOnCreate(adSlot, targeting);\n\n\t\tconst bidderTargeting = bidders.getBidParameters(adSlot.getSlotName());\n\t\tthis.applyTargetingParams(gptSlot, bidderTargeting);\n\n\t\twindow.googletag.display(adSlot.getSlotName());\n\t\tdefinedSlots.push(gptSlot);\n\n\t\tif (!adSlot.isAboveTheFold()) {\n\t\t\tthis.flush();\n\t\t}\n\n\t\tlogger(logGroup, adSlot.getSlotName(), 'slot added');\n\t}\n\n\tapplyTargetingParams(gptSlot, targeting) {\n\t\tObject.keys(targeting).forEach(key => gptSlot.setTargeting(key, targeting[key]));\n\t}\n\n\tparseTargetingParams(targeting) {\n\t\tconst result = {};\n\n\t\tObject.keys(targeting).forEach((key) => {\n\t\t\tlet value = targeting[key];\n\n\t\t\tif (typeof (value) === 'function') {\n\t\t\t\tvalue = value();\n\t\t\t}\n\t\t\tresult[key] = value;\n\t\t});\n\n\t\treturn result;\n\t}\n\n\t@decorate(gptLazyMethod)\n\tupdateCorrelator() {\n\t\twindow.googletag.pubads().updateCorrelator();\n\t}\n\n\t@decorate(gptLazyMethod)\n\tflush() {\n\t\tif (definedSlots.length) {\n\t\t\twindow.googletag.pubads().refresh(definedSlots);\n\t\t\tdefinedSlots = [];\n\t\t}\n\t}\n\n\t@decorate(gptLazyMethod)\n\tdestroyGptSlots(gptSlots) {\n\t\tlogger(logGroup, 'destroySlots', gptSlots);\n\n\t\tgptSlots.forEach((gptSlot) => {\n\t\t\tconst adSlot = slotService.get(gptSlot.getSlotElementId());\n\n\t\t\tslotService.remove(adSlot);\n\t\t});\n\n\t\tconst success = window.googletag.destroySlots(gptSlots);\n\n\t\tif (!success) {\n\t\t\tlogger(logGroup, 'destroySlots', gptSlots, 'failed');\n\t\t}\n\t}\n\n\tdestroySlots(slotNames) {\n\t\tconst allSlots = window.googletag.pubads().getSlots();\n\t\tconst slotsToDestroy = (slotNames && slotNames.length) ? allSlots.filter((slot) => {\n\t\t\tconst slotId = slot.getSlotElementId();\n\n\t\t\tif (!slotId) {\n\t\t\t\tlogger(logGroup, 'destroySlots', 'slot doesn\\'t return element id', slot);\n\t\t\t} else if (slotNames.indexOf(slotId) > -1) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}) : allSlots;\n\n\t\tif (slotsToDestroy.length) {\n\t\t\tthis.destroyGptSlots(slotsToDestroy);\n\t\t} else {\n\t\t\tlogger(logGroup, 'destroySlots', 'no slots returned to destroy', allSlots, slotNames);\n\t\t}\n\t}\n}\n","export * from './gpt-provider';\nexport * from './gpt-size-map';\nexport * from './gpt-targeting';\n","import { messageBus } from './message-bus';\nimport { slotService } from './slot-service';\nimport { logger } from '../utils';\n\nconst logGroup = 'slot-tweaker';\n\nclass SlotTweaker {\n\tforceRepaint(domElement) {\n\t\treturn domElement.offsetWidth;\n\t}\n\n\tgetContainer(adSlot) {\n\t\tconst container = document.getElementById(adSlot.getSlotName());\n\n\t\tif (!container) {\n\t\t\tlogger(logGroup, 'cannot find container', adSlot.getSlotName());\n\t\t}\n\n\t\treturn container;\n\t}\n\n\thide(adSlot) {\n\t\tconst container = this.getContainer(adSlot);\n\n\t\tif (container) {\n\t\t\tlogger(logGroup, 'hide', adSlot.getSlotName());\n\t\t\tcontainer.classList.add('hide');\n\t\t}\n\t}\n\n\tshow(adSlot) {\n\t\tconst container = this.getContainer(adSlot);\n\n\t\tif (container) {\n\t\t\tlogger(logGroup, 'show', adSlot.getSlotName());\n\t\t\tcontainer.classList.remove('hide');\n\t\t}\n\t}\n\n\tcollapse(adSlot) {\n\t\tconst container = this.getContainer(adSlot);\n\n\t\tcontainer.style.maxHeight = `${container.scrollHeight}px`;\n\t\tthis.forceRepaint(container);\n\t\tcontainer.classList.add('slot-animation');\n\t\tcontainer.style.maxHeight = '0';\n\t}\n\n\texpand(adSlot) {\n\t\tconst container = this.getContainer(adSlot);\n\n\t\tcontainer.style.maxHeight = `${container.offsetHeight}px`;\n\t\tcontainer.classList.remove('hide');\n\t\tcontainer.classList.add('slot-animation');\n\t\tcontainer.style.maxHeight = `${container.scrollHeight}px`;\n\t}\n\n\tmakeResponsive(adSlot, aspectRatio = null) {\n\t\tconst slotContainer = this.getContainer(adSlot);\n\n\t\tslotContainer.classList.add('slot-responsive');\n\n\t\treturn this.onReady(adSlot)\n\t\t\t.then((iframe) => {\n\t\t\t\tconst container = iframe.parentElement;\n\t\t\t\tif (!aspectRatio) {\n\t\t\t\t\tconst height = iframe.contentWindow.document.body.scrollHeight,\n\t\t\t\t\t\twidth = iframe.contentWindow.document.body.scrollWidth;\n\n\t\t\t\t\taspectRatio = width / height;\n\t\t\t\t}\n\n\t\t\t\tlogger(logGroup, 'make responsive', adSlot.getSlotName());\n\t\t\t\tcontainer.style.paddingBottom = `${100 / aspectRatio}%`;\n\t\t\t\treturn iframe;\n\t\t\t});\n\t}\n\n\tonReady(adSlot) {\n\t\tconst container = this.getContainer(adSlot),\n\t\t\tiframe = container.querySelector('div[id*=\"_container_\"] iframe');\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tif (!iframe) {\n\t\t\t\treject(new Error('Cannot find iframe element'));\n\t\t\t}\n\n\t\t\tif (iframe.contentWindow.document.readyState === 'complete') {\n\t\t\t\tresolve(iframe);\n\t\t\t} else {\n\t\t\t\tiframe.addEventListener('load', () => resolve(iframe));\n\t\t\t}\n\t\t});\n\t}\n\n\tregisterMessageListener() {\n\t\tmessageBus.register({\n\t\t\tkeys: ['action', 'slotName'],\n\t\t\tinfinite: true\n\t\t}, (data) => {\n\t\t\tif (!data.slotName) {\n\t\t\t\tlogger(logGroup, 'Missing slot name');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst adSlot = slotService.get(data.slotName);\n\n\t\t\tswitch (data.action) {\n\t\t\t\tcase 'expand':\n\t\t\t\t\tthis.expand(adSlot);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'collapse':\n\t\t\t\t\tthis.collapse(adSlot);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'hide':\n\t\t\t\t\tthis.hide(adSlot);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'show':\n\t\t\t\t\tthis.show(adSlot);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'make-responsive':\n\t\t\t\t\tthis.makeResponsive(adSlot, data.aspectRatio);\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tlogger(logGroup, 'Unknown action', data.action);\n\t\t\t}\n\t\t});\n\t}\n\n\tsetDataParam(adSlot, attrName, data) {\n\t\tconst container = this.getContainer(adSlot);\n\n\t\tcontainer.dataset[attrName] = typeof data === 'string' ?\n\t\t\tdata :\n\t\t\tJSON.stringify(data);\n\t}\n}\n\nexport const slotTweaker = new SlotTweaker();\n","import { GptSizeMap } from '../providers';\nimport { slotTweaker } from './slot-tweaker';\nimport { context } from './context-service';\n\nclass SlotDataParamsUpdater {\n\tupdateOnCreate(adSlot, targeting) {\n\t\tslotTweaker.setDataParam(adSlot, 'gptPageParams', context.get('targeting'));\n\t\tslotTweaker.setDataParam(adSlot, 'gptSlotParams', targeting);\n\t\tslotTweaker.setDataParam(adSlot, 'sizes', new GptSizeMap(adSlot.getSizes()).toString());\n\t}\n\n\tupdateOnRenderEnd(adSlot, event) {\n\t\tif (event) {\n\t\t\tslotTweaker.setDataParam(adSlot, 'gptLineItemId', event.lineItemId);\n\t\t\tslotTweaker.setDataParam(adSlot, 'gptCreativeId', event.creativeId);\n\t\t\tslotTweaker.setDataParam(adSlot, 'gptCreativeSize', event.size);\n\t\t}\n\t}\n}\n\nexport const slotDataParamsUpdater = new SlotDataParamsUpdater();\n","import { context } from './context-service';\nimport { logger } from '../utils';\nimport { getTopOffset, getViewportHeight } from '../utils/dimensions';\nimport { slotService } from './slot-service';\nimport { stringBuilder } from '../utils/string-builder';\n\nconst logGroup = 'slot-repeater';\n\nfunction findNextSiblingForSlot(previousSlotElement, elements, config) {\n\tconst minimalPosition = getTopOffset(previousSlotElement) + previousSlotElement.offsetHeight + getViewportHeight();\n\n\tconfig.previousSiblingIndex = config.previousSiblingIndex || 0;\n\tfor (; config.previousSiblingIndex < elements.length; config.previousSiblingIndex += 1) {\n\t\tconst elementPosition = getTopOffset(elements[config.previousSiblingIndex]);\n\n\t\tif (minimalPosition <= elementPosition) {\n\t\t\treturn elements[config.previousSiblingIndex];\n\t\t}\n\t}\n\n\treturn null;\n}\n\nfunction insertNewSlotContainer(previousSlotElement, slotName, config, nextSibling) {\n\tconst container = document.createElement('div');\n\tconst additionalClasses = config.additionalClasses || '';\n\n\tcontainer.id = slotName;\n\tcontainer.className = `${previousSlotElement.className} ${additionalClasses}`;\n\n\tnextSibling.parentNode.insertBefore(container, nextSibling);\n}\n\nfunction insertFakePlaceholderAfterLastSelector(slotName, elements) {\n\tconst lastElement = elements[elements.length - 1];\n\tconst placeholder = document.createElement('div');\n\n\tplaceholder.id = slotName;\n\tplaceholder.className = 'hide';\n\n\tlastElement.parentNode.insertBefore(placeholder, lastElement.nextSibling);\n}\n\nfunction buildString(pattern, definition) {\n\treturn stringBuilder.build(pattern, {\n\t\tslotConfig: definition\n\t});\n}\n\nfunction repeatSlot(adSlot) {\n\tconst newSlotDefinition = adSlot.getCopy();\n\tconst repeatConfig = newSlotDefinition.repeat;\n\n\trepeatConfig.index += 1;\n\n\tconst slotName = buildString(repeatConfig.slotNamePattern, newSlotDefinition);\n\tnewSlotDefinition.slotName = slotName;\n\n\tif (repeatConfig.limit !== null && repeatConfig.index > repeatConfig.limit) {\n\t\tlogger(logGroup, `Limit reached for ${slotName}`);\n\n\t\treturn false;\n\t}\n\n\tcontext.set(`slots.${slotName}`, newSlotDefinition);\n\tif (repeatConfig.updateProperties) {\n\t\tObject.keys(repeatConfig.updateProperties).forEach((key) => {\n\t\t\tconst value = buildString(repeatConfig.updateProperties[key], newSlotDefinition);\n\n\t\t\tcontext.set(`slots.${slotName}.${key}`, value);\n\t\t});\n\t}\n\n\tconst elements = document.querySelectorAll(repeatConfig.insertBeforeSelector);\n\tconst nextSibling = findNextSiblingForSlot(adSlot.getElement(), elements, repeatConfig);\n\n\tif (nextSibling) {\n\t\tinsertNewSlotContainer(adSlot.getElement(), slotName, repeatConfig, nextSibling);\n\t\tcontext.push('events.pushOnScroll.ids', slotName);\n\n\t\tlogger(logGroup, 'Repeat slot', slotName);\n\n\t\treturn true;\n\t}\n\n\tinsertFakePlaceholderAfterLastSelector(slotName, elements, repeatConfig);\n\tslotService.disable(slotName, 'viewport-conflict');\n\tcontext.push('events.pushOnScroll.ids', slotName);\n\n\tlogger(logGroup, `There is not enough space for ${slotName}`);\n\n\treturn false;\n}\n\nclass SlotRepeater {\n\tinit() {\n\t\tif (context.get('options.slotRepeater')) {\n\t\t\tcontext.push('listeners.slot', {\n\t\t\t\tonRenderEnded: (adSlot) => {\n\t\t\t\t\tif (adSlot.isEnabled() && adSlot.isRepeatable()) {\n\t\t\t\t\t\treturn repeatSlot(adSlot);\n\t\t\t\t\t}\n\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n}\n\nexport const slotRepeater = new SlotRepeater();\n","import { context } from './context-service';\nimport { queryString } from '../utils/query-string';\n\nconst isOptInByQueryParam = queryString.get('tracking-opt-in-status') === 'true';\n\nfunction isOptedIn() {\n\treturn isOptInByQueryParam || context.get('options.trackingOptIn');\n}\n\nexport const trackingOptIn = {\n\tisOptedIn\n};\n","export * from './btf-blocker-service';\nexport * from './context-service';\nexport * from './custom-ad-loader';\nexport * from './events';\nexport * from './local-cache';\nexport * from './message-bus';\nexport * from './slot-data-params-updater';\nexport * from './slot-repeater';\nexport * from './slot-service';\nexport * from './slot-tweaker';\nexport * from './template-service';\nexport * from './tracking-opt-in';\n","import { context } from '../services';\n\nclass StringBuilder {\n\tbuild(string, parameters = {}) {\n\t\tconst matches = string.match(/{(.+?)}/g);\n\n\t\tif (matches) {\n\t\t\tmatches.forEach((match) => {\n\t\t\t\tconst key = match.replace('{', '').replace('}', ''),\n\t\t\t\t\tfallbackValue = context.get(key),\n\t\t\t\t\tkeySegments = key.split('.');\n\n\t\t\t\tlet index,\n\t\t\t\t\tsegment,\n\t\t\t\t\tvalue = parameters[keySegments[0]];\n\n\t\t\t\tif (value) {\n\t\t\t\t\tfor (index = 1; index < keySegments.length; index += 1) {\n\t\t\t\t\t\tsegment = keySegments[index];\n\t\t\t\t\t\tif (typeof value[segment] === 'undefined') {\n\t\t\t\t\t\t\tvalue = undefined;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvalue = value[segment];\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tif (typeof value === 'undefined') {\n\t\t\t\t\tvalue = fallbackValue;\n\t\t\t\t}\n\t\t\t\tif (typeof value !== 'undefined') {\n\t\t\t\t\tstring = string.replace(match, value);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\treturn string;\n\t}\n}\n\nexport const stringBuilder = new StringBuilder();\n","export function whichProperty(obj, properties = []) {\n\tfor (let i = 0; i < properties.length; i += 1) {\n\t\tconst property = properties[i];\n\n\t\tif (typeof property !== 'string') {\n\t\t\tthrow new Error('property name must be a string');\n\t\t}\n\n\t\tif (property in obj) {\n\t\t\treturn property;\n\t\t}\n\t}\n\n\treturn null;\n}\n\nexport function tryProperty(obj, properties = []) {\n\tconst property = whichProperty(obj, properties);\n\n\tif (property !== null) {\n\t\tconst propertyValue = obj[property];\n\t\treturn (typeof propertyValue === 'function') ? propertyValue.bind(obj) : propertyValue;\n\t}\n\n\treturn null;\n}\n","import { scrollListener } from '../listeners';\nimport { isInViewport } from './dimensions';\n\nfunction updateInViewport(listener) {\n\tconst newInViewport = isInViewport(listener.element);\n\n\tif (newInViewport !== listener.inViewport) {\n\t\tlistener.callback(newInViewport);\n\t\tlistener.inViewport = newInViewport;\n\t}\n}\n\nfunction addListener(element, callback, params = {}) {\n\tconst listener = {\n\t\t\telement,\n\t\t\tcallback,\n\t\t\toffsetTop: params.offsetTop || 0,\n\t\t\toffsetBottom: params.offsetBottom || 0,\n\t\t\tinViewport: false\n\t\t},\n\t\tupdateCallback = () => {\n\t\t\tupdateInViewport(listener);\n\t\t};\n\n\tlistener.id = scrollListener.addCallback(updateCallback);\n\tupdateCallback();\n\n\treturn listener.id;\n}\n\nfunction removeListener(listenerId) {\n\tscrollListener.removeCallback(listenerId);\n}\n\nexport const viewportObserver = {\n\taddListener,\n\tremoveListener\n};\n","export * from './client';\nexport * from './dimensions';\nexport * from './flow-control';\nexport * from './lazy-queue';\nexport * from './logger';\nexport * from './query-string';\nexport * from './sampler';\nexport * from './script-loader';\nexport * from './string-builder';\nexport * from './try-property';\nexport * from './viewport-observer';\n","import { getTopOffset } from '../utils';\nimport { scrollListener } from '../listeners';\n\nexport class FloatingAd {\n\tstatic getName() {\n\t\treturn 'floating-ad';\n\t}\n\n\tconstructor(adSlot) {\n\t\tthis.adSlot = adSlot;\n\t}\n\n\tinit() {\n\t\tconst slotNode = document.getElementById(this.adSlot.getSlotName());\n\n\t\tlet container,\n\t\t\tcontainerOffset,\n\t\t\tend,\n\t\t\tslotHeight,\n\t\t\tspace,\n\t\t\tstart = 0;\n\n\t\tif (!slotNode || !slotNode.classList.contains('floating')) {\n\t\t\treturn;\n\t\t}\n\n\t\tscrollListener.addCallback(() => {\n\t\t\tconst scrollPosition = window.scrollY || window.pageYOffset || document.documentElement.scrollTop;\n\n\t\t\tcontainer = slotNode.parentNode;\n\t\t\tcontainerOffset = getTopOffset(container);\n\t\t\tslotHeight = slotNode.offsetHeight;\n\t\t\tend = containerOffset + container.offsetHeight - slotHeight;\n\n\t\t\tstart = containerOffset;\n\t\t\tif (slotNode.previousElementSibling) {\n\t\t\t\tstart = getTopOffset(slotNode.previousElementSibling) + slotNode.previousElementSibling.offsetHeight;\n\t\t\t}\n\n\t\t\tspace = end - start;\n\t\t\tif (space <= slotHeight) {\n\t\t\t\tslotNode.classList.add('pinned-top');\n\t\t\t\tslotNode.classList.remove('pinned-bottom');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (scrollPosition <= start) {\n\t\t\t\tslotNode.classList.add('pinned-top');\n\t\t\t\tslotNode.classList.remove('pinned-bottom');\n\t\t\t} else if (scrollPosition >= end) {\n\t\t\t\tslotNode.classList.add('pinned-bottom');\n\t\t\t\tslotNode.classList.remove('pinned-top');\n\t\t\t} else {\n\t\t\t\tslotNode.classList.remove('pinned-top');\n\t\t\t\tslotNode.classList.remove('pinned-bottom');\n\t\t\t}\n\t\t});\n\t}\n}\n","import { logger, makeLazyQueue } from './utils';\nimport { AdSlot } from './models';\nimport { FloatingAd } from './templates';\nimport { GptProvider } from './providers';\nimport { scrollListener } from './listeners';\nimport {\n\tbtfBlockerService,\n\tslotRepeater,\n\tslotTweaker,\n\tslotService,\n\ttemplateService,\n\tregisterCustomAdLoader,\n\tcontext,\n\tmessageBus\n} from './services';\n\nconst logGroup = 'ad-engine';\n\nfunction fillInUsingProvider(ad, provider) {\n\tconst adSlot = new AdSlot(ad);\n\n\tslotService.add(adSlot);\n\tbtfBlockerService.push(adSlot, provider.fillIn.bind(provider));\n}\n\nfunction getPromises() {\n\treturn (context.get('delayModules') || [])\n\t\t.filter(module => module.isEnabled())\n\t\t.map((module) => {\n\t\t\tlogger(logGroup, 'Register delay module', module.getName());\n\n\t\t\treturn module.getPromise();\n\t\t}) || [];\n}\n\nexport class AdEngine {\n\tconstructor(config = null) {\n\t\tcontext.extend(config);\n\t\tthis.adStack = context.get('state.adStack');\n\t\tthis.providers = new Map();\n\n\t\twindow.ads = window.ads || {};\n\t\twindow.ads.runtime = window.ads.runtime || {};\n\n\t\ttemplateService.register(FloatingAd);\n\t}\n\n\tsetupProviders() {\n\t\tthis.providers.set('gpt', new GptProvider());\n\n\t\tmakeLazyQueue(this.adStack, (ad) => {\n\t\t\tconst gpt = this.providers.get('gpt');\n\n\t\t\tfillInUsingProvider(ad, gpt);\n\n\t\t\tif (this.adStack.length === 0) {\n\t\t\t\tgpt.flush();\n\t\t\t}\n\t\t});\n\t}\n\n\trunAdQueue() {\n\t\tlet started = false,\n\t\t\ttimeout = null;\n\n\t\tconst promises = getPromises(),\n\t\t\tstartAdQueue = () => {\n\t\t\t\tif (!started) {\n\t\t\t\t\tstarted = true;\n\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\tthis.adStack.start();\n\t\t\t\t}\n\t\t\t},\n\t\t\tmaxTimeout = context.get('options.maxDelayTimeout');\n\n\t\tlogger(logGroup, `Delay by ${promises.length} modules (${maxTimeout}ms timeout)`);\n\n\t\tif (promises.length > 0) {\n\t\t\tPromise.all(promises).then(() => {\n\t\t\t\tlogger(logGroup, 'startAdQueue', 'All modules ready');\n\t\t\t\tstartAdQueue();\n\t\t\t});\n\t\t\ttimeout = setTimeout(() => {\n\t\t\t\tlogger(logGroup, 'startAdQueue', 'Timeout reached');\n\t\t\t\tstartAdQueue();\n\t\t\t}, maxTimeout);\n\t\t} else {\n\t\t\tstartAdQueue();\n\t\t}\n\t}\n\n\tgetProvider(name) {\n\t\treturn this.providers.get(name);\n\t}\n\n\tinit() {alert('asssaa');\n\t\tthis.setupProviders();\n\t\tbtfBlockerService.init();\n\n\t\tregisterCustomAdLoader(context.get('options.customAdLoader.globalMethodName'));\n\t\tmessageBus.init();\n\t\tslotTweaker.registerMessageListener();\n\t\tthis.runAdQueue();\n\n\t\tscrollListener.init();\n\t\tslotRepeater.init();\n\n\t\tif (context.get('events.pushOnScroll')) {\n\t\t\tconst pushOnScrollQueue = context.get('events.pushOnScroll.ids');\n\n\t\t\tmakeLazyQueue(pushOnScrollQueue, (id) => {\n\t\t\t\tscrollListener.addSlot(this.adStack, id, context.get('events.pushOnScroll.threshold'));\n\t\t\t});\n\t\t\tpushOnScrollQueue.start();\n\t\t}\n\t}\n}\n","import { get, set } from 'lodash';\nimport * as utils from './utils';\n\nconst versionField = 'ads.adEngineVersion';\n\nif (get(window, versionField, null)) {\n\twindow.console.warn('Multiple @wikia/ad-engine initializations. This may cause issues.');\n}\n\nset(window, versionField, 'v12.0.2');\nutils.logger('ad-engine', 'v12.0.2');\n\nexport * from './ad-engine';\nexport * from './bidders';\nexport * from './listeners';\nexport * from './models';\nexport * from './providers';\nexport * from './services';\nexport * from './video';\nexport { utils };\n","/******/ (function(modules) { // webpackBootstrap\n/******/ \t// install a JSONP callback for chunk loading\n/******/ \tvar parentJsonpFunction = window[\"pbjsChunk\"];\n/******/ \twindow[\"pbjsChunk\"] = function webpackJsonpCallback(chunkIds, moreModules, executeModules) {\n/******/ \t\t// add \"moreModules\" to the modules object,\n/******/ \t\t// then flag all \"chunkIds\" as loaded and fire callback\n/******/ \t\tvar moduleId, chunkId, i = 0, resolves = [], result;\n/******/ \t\tfor(;i < chunkIds.length; i++) {\n/******/ \t\t\tchunkId = chunkIds[i];\n/******/ \t\t\tif(installedChunks[chunkId]) {\n/******/ \t\t\t\tresolves.push(installedChunks[chunkId][0]);\n/******/ \t\t\t}\n/******/ \t\t\tinstalledChunks[chunkId] = 0;\n/******/ \t\t}\n/******/ \t\tfor(moduleId in moreModules) {\n/******/ \t\t\tif(Object.prototype.hasOwnProperty.call(moreModules, moduleId)) {\n/******/ \t\t\t\tmodules[moduleId] = moreModules[moduleId];\n/******/ \t\t\t}\n/******/ \t\t}\n/******/ \t\tif(parentJsonpFunction) parentJsonpFunction(chunkIds, moreModules, executeModules);\n/******/ \t\twhile(resolves.length) {\n/******/ \t\t\tresolves.shift()();\n/******/ \t\t}\n/******/ \t\tif(executeModules) {\n/******/ \t\t\tfor(i=0; i < executeModules.length; i++) {\n/******/ \t\t\t\tresult = __webpack_require__(__webpack_require__.s = executeModules[i]);\n/******/ \t\t\t}\n/******/ \t\t}\n/******/ \t\treturn result;\n/******/ \t};\n/******/\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// objects to store loaded and loading chunks\n/******/ \tvar installedChunks = {\n/******/ \t\t136: 0\n/******/ \t};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// on error function for async loading\n/******/ \t__webpack_require__.oe = function(err) { console.error(err); throw err; };\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 463);\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ 0:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.getAdUnitSizes = getAdUnitSizes;\nexports.parseSizesInput = parseSizesInput;\nexports.parseGPTSingleSizeArray = parseGPTSingleSizeArray;\nexports.uniques = uniques;\nexports.flatten = flatten;\nexports.getBidRequest = getBidRequest;\nexports.getKeys = getKeys;\nexports.getValue = getValue;\nexports.getBidderCodes = getBidderCodes;\nexports.isGptPubadsDefined = isGptPubadsDefined;\nexports.getHighestCpm = getHighestCpm;\nexports.shuffle = shuffle;\nexports.adUnitsFilter = adUnitsFilter;\nexports.isSrcdocSupported = isSrcdocSupported;\nexports.deepClone = deepClone;\nexports.inIframe = inIframe;\nexports.isSafariBrowser = isSafariBrowser;\nexports.replaceAuctionPrice = replaceAuctionPrice;\nexports.timestamp = timestamp;\nexports.checkCookieSupport = checkCookieSupport;\nexports.cookiesAreEnabled = cookiesAreEnabled;\nexports.delayExecution = delayExecution;\nexports.groupBy = groupBy;\nexports.deepAccess = deepAccess;\nexports.createContentToExecuteExtScriptInFriendlyFrame = createContentToExecuteExtScriptInFriendlyFrame;\nexports.getDefinedParams = getDefinedParams;\nexports.isValidMediaTypes = isValidMediaTypes;\nexports.getBidderRequest = getBidderRequest;\nexports.getUserConfiguredParams = getUserConfiguredParams;\nexports.getOrigin = getOrigin;\nexports.getDNT = getDNT;\nexports.isAdUnitCodeMatchingSlot = isAdUnitCodeMatchingSlot;\nexports.isSlotMatchingAdUnitCode = isSlotMatchingAdUnitCode;\nexports.unsupportedBidderMessage = unsupportedBidderMessage;\nexports.deletePropertyFromObject = deletePropertyFromObject;\nexports.removeRequestId = removeRequestId;\nexports.isInteger = isInteger;\nexports.convertCamelToUnderscore = convertCamelToUnderscore;\n\nvar _config = __webpack_require__(4);\n\nvar _justClone = __webpack_require__(62);\n\nvar _justClone2 = _interopRequireDefault(_justClone);\n\nvar _find = __webpack_require__(10);\n\nvar _find2 = _interopRequireDefault(_find);\n\nvar _includes = __webpack_require__(7);\n\nvar _includes2 = _interopRequireDefault(_includes);\n\nvar _url = __webpack_require__(12);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar CONSTANTS = __webpack_require__(2);\n\nvar _loggingChecked = false;\n\nvar t_Arr = 'Array';\nvar t_Str = 'String';\nvar t_Fn = 'Function';\nvar t_Numb = 'Number';\nvar t_Object = 'Object';\nvar toString = Object.prototype.toString;\nvar infoLogger = null;\ntry {\n  infoLogger = console.info.bind(window.console);\n} catch (e) {}\n\n/*\n *   Substitutes into a string from a given map using the token\n *   Usage\n *   var str = 'text %%REPLACE%% this text with %%SOMETHING%%';\n *   var map = {};\n *   map['replace'] = 'it was subbed';\n *   map['something'] = 'something else';\n *   console.log(replaceTokenInString(str, map, '%%')); => \"text it was subbed this text with something else\"\n */\nexports.replaceTokenInString = function (str, map, token) {\n  this._each(map, function (value, key) {\n    value = value === undefined ? '' : value;\n\n    var keyString = token + key.toUpperCase() + token;\n    var re = new RegExp(keyString, 'g');\n\n    str = str.replace(re, value);\n  });\n\n  return str;\n};\n\n/* utility method to get incremental integer starting from 1 */\nvar getIncrementalInteger = function () {\n  var count = 0;\n  return function () {\n    count++;\n    return count;\n  };\n}();\n\nfunction _getUniqueIdentifierStr() {\n  return getIncrementalInteger() + Math.random().toString(16).substr(2);\n}\n\n// generate a random string (to be used as a dynamic JSONP callback)\nexports.getUniqueIdentifierStr = _getUniqueIdentifierStr;\n\n/**\n * Returns a random v4 UUID of the form xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx,\n * where each x is replaced with a random hexadecimal digit from 0 to f,\n * and y is replaced with a random hexadecimal digit from 8 to b.\n * https://gist.github.com/jed/982883 via node-uuid\n */\nexports.generateUUID = function generateUUID(placeholder) {\n  return placeholder ? (placeholder ^ Math.random() * 16 >> placeholder / 4).toString(16) : ([1e7] + -1e3 + -4e3 + -8e3 + -1e11).replace(/[018]/g, generateUUID);\n};\n\nexports.getBidIdParameter = function (key, paramsObj) {\n  if (paramsObj && paramsObj[key]) {\n    return paramsObj[key];\n  }\n\n  return '';\n};\n\nexports.tryAppendQueryString = function (existingUrl, key, value) {\n  if (value) {\n    return existingUrl += key + '=' + encodeURIComponent(value) + '&';\n  }\n\n  return existingUrl;\n};\n\n// parse a query string object passed in bid params\n// bid params should be an object such as {key: \"value\", key1 : \"value1\"}\nexports.parseQueryStringParameters = function (queryObj) {\n  var result = '';\n  for (var k in queryObj) {\n    if (queryObj.hasOwnProperty(k)) {\n      result += k + '=' + encodeURIComponent(queryObj[k]) + '&';\n    }\n  }\n\n  return result;\n};\n\n// transform an AdServer targeting bids into a query string to send to the adserver\nexports.transformAdServerTargetingObj = function (targeting) {\n  // we expect to receive targeting for a single slot at a time\n  if (targeting && Object.getOwnPropertyNames(targeting).length > 0) {\n    return getKeys(targeting).map(function (key) {\n      return key + '=' + encodeURIComponent(getValue(targeting, key));\n    }).join('&');\n  } else {\n    return '';\n  }\n};\n\n/**\n * Read an adUnit object and return the sizes used in an [[728, 90]] format (even if they had [728, 90] defined)\n * Preference is given to the `adUnit.mediaTypes.banner.sizes` object over the `adUnit.sizes`\n * @param {object} adUnit one adUnit object from the normal list of adUnits\n * @returns {array[array[number]]} array of arrays containing numeric sizes\n */\nfunction getAdUnitSizes(adUnit) {\n  if (!adUnit) {\n    return;\n  }\n\n  var sizes = [];\n  if (adUnit.mediaTypes && adUnit.mediaTypes.banner && Array.isArray(adUnit.mediaTypes.banner.sizes)) {\n    var bannerSizes = adUnit.mediaTypes.banner.sizes;\n    if (Array.isArray(bannerSizes[0])) {\n      sizes = bannerSizes;\n    } else {\n      sizes.push(bannerSizes);\n    }\n  } else if (Array.isArray(adUnit.sizes)) {\n    if (Array.isArray(adUnit.sizes[0])) {\n      sizes = adUnit.sizes;\n    } else {\n      sizes.push(adUnit.sizes);\n    }\n  }\n  return sizes;\n}\n\n/**\n * Parse a GPT-Style general size Array like `[[300, 250]]` or `\"300x250,970x90\"` into an array of sizes `[\"300x250\"]` or '['300x250', '970x90']'\n * @param  {array[array|number]} sizeObj Input array or double array [300,250] or [[300,250], [728,90]]\n * @return {array[string]}  Array of strings like `[\"300x250\"]` or `[\"300x250\", \"728x90\"]`\n */\nfunction parseSizesInput(sizeObj) {\n  var parsedSizes = [];\n\n  // if a string for now we can assume it is a single size, like \"300x250\"\n  if (typeof sizeObj === 'string') {\n    // multiple sizes will be comma-separated\n    var sizes = sizeObj.split(',');\n\n    // regular expression to match strigns like 300x250\n    // start of line, at least 1 number, an \"x\" , then at least 1 number, and the then end of the line\n    var sizeRegex = /^(\\d)+x(\\d)+$/i;\n    if (sizes) {\n      for (var curSizePos in sizes) {\n        if (hasOwn(sizes, curSizePos) && sizes[curSizePos].match(sizeRegex)) {\n          parsedSizes.push(sizes[curSizePos]);\n        }\n      }\n    }\n  } else if ((typeof sizeObj === 'undefined' ? 'undefined' : _typeof(sizeObj)) === 'object') {\n    var sizeArrayLength = sizeObj.length;\n\n    // don't process empty array\n    if (sizeArrayLength > 0) {\n      // if we are a 2 item array of 2 numbers, we must be a SingleSize array\n      if (sizeArrayLength === 2 && typeof sizeObj[0] === 'number' && typeof sizeObj[1] === 'number') {\n        parsedSizes.push(parseGPTSingleSizeArray(sizeObj));\n      } else {\n        // otherwise, we must be a MultiSize array\n        for (var i = 0; i < sizeArrayLength; i++) {\n          parsedSizes.push(parseGPTSingleSizeArray(sizeObj[i]));\n        }\n      }\n    }\n  }\n\n  return parsedSizes;\n};\n\n// parse a GPT style sigle size array, (i.e [300,250])\n// into an AppNexus style string, (i.e. 300x250)\nfunction parseGPTSingleSizeArray(singleSize) {\n  // if we aren't exactly 2 items in this array, it is invalid\n  if (exports.isArray(singleSize) && singleSize.length === 2 && !isNaN(singleSize[0]) && !isNaN(singleSize[1])) {\n    return singleSize[0] + 'x' + singleSize[1];\n  }\n};\n\nexports.getTopWindowLocation = function () {\n  if (exports.inIframe()) {\n    var loc = void 0;\n    try {\n      loc = exports.getAncestorOrigins() || exports.getTopFrameReferrer();\n    } catch (e) {\n      logInfo('could not obtain top window location', e);\n    }\n    if (loc) return (0, _url.parse)(loc, { 'decodeSearchAsString': true });\n  }\n  return exports.getWindowLocation();\n};\n\nexports.getTopFrameReferrer = function () {\n  try {\n    // force an exception in x-domain environments. #1509\n    window.top.location.toString();\n    var referrerLoc = '';\n    var currentWindow = void 0;\n    do {\n      currentWindow = currentWindow ? currentWindow.parent : window;\n      if (currentWindow.document && currentWindow.document.referrer) {\n        referrerLoc = currentWindow.document.referrer;\n      }\n    } while (currentWindow !== window.top);\n    return referrerLoc;\n  } catch (e) {\n    return window.document.referrer;\n  }\n};\n\nexports.getAncestorOrigins = function () {\n  if (window.document.location && window.document.location.ancestorOrigins && window.document.location.ancestorOrigins.length >= 1) {\n    return window.document.location.ancestorOrigins[window.document.location.ancestorOrigins.length - 1];\n  }\n};\n\nexports.getWindowTop = function () {\n  return window.top;\n};\n\nexports.getWindowSelf = function () {\n  return window.self;\n};\n\nexports.getWindowLocation = function () {\n  return window.location;\n};\n\nexports.getTopWindowUrl = function () {\n  var href = void 0;\n  try {\n    href = this.getTopWindowLocation().href;\n  } catch (e) {\n    href = '';\n  }\n\n  return href;\n};\n\nexports.getTopWindowReferrer = function () {\n  try {\n    return window.top.document.referrer;\n  } catch (e) {\n    return document.referrer;\n  }\n};\n\nexports.logWarn = function (msg) {\n  if (debugTurnedOn() && console.warn) {\n    console.warn('WARNING: ' + msg);\n  }\n};\n\nexports.logInfo = function (msg, args) {\n  if (debugTurnedOn() && hasConsoleLogger()) {\n    if (infoLogger) {\n      if (!args || args.length === 0) {\n        args = '';\n      }\n\n      infoLogger('INFO: ' + msg + (args === '' ? '' : ' : params : '), args);\n    }\n  }\n};\n\nexports.logMessage = function (msg) {\n  if (debugTurnedOn() && hasConsoleLogger()) {\n    console.log('MESSAGE: ' + msg);\n  }\n};\n\nfunction hasConsoleLogger() {\n  return window.console && window.console.log;\n}\n\nfunction hasConsoleError() {\n  return window.console && window.console.error;\n}\n\nexports.hasConsoleLogger = hasConsoleLogger;\n\nvar debugTurnedOn = function debugTurnedOn() {\n  if (_config.config.getConfig('debug') === false && _loggingChecked === false) {\n    var debug = getParameterByName(CONSTANTS.DEBUG_MODE).toUpperCase() === 'TRUE';\n    _config.config.setConfig({ debug: debug });\n    _loggingChecked = true;\n  }\n\n  return !!_config.config.getConfig('debug');\n};\n\nexports.debugTurnedOn = debugTurnedOn;\n\n/**\n * Wrapper to console.error. Takes N arguments to log the same as console.error.\n */\nexports.logError = function () {\n  if (debugTurnedOn() && hasConsoleError()) {\n    console.error.apply(console, arguments);\n  }\n};\n\nexports.createInvisibleIframe = function _createInvisibleIframe() {\n  var f = document.createElement('iframe');\n  f.id = _getUniqueIdentifierStr();\n  f.height = 0;\n  f.width = 0;\n  f.border = '0px';\n  f.hspace = '0';\n  f.vspace = '0';\n  f.marginWidth = '0';\n  f.marginHeight = '0';\n  f.style.border = '0';\n  f.scrolling = 'no';\n  f.frameBorder = '0';\n  f.src = 'about:blank';\n  f.style.display = 'none';\n  return f;\n};\n\n/*\n *   Check if a given parameter name exists in query string\n *   and if it does return the value\n */\nvar getParameterByName = function getParameterByName(name) {\n  var regexS = '[\\\\?&]' + name + '=([^&#]*)';\n  var regex = new RegExp(regexS);\n  var results = regex.exec(window.location.search);\n  if (results === null) {\n    return '';\n  }\n\n  return decodeURIComponent(results[1].replace(/\\+/g, ' '));\n};\n\nexports.getParameterByName = getParameterByName;\n\n/**\n * This function validates paramaters.\n * @param  {object[string]} paramObj          [description]\n * @param  {string[]} requiredParamsArr [description]\n * @return {bool}                   Bool if paramaters are valid\n */\nexports.hasValidBidRequest = function (paramObj, requiredParamsArr, adapter) {\n  var found = false;\n\n  function findParam(value, key) {\n    if (key === requiredParamsArr[i]) {\n      found = true;\n    }\n  }\n\n  for (var i = 0; i < requiredParamsArr.length; i++) {\n    found = false;\n\n    this._each(paramObj, findParam);\n\n    if (!found) {\n      this.logError('Params are missing for bid request. One of these required paramaters are missing: ' + requiredParamsArr, adapter);\n      return false;\n    }\n  }\n\n  return true;\n};\n\n// Handle addEventListener gracefully in older browsers\nexports.addEventHandler = function (element, event, func) {\n  if (element.addEventListener) {\n    element.addEventListener(event, func, true);\n  } else if (element.attachEvent) {\n    element.attachEvent('on' + event, func);\n  }\n};\n/**\n * Return if the object is of the\n * given type.\n * @param {*} object to test\n * @param {String} _t type string (e.g., Array)\n * @return {Boolean} if object is of type _t\n */\nexports.isA = function (object, _t) {\n  return toString.call(object) === '[object ' + _t + ']';\n};\n\nexports.isFn = function (object) {\n  return this.isA(object, t_Fn);\n};\n\nexports.isStr = function (object) {\n  return this.isA(object, t_Str);\n};\n\nexports.isArray = function (object) {\n  return this.isA(object, t_Arr);\n};\n\nexports.isNumber = function (object) {\n  return this.isA(object, t_Numb);\n};\n\nexports.isPlainObject = function (object) {\n  return this.isA(object, t_Object);\n};\n\n/**\n * Return if the object is \"empty\";\n * this includes falsey, no keys, or no items at indices\n * @param {*} object object to test\n * @return {Boolean} if object is empty\n */\nexports.isEmpty = function (object) {\n  if (!object) return true;\n  if (exports.isArray(object) || exports.isStr(object)) {\n    return !(object.length > 0);\n  }\n\n  for (var k in object) {\n    if (hasOwnProperty.call(object, k)) return false;\n  }\n\n  return true;\n};\n\n/**\n * Return if string is empty, null, or undefined\n * @param str string to test\n * @returns {boolean} if string is empty\n */\nexports.isEmptyStr = function (str) {\n  return this.isStr(str) && (!str || str.length === 0);\n};\n\n/**\n * Iterate object with the function\n * falls back to es5 `forEach`\n * @param {Array|Object} object\n * @param {Function(value, key, object)} fn\n */\nexports._each = function (object, fn) {\n  if (this.isEmpty(object)) return;\n  if (this.isFn(object.forEach)) return object.forEach(fn, this);\n\n  var k = 0;\n  var l = object.length;\n\n  if (l > 0) {\n    for (; k < l; k++) {\n      fn(object[k], k, object);\n    }\n  } else {\n    for (k in object) {\n      if (hasOwnProperty.call(object, k)) fn.call(this, object[k], k);\n    }\n  }\n};\n\nexports.contains = function (a, obj) {\n  if (this.isEmpty(a)) {\n    return false;\n  }\n\n  if (this.isFn(a.indexOf)) {\n    return a.indexOf(obj) !== -1;\n  }\n\n  var i = a.length;\n  while (i--) {\n    if (a[i] === obj) {\n      return true;\n    }\n  }\n\n  return false;\n};\n\nexports.indexOf = function () {\n  if (Array.prototype.indexOf) {\n    return Array.prototype.indexOf;\n  }\n\n  // ie8 no longer supported\n  // return polyfills.indexOf;\n}();\n\n/**\n * Map an array or object into another array\n * given a function\n * @param {Array|Object} object\n * @param {Function(value, key, object)} callback\n * @return {Array}\n */\nexports._map = function (object, callback) {\n  if (this.isEmpty(object)) return [];\n  if (this.isFn(object.map)) return object.map(callback);\n  var output = [];\n  this._each(object, function (value, key) {\n    output.push(callback(value, key, object));\n  });\n\n  return output;\n};\n\nvar hasOwn = function hasOwn(objectToCheck, propertyToCheckFor) {\n  if (objectToCheck.hasOwnProperty) {\n    return objectToCheck.hasOwnProperty(propertyToCheckFor);\n  } else {\n    return typeof objectToCheck[propertyToCheckFor] !== 'undefined' && objectToCheck.constructor.prototype[propertyToCheckFor] !== objectToCheck[propertyToCheckFor];\n  }\n};\n\nexports.insertElement = function (elm, doc, target) {\n  doc = doc || document;\n  var elToAppend = void 0;\n  if (target) {\n    elToAppend = doc.getElementsByTagName(target);\n  } else {\n    elToAppend = doc.getElementsByTagName('head');\n  }\n  try {\n    elToAppend = elToAppend.length ? elToAppend : doc.getElementsByTagName('body');\n    if (elToAppend.length) {\n      elToAppend = elToAppend[0];\n      elToAppend.insertBefore(elm, elToAppend.firstChild);\n    }\n  } catch (e) {}\n};\n\nexports.triggerPixel = function (url) {\n  var img = new Image();\n  img.src = url;\n};\n\nexports.callBurl = function (_ref) {\n  var source = _ref.source,\n      burl = _ref.burl;\n\n  if (source === CONSTANTS.S2S.SRC && burl) {\n    exports.triggerPixel(burl);\n  }\n};\n\n/**\n * Inserts an empty iframe with the specified `html`, primarily used for tracking purposes\n * (though could be for other purposes)\n * @param {string} htmlCode snippet of HTML code used for tracking purposes\n */\nexports.insertHtmlIntoIframe = function (htmlCode) {\n  if (!htmlCode) {\n    return;\n  }\n\n  var iframe = document.createElement('iframe');\n  iframe.id = exports.getUniqueIdentifierStr();\n  iframe.width = 0;\n  iframe.height = 0;\n  iframe.hspace = '0';\n  iframe.vspace = '0';\n  iframe.marginWidth = '0';\n  iframe.marginHeight = '0';\n  iframe.style.display = 'none';\n  iframe.style.height = '0px';\n  iframe.style.width = '0px';\n  iframe.scrolling = 'no';\n  iframe.frameBorder = '0';\n  iframe.allowtransparency = 'true';\n\n  exports.insertElement(iframe, document, 'body');\n\n  iframe.contentWindow.document.open();\n  iframe.contentWindow.document.write(htmlCode);\n  iframe.contentWindow.document.close();\n};\n\n/**\n * Inserts empty iframe with the specified `url` for cookie sync\n * @param  {string} url URL to be requested\n * @param  {string} encodeUri boolean if URL should be encoded before inserted. Defaults to true\n */\nexports.insertUserSyncIframe = function (url) {\n  var iframeHtml = this.createTrackPixelIframeHtml(url, false, 'allow-scripts allow-same-origin');\n  var div = document.createElement('div');\n  div.innerHTML = iframeHtml;\n  var iframe = div.firstChild;\n  exports.insertElement(iframe);\n};\n\n/**\n * Creates a snippet of HTML that retrieves the specified `url`\n * @param  {string} url URL to be requested\n * @return {string}     HTML snippet that contains the img src = set to `url`\n */\nexports.createTrackPixelHtml = function (url) {\n  if (!url) {\n    return '';\n  }\n\n  var escapedUrl = encodeURI(url);\n  var img = '<div style=\"position:absolute;left:0px;top:0px;visibility:hidden;\">';\n  img += '<img src=\"' + escapedUrl + '\"></div>';\n  return img;\n};\n\n/**\n * Creates a snippet of Iframe HTML that retrieves the specified `url`\n * @param  {string} url plain URL to be requested\n * @param  {string} encodeUri boolean if URL should be encoded before inserted. Defaults to true\n * @param  {string} sandbox string if provided the sandbox attribute will be included with the given value\n * @return {string}     HTML snippet that contains the iframe src = set to `url`\n */\nexports.createTrackPixelIframeHtml = function (url) {\n  var encodeUri = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n  var sandbox = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : '';\n\n  if (!url) {\n    return '';\n  }\n  if (encodeUri) {\n    url = encodeURI(url);\n  }\n  if (sandbox) {\n    sandbox = 'sandbox=\"' + sandbox + '\"';\n  }\n\n  return '<iframe ' + sandbox + ' id=\"' + exports.getUniqueIdentifierStr() + '\"\\n      frameborder=\"0\"\\n      allowtransparency=\"true\"\\n      marginheight=\"0\" marginwidth=\"0\"\\n      width=\"0\" hspace=\"0\" vspace=\"0\" height=\"0\"\\n      style=\"height:0px;width:0px;display:none;\"\\n      scrolling=\"no\"\\n      src=\"' + url + '\">\\n    </iframe>';\n};\n\n/**\n * Returns iframe document in a browser agnostic way\n * @param  {object} iframe reference\n * @return {object}        iframe `document` reference\n */\nexports.getIframeDocument = function (iframe) {\n  if (!iframe) {\n    return;\n  }\n\n  var doc = void 0;\n  try {\n    if (iframe.contentWindow) {\n      doc = iframe.contentWindow.document;\n    } else if (iframe.contentDocument.document) {\n      doc = iframe.contentDocument.document;\n    } else {\n      doc = iframe.contentDocument;\n    }\n  } catch (e) {\n    this.logError('Cannot get iframe document', e);\n  }\n\n  return doc;\n};\n\nexports.getValueString = function (param, val, defaultValue) {\n  if (val === undefined || val === null) {\n    return defaultValue;\n  }\n  if (this.isStr(val)) {\n    return val;\n  }\n  if (this.isNumber(val)) {\n    return val.toString();\n  }\n  this.logWarn('Unsuported type for param: ' + param + ' required type: String');\n};\n\nfunction uniques(value, index, arry) {\n  return arry.indexOf(value) === index;\n}\n\nfunction flatten(a, b) {\n  return a.concat(b);\n}\n\nfunction getBidRequest(id, bidsRequested) {\n  return (0, _find2.default)(bidsRequested.map(function (bidSet) {\n    return (0, _find2.default)(bidSet.bids, function (bid) {\n      return bid.bidId === id;\n    });\n  }), function (bid) {\n    return bid;\n  });\n}\n\nfunction getKeys(obj) {\n  return Object.keys(obj);\n}\n\nfunction getValue(obj, key) {\n  return obj[key];\n}\n\nfunction getBidderCodes() {\n  var adUnits = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : pbjs.adUnits;\n\n  // this could memoize adUnits\n  return adUnits.map(function (unit) {\n    return unit.bids.map(function (bid) {\n      return bid.bidder;\n    }).reduce(flatten, []);\n  }).reduce(flatten).filter(uniques);\n}\n\nfunction isGptPubadsDefined() {\n  if (window.googletag && exports.isFn(window.googletag.pubads) && exports.isFn(window.googletag.pubads().getSlots)) {\n    return true;\n  }\n}\n\nfunction getHighestCpm(previous, current) {\n  if (previous.cpm === current.cpm) {\n    return previous.timeToRespond > current.timeToRespond ? current : previous;\n  }\n\n  return previous.cpm < current.cpm ? current : previous;\n}\n\n/**\n * Fisher–Yates shuffle\n * http://stackoverflow.com/a/6274398\n * https://bost.ocks.org/mike/shuffle/\n * istanbul ignore next\n */\nfunction shuffle(array) {\n  var counter = array.length;\n\n  // while there are elements in the array\n  while (counter > 0) {\n    // pick a random index\n    var index = Math.floor(Math.random() * counter);\n\n    // decrease counter by 1\n    counter--;\n\n    // and swap the last element with it\n    var temp = array[counter];\n    array[counter] = array[index];\n    array[index] = temp;\n  }\n\n  return array;\n}\n\nfunction adUnitsFilter(filter, bid) {\n  return (0, _includes2.default)(filter, bid && bid.adUnitCode);\n}\n\n/**\n * Check if parent iframe of passed document supports content rendering via 'srcdoc' property\n * @param {HTMLDocument} doc document to check support of 'srcdoc'\n */\nfunction isSrcdocSupported(doc) {\n  // Firefox is excluded due to https://bugzilla.mozilla.org/show_bug.cgi?id=1265961\n  return doc.defaultView && doc.defaultView.frameElement && 'srcdoc' in doc.defaultView.frameElement && !/firefox/i.test(navigator.userAgent);\n}\n\nfunction deepClone(obj) {\n  return (0, _justClone2.default)(obj);\n}\n\nfunction inIframe() {\n  try {\n    return exports.getWindowSelf() !== exports.getWindowTop();\n  } catch (e) {\n    return true;\n  }\n}\n\nfunction isSafariBrowser() {\n  return (/^((?!chrome|android).)*safari/i.test(navigator.userAgent)\n  );\n}\n\nfunction replaceAuctionPrice(str, cpm) {\n  if (!str) return;\n  return str.replace(/\\$\\{AUCTION_PRICE\\}/g, cpm);\n}\n\nfunction timestamp() {\n  return new Date().getTime();\n}\n\nfunction checkCookieSupport() {\n  if (window.navigator.cookieEnabled || !!document.cookie.length) {\n    return true;\n  }\n}\nfunction cookiesAreEnabled() {\n  if (exports.checkCookieSupport()) {\n    return true;\n  }\n  window.document.cookie = 'prebid.cookieTest';\n  return window.document.cookie.indexOf('prebid.cookieTest') != -1;\n}\n\n/**\n * Given a function, return a function which only executes the original after\n * it's been called numRequiredCalls times.\n *\n * Note that the arguments from the previous calls will *not* be forwarded to the original function.\n * Only the final call's arguments matter.\n *\n * @param {function} func The function which should be executed, once the returned function has been executed\n *   numRequiredCalls times.\n * @param {int} numRequiredCalls The number of times which the returned function needs to be called before\n *   func is.\n */\nfunction delayExecution(func, numRequiredCalls) {\n  if (numRequiredCalls < 1) {\n    throw new Error('numRequiredCalls must be a positive number. Got ' + numRequiredCalls);\n  }\n  var numCalls = 0;\n  return function () {\n    numCalls++;\n    if (numCalls === numRequiredCalls) {\n      func.apply(null, arguments);\n    }\n  };\n}\n\n/**\n * https://stackoverflow.com/a/34890276/428704\n * @export\n * @param {array} xs\n * @param {string} key\n * @returns {${key_value}: ${groupByArray}, key_value: {groupByArray}}\n */\nfunction groupBy(xs, key) {\n  return xs.reduce(function (rv, x) {\n    (rv[x[key]] = rv[x[key]] || []).push(x);\n    return rv;\n  }, {});\n}\n\n/**\n * deepAccess utility function useful for doing safe access (will not throw exceptions) of deep object paths.\n * @param {object} obj The object containing the values you would like to access.\n * @param {string|number} path Object path to the value you would like to access.  Non-strings are coerced to strings.\n * @returns {*} The value found at the specified object path, or undefined if path is not found.\n */\nfunction deepAccess(obj, path) {\n  if (!obj) {\n    return;\n  }\n  path = String(path).split('.');\n  for (var i = 0; i < path.length; i++) {\n    obj = obj[path[i]];\n    if (typeof obj === 'undefined') {\n      return;\n    }\n  }\n  return obj;\n}\n\n/**\n * Returns content for a friendly iframe to execute a URL in script tag\n * @param {url} URL to be executed in a script tag in a friendly iframe\n * <!--PRE_SCRIPT_TAG_MACRO--> and <!--POST_SCRIPT_TAG_MACRO--> are macros left to be replaced if required\n */\nfunction createContentToExecuteExtScriptInFriendlyFrame(url) {\n  if (!url) {\n    return '';\n  }\n\n  return '<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\"><html><head><base target=\"_top\" /><script>inDapIF=true;</script></head><body><!--PRE_SCRIPT_TAG_MACRO--><script src=\"' + url + '\"></script><!--POST_SCRIPT_TAG_MACRO--></body></html>';\n}\n\n/**\n * Build an object consisting of only defined parameters to avoid creating an\n * object with defined keys and undefined values.\n * @param {object} object The object to pick defined params out of\n * @param {string[]} params An array of strings representing properties to look for in the object\n * @returns {object} An object containing all the specified values that are defined\n */\nfunction getDefinedParams(object, params) {\n  return params.filter(function (param) {\n    return object[param];\n  }).reduce(function (bid, param) {\n    return _extends(bid, _defineProperty({}, param, object[param]));\n  }, {});\n}\n\n/**\n * @typedef {Object} MediaTypes\n * @property {Object} banner banner configuration\n * @property {Object} native native configuration\n * @property {Object} video video configuration\n */\n\n/**\n * Validates an adunit's `mediaTypes` parameter\n * @param {MediaTypes} mediaTypes mediaTypes parameter to validate\n * @return {boolean} If object is valid\n */\nfunction isValidMediaTypes(mediaTypes) {\n  var SUPPORTED_MEDIA_TYPES = ['banner', 'native', 'video'];\n  var SUPPORTED_STREAM_TYPES = ['instream', 'outstream'];\n\n  var types = Object.keys(mediaTypes);\n\n  if (!types.every(function (type) {\n    return (0, _includes2.default)(SUPPORTED_MEDIA_TYPES, type);\n  })) {\n    return false;\n  }\n\n  if (mediaTypes.video && mediaTypes.video.context) {\n    return (0, _includes2.default)(SUPPORTED_STREAM_TYPES, mediaTypes.video.context);\n  }\n\n  return true;\n}\n\nfunction getBidderRequest(bidRequests, bidder, adUnitCode) {\n  return (0, _find2.default)(bidRequests, function (request) {\n    return request.bids.filter(function (bid) {\n      return bid.bidder === bidder && bid.adUnitCode === adUnitCode;\n    }).length > 0;\n  }) || { start: null, auctionId: null };\n}\n/**\n * Returns user configured bidder params from adunit\n * @param {object} adunits\n * @param {string} adunit code\n * @param {string} bidder code\n * @return {Array} user configured param for the given bidder adunit configuration\n */\nfunction getUserConfiguredParams(adUnits, adUnitCode, bidder) {\n  return adUnits.filter(function (adUnit) {\n    return adUnit.code === adUnitCode;\n  }).map(function (adUnit) {\n    return adUnit.bids;\n  }).reduce(flatten, []).filter(function (bidderData) {\n    return bidderData.bidder === bidder;\n  }).map(function (bidderData) {\n    return bidderData.params || {};\n  });\n}\n/**\n * Returns the origin\n */\nfunction getOrigin() {\n  // IE10 does not have this property. https://gist.github.com/hbogs/7908703\n  if (!window.location.origin) {\n    return window.location.protocol + '//' + window.location.hostname + (window.location.port ? ':' + window.location.port : '');\n  } else {\n    return window.location.origin;\n  }\n}\n\n/**\n * Returns Do Not Track state\n */\nfunction getDNT() {\n  return navigator.doNotTrack === '1' || window.doNotTrack === '1' || navigator.msDoNotTrack === '1' || navigator.doNotTrack === 'yes';\n}\n\nvar compareCodeAndSlot = function compareCodeAndSlot(slot, adUnitCode) {\n  return slot.getAdUnitPath() === adUnitCode || slot.getSlotElementId() === adUnitCode;\n};\n\n/**\n * Returns filter function to match adUnitCode in slot\n * @param {object} slot GoogleTag slot\n * @return {function} filter function\n */\nfunction isAdUnitCodeMatchingSlot(slot) {\n  return function (adUnitCode) {\n    return compareCodeAndSlot(slot, adUnitCode);\n  };\n}\n\n/**\n * Returns filter function to match adUnitCode in slot\n * @param {string} adUnitCode AdUnit code\n * @return {function} filter function\n */\nfunction isSlotMatchingAdUnitCode(adUnitCode) {\n  return function (slot) {\n    return compareCodeAndSlot(slot, adUnitCode);\n  };\n}\n\n/**\n * Constructs warning message for when unsupported bidders are dropped from an adunit\n * @param {Object} adUnit ad unit from which the bidder is being dropped\n * @param {string} bidder bidder code that is not compatible with the adUnit\n * @return {string} warning message to display when condition is met\n */\nfunction unsupportedBidderMessage(adUnit, bidder) {\n  var mediaType = Object.keys(adUnit.mediaTypes || { 'banner': 'banner' }).join(', ');\n\n  return '\\n    ' + adUnit.code + ' is a ' + mediaType + ' ad unit\\n    containing bidders that don\\'t support ' + mediaType + ': ' + bidder + '.\\n    This bidder won\\'t fetch demand.\\n  ';\n}\n\n/**\n * Delete property from object\n * @param {Object} object\n * @param {string} prop\n * @return {Object} object\n */\nfunction deletePropertyFromObject(object, prop) {\n  var result = _extends({}, object);\n  delete result[prop];\n  return result;\n}\n\n/**\n * Delete requestId from external bid object.\n * @param {Object} bid\n * @return {Object} bid\n */\nfunction removeRequestId(bid) {\n  return exports.deletePropertyFromObject(bid, 'requestId');\n}\n\n/**\n * Checks input is integer or not\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Number/isInteger\n * @param {*} value\n */\nfunction isInteger(value) {\n  if (Number.isInteger) {\n    return Number.isInteger(value);\n  } else {\n    return typeof value === 'number' && isFinite(value) && Math.floor(value) === value;\n  }\n}\n\n/**\n * Converts a string value in camel-case to underscore eg 'placementId' becomes 'placement_id'\n * @param {string} value string value to convert\n */\nfunction convertCamelToUnderscore(value) {\n  return value.replace(/(?:^|\\.?)([A-Z])/g, function (x, y) {\n    return '_' + y.toLowerCase();\n  }).replace(/^_/, '');\n}\n\n/***/ }),\n\n/***/ 1:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nexports.registerBidder = registerBidder;\nexports.newBidder = newBidder;\nexports.isValid = isValid;\n\nvar _adapter = __webpack_require__(25);\n\nvar _adapter2 = _interopRequireDefault(_adapter);\n\nvar _adaptermanager = __webpack_require__(8);\n\nvar _adaptermanager2 = _interopRequireDefault(_adaptermanager);\n\nvar _config = __webpack_require__(4);\n\nvar _bidfactory = __webpack_require__(19);\n\nvar _bidfactory2 = _interopRequireDefault(_bidfactory);\n\nvar _userSync = __webpack_require__(13);\n\nvar _native = __webpack_require__(18);\n\nvar _video = __webpack_require__(64);\n\nvar _constants = __webpack_require__(2);\n\nvar _constants2 = _interopRequireDefault(_constants);\n\nvar _events = __webpack_require__(9);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _includes = __webpack_require__(7);\n\nvar _includes2 = _interopRequireDefault(_includes);\n\nvar _utils = __webpack_require__(0);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * This file aims to support Adapters during the Prebid 0.x -> 1.x transition.\n *\n * Prebid 1.x and Prebid 0.x will be in separate branches--perhaps for a long time.\n * This function defines an API for adapter construction which is compatible with both versions.\n * Adapters which use it can maintain their code in master, and only this file will need to change\n * in the 1.x branch.\n *\n * Typical usage looks something like:\n *\n * const adapter = registerBidder({\n *   code: 'myBidderCode',\n *   aliases: ['alias1', 'alias2'],\n *   supportedMediaTypes: ['video', 'native'],\n *   isBidRequestValid: function(paramsObject) { return true/false },\n *   buildRequests: function(bidRequests, bidderRequest) { return some ServerRequest(s) },\n *   interpretResponse: function(oneServerResponse) { return some Bids, or throw an error. }\n * });\n *\n * @see BidderSpec for the full API and more thorough descriptions.\n */\n\n/**\n * @typedef {object} BidderSpec An object containing the adapter-specific functions needed to\n * make a Bidder.\n *\n * @property {string} code A code which will be used to uniquely identify this bidder. This should be the same\n *   one as is used in the call to registerBidAdapter\n * @property {string[]} [aliases] A list of aliases which should also resolve to this bidder.\n * @property {MediaType[]} [supportedMediaTypes]: A list of Media Types which the adapter supports.\n * @property {function(object): boolean} isBidRequestValid Determines whether or not the given bid has all the params\n *   needed to make a valid request.\n * @property {function(BidRequest[], bidderRequest): ServerRequest|ServerRequest[]} buildRequests Build the request to the Server\n *   which requests Bids for the given array of Requests. Each BidRequest in the argument array is guaranteed to have\n *   passed the isBidRequestValid() test.\n * @property {function(ServerResponse, BidRequest): Bid[]} interpretResponse Given a successful response from the Server,\n *   interpret it and return the Bid objects. This function will be run inside a try/catch.\n *   If it throws any errors, your bids will be discarded.\n * @property {function(SyncOptions, ServerResponse[]): UserSync[]} [getUserSyncs] Given an array of all the responses\n *   from the server, determine which user syncs should occur. The argument array will contain every element\n *   which has been sent through to interpretResponse. The order of syncs in this array matters. The most\n *   important ones should come first, since publishers may limit how many are dropped on their page.\n */\n\n/**\n * @typedef {object} BidRequest\n *\n * @property {string} bidId A string which uniquely identifies this BidRequest in the current Auction.\n * @property {object} params Any bidder-specific params which the publisher used in their bid request.\n */\n\n/**\n * @typedef {object} ServerRequest\n *\n * @property {('GET'|'POST')} method The type of request which this is.\n * @property {string} url The endpoint for the request. For example, \"//bids.example.com\".\n * @property {string|object} data Data to be sent in the request.\n * @property {object} options Content-Type set in the header of the bid request, overrides default 'text/plain'.\n *   If this is a GET request, they'll become query params. If it's a POST request, they'll be added to the body.\n *   Strings will be added as-is. Objects will be unpacked into query params based on key/value mappings, or\n *   JSON-serialized into the Request body.\n */\n\n/**\n * @typedef {object} ServerResponse\n *\n * @property {*} body The response body. If this is legal JSON, then it will be parsed. Otherwise it'll be a\n *   string with the body's content.\n * @property {{get: function(string): string} headers The response headers.\n *   Call this like `ServerResponse.headers.get(\"Content-Type\")`\n */\n\n/**\n * @typedef {object} Bid\n *\n * @property {string} requestId The specific BidRequest which this bid is aimed at.\n *   This should match the BidRequest.bidId which this Bid targets.\n * @property {string} ad A URL which can be used to load this ad, if it's chosen by the publisher.\n * @property {string} currency The currency code for the cpm value\n * @property {number} cpm The bid price, in US cents per thousand impressions.\n * @property {number} ttl Time-to-live - how long (in seconds) Prebid can use this bid.\n * @property {boolean} netRevenue Boolean defining whether the bid is Net or Gross.  The default is true (Net).\n * @property {number} height The height of the ad, in pixels.\n * @property {number} width The width of the ad, in pixels.\n *\n * @property [Renderer] renderer A Renderer which can be used as a default for this bid,\n *   if the publisher doesn't override it. This is only relevant for Outstream Video bids.\n */\n\n/**\n * @typedef {Object} SyncOptions\n *\n * An object containing information about usersyncs which the adapter should obey.\n *\n * @property {boolean} iframeEnabled True if iframe usersyncs are allowed, and false otherwise\n * @property {boolean} pixelEnabled True if image usersyncs are allowed, and false otherwise\n */\n\n/**\n * TODO: Move this to the UserSync module after that PR is merged.\n *\n * @typedef {object} UserSync\n *\n * @property {('image'|'iframe')} type The type of user sync to be done.\n * @property {string} url The URL which makes the sync happen.\n */\n\n// common params for all mediaTypes\nvar COMMON_BID_RESPONSE_KEYS = ['requestId', 'cpm', 'ttl', 'creativeId', 'netRevenue', 'currency'];\n\n/**\n * Register a bidder with prebid, using the given spec.\n *\n * If possible, Adapter modules should use this function instead of adaptermanager.registerBidAdapter().\n *\n * @param {BidderSpec} spec An object containing the bare-bones functions we need to make a Bidder.\n */\nfunction registerBidder(spec) {\n  var mediaTypes = Array.isArray(spec.supportedMediaTypes) ? { supportedMediaTypes: spec.supportedMediaTypes } : undefined;\n  function putBidder(spec) {\n    var bidder = newBidder(spec);\n    _adaptermanager2.default.registerBidAdapter(bidder, spec.code, mediaTypes);\n  }\n\n  putBidder(spec);\n  if (Array.isArray(spec.aliases)) {\n    spec.aliases.forEach(function (alias) {\n      _adaptermanager2.default.aliasRegistry[alias] = spec.code;\n      putBidder(_extends({}, spec, { code: alias }));\n    });\n  }\n}\n\n/**\n * Make a new bidder from the given spec. This is exported mainly for testing.\n * Adapters will probably find it more convenient to use registerBidder instead.\n *\n * @param {BidderSpec} spec\n */\nfunction newBidder(spec) {\n  return _extends(new _adapter2.default(spec.code), {\n    getSpec: function getSpec() {\n      return Object.freeze(spec);\n    },\n    registerSyncs: registerSyncs,\n    callBids: function callBids(bidderRequest, addBidResponse, done, ajax) {\n      if (!Array.isArray(bidderRequest.bids)) {\n        return;\n      }\n\n      var adUnitCodesHandled = {};\n      function addBidWithCode(adUnitCode, bid) {\n        adUnitCodesHandled[adUnitCode] = true;\n        if (isValid(adUnitCode, bid, [bidderRequest])) {\n          addBidResponse(adUnitCode, bid);\n        }\n      }\n\n      // After all the responses have come back, call done() and\n      // register any required usersync pixels.\n      var responses = [];\n      function afterAllResponses(bids) {\n        var bidsArray = bids ? bids[0] ? bids : [bids] : [];\n\n        var videoBid = bidsArray.some(function (bid) {\n          return bid.mediaType === 'video';\n        });\n        var cacheEnabled = _config.config.getConfig('cache.url');\n\n        // video bids with cache enabled need to be cached first before they are considered done\n        if (!(videoBid && cacheEnabled)) {\n          done();\n        }\n\n        // TODO: the code above needs to be refactored. We should always call done when we're done. if the auction\n        // needs to do cleanup before _it_ can be done it should handle that itself in the auction.  It should _not_\n        // require us, the bidders, to conditionally call done.  That makes the whole done API very flaky.\n        // As soon as that is refactored, we can move this emit event where it should be, within the done function.\n        _events2.default.emit(_constants2.default.EVENTS.BIDDER_DONE, bidderRequest);\n\n        registerSyncs(responses, bidderRequest.gdprConsent);\n      }\n\n      var validBidRequests = bidderRequest.bids.filter(filterAndWarn);\n      if (validBidRequests.length === 0) {\n        afterAllResponses();\n        return;\n      }\n      var bidRequestMap = {};\n      validBidRequests.forEach(function (bid) {\n        bidRequestMap[bid.bidId] = bid;\n        // Delete this once we are 1.0\n        if (!bid.adUnitCode) {\n          bid.adUnitCode = bid.placementCode;\n        }\n      });\n\n      var requests = spec.buildRequests(validBidRequests, bidderRequest);\n      if (!requests || requests.length === 0) {\n        afterAllResponses();\n        return;\n      }\n      if (!Array.isArray(requests)) {\n        requests = [requests];\n      }\n\n      // Callbacks don't compose as nicely as Promises. We should call done() once _all_ the\n      // Server requests have returned and been processed. Since `ajax` accepts a single callback,\n      // we need to rig up a function which only executes after all the requests have been responded.\n      var onResponse = (0, _utils.delayExecution)(afterAllResponses, requests.length);\n      requests.forEach(processRequest);\n\n      function formatGetParameters(data) {\n        if (data) {\n          return '?' + ((typeof data === 'undefined' ? 'undefined' : _typeof(data)) === 'object' ? (0, _utils.parseQueryStringParameters)(data) : data);\n        }\n\n        return '';\n      }\n\n      function processRequest(request) {\n        switch (request.method) {\n          case 'GET':\n            ajax('' + request.url + formatGetParameters(request.data), {\n              success: onSuccess,\n              error: onFailure\n            }, undefined, _extends({\n              method: 'GET',\n              withCredentials: true\n            }, request.options));\n            break;\n          case 'POST':\n            ajax(request.url, {\n              success: onSuccess,\n              error: onFailure\n            }, typeof request.data === 'string' ? request.data : JSON.stringify(request.data), _extends({\n              method: 'POST',\n              contentType: 'text/plain',\n              withCredentials: true\n            }, request.options));\n            break;\n          default:\n            (0, _utils.logWarn)('Skipping invalid request from ' + spec.code + '. Request type ' + request.type + ' must be GET or POST');\n            onResponse();\n        }\n\n        // If the server responds successfully, use the adapter code to unpack the Bids from it.\n        // If the adapter code fails, no bids should be added. After all the bids have been added, make\n        // sure to call the `onResponse` function so that we're one step closer to calling done().\n        function onSuccess(response, responseObj) {\n          try {\n            response = JSON.parse(response);\n          } catch (e) {} /* response might not be JSON... that's ok. */\n\n          // Make response headers available for #1742. These are lazy-loaded because most adapters won't need them.\n          response = {\n            body: response,\n            headers: headerParser(responseObj)\n          };\n          responses.push(response);\n\n          var bids = void 0;\n          try {\n            bids = spec.interpretResponse(response, request);\n          } catch (err) {\n            (0, _utils.logError)('Bidder ' + spec.code + ' failed to interpret the server\\'s response. Continuing without bids', null, err);\n            onResponse();\n            return;\n          }\n\n          if (bids) {\n            if (bids.forEach) {\n              bids.forEach(addBidUsingRequestMap);\n            } else {\n              addBidUsingRequestMap(bids);\n            }\n          }\n          onResponse(bids);\n\n          function addBidUsingRequestMap(bid) {\n            var bidRequest = bidRequestMap[bid.requestId];\n            if (bidRequest) {\n              var prebidBid = _extends(_bidfactory2.default.createBid(_constants2.default.STATUS.GOOD, bidRequest), bid);\n              addBidWithCode(bidRequest.adUnitCode, prebidBid);\n            } else {\n              (0, _utils.logWarn)('Bidder ' + spec.code + ' made bid for unknown request ID: ' + bid.requestId + '. Ignoring.');\n            }\n          }\n\n          function headerParser(xmlHttpResponse) {\n            return {\n              get: responseObj.getResponseHeader.bind(responseObj)\n            };\n          }\n        }\n\n        // If the server responds with an error, there's not much we can do. Log it, and make sure to\n        // call onResponse() so that we're one step closer to calling done().\n        function onFailure(err) {\n          (0, _utils.logError)('Server call for ' + spec.code + ' failed: ' + err + '. Continuing without bids.');\n          onResponse();\n        }\n      }\n    }\n  });\n\n  function registerSyncs(responses, gdprConsent) {\n    if (spec.getUserSyncs) {\n      var syncs = spec.getUserSyncs({\n        iframeEnabled: _config.config.getConfig('userSync.iframeEnabled'),\n        pixelEnabled: _config.config.getConfig('userSync.pixelEnabled')\n      }, responses, gdprConsent);\n      if (syncs) {\n        if (!Array.isArray(syncs)) {\n          syncs = [syncs];\n        }\n        syncs.forEach(function (sync) {\n          _userSync.userSync.registerSync(sync.type, spec.code, sync.url);\n        });\n      }\n    }\n  }\n\n  function filterAndWarn(bid) {\n    if (!spec.isBidRequestValid(bid)) {\n      (0, _utils.logWarn)('Invalid bid sent to bidder ' + spec.code + ': ' + JSON.stringify(bid));\n      return false;\n    }\n    return true;\n  }\n}\n\n// check that the bid has a width and height set\nfunction validBidSize(adUnitCode, bid, bidRequests) {\n  if ((bid.width || bid.width === 0) && (bid.height || bid.height === 0)) {\n    return true;\n  }\n\n  var adUnit = (0, _utils.getBidderRequest)(bidRequests, bid.bidderCode, adUnitCode);\n\n  var sizes = adUnit && adUnit.bids && adUnit.bids[0] && adUnit.bids[0].sizes;\n  var parsedSizes = (0, _utils.parseSizesInput)(sizes);\n\n  // if a banner impression has one valid size, we assign that size to any bid\n  // response that does not explicitly set width or height\n  if (parsedSizes.length === 1) {\n    var _parsedSizes$0$split = parsedSizes[0].split('x'),\n        _parsedSizes$0$split2 = _slicedToArray(_parsedSizes$0$split, 2),\n        width = _parsedSizes$0$split2[0],\n        height = _parsedSizes$0$split2[1];\n\n    bid.width = width;\n    bid.height = height;\n    return true;\n  }\n\n  return false;\n}\n\n// Validate the arguments sent to us by the adapter. If this returns false, the bid should be totally ignored.\nfunction isValid(adUnitCode, bid, bidRequests) {\n  function hasValidKeys() {\n    var bidKeys = Object.keys(bid);\n    return COMMON_BID_RESPONSE_KEYS.every(function (key) {\n      return (0, _includes2.default)(bidKeys, key);\n    });\n  }\n\n  function errorMessage(msg) {\n    return 'Invalid bid from ' + bid.bidderCode + '. Ignoring bid: ' + msg;\n  }\n\n  if (!adUnitCode) {\n    (0, _utils.logWarn)('No adUnitCode was supplied to addBidResponse.');\n    return false;\n  }\n\n  if (!bid) {\n    (0, _utils.logWarn)('Some adapter tried to add an undefined bid for ' + adUnitCode + '.');\n    return false;\n  }\n\n  if (!hasValidKeys()) {\n    (0, _utils.logError)(errorMessage('Bidder ' + bid.bidderCode + ' is missing required params. Check http://prebid.org/dev-docs/bidder-adapter-1.html for list of params.'));\n    return false;\n  }\n\n  if (bid.mediaType === 'native' && !(0, _native.nativeBidIsValid)(bid, bidRequests)) {\n    (0, _utils.logError)(errorMessage('Native bid missing some required properties.'));\n    return false;\n  }\n  if (bid.mediaType === 'video' && !(0, _video.isValidVideoBid)(bid, bidRequests)) {\n    (0, _utils.logError)(errorMessage('Video bid does not have required vastUrl or renderer property'));\n    return false;\n  }\n  if (bid.mediaType === 'banner' && !validBidSize(adUnitCode, bid, bidRequests)) {\n    (0, _utils.logError)(errorMessage('Banner bids require a width and height'));\n    return false;\n  }\n\n  return true;\n}\n\n/***/ }),\n\n/***/ 10:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(42);\nmodule.exports = __webpack_require__(15).Array.find;\n\n\n/***/ }),\n\n/***/ 101:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n// 22.1.3.9 Array.prototype.findIndex(predicate, thisArg = undefined)\nvar $export = __webpack_require__(16);\nvar $find = __webpack_require__(30)(6);\nvar KEY = 'findIndex';\nvar forced = true;\n// Shouldn't skip holes\nif (KEY in []) Array(1)[KEY](function () { forced = false; });\n$export($export.P + $export.F * forced, 'Array', {\n  findIndex: function findIndex(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n__webpack_require__(24)(KEY);\n\n\n/***/ }),\n\n/***/ 11:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _includes = __webpack_require__(7);\n\nvar _includes2 = _interopRequireDefault(_includes);\n\nvar _utils = __webpack_require__(0);\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar _requestCache = {};\nvar _vendorWhitelist = ['criteo'];\n\n/**\n * Loads external javascript. Can only be used if external JS is approved by Prebid. See https://github.com/prebid/prebid-js-external-js-template#policy\n * Each unique URL will be loaded at most 1 time.\n * @param {string} url the url to load\n * @param {string} moduleCode bidderCode or module code of the module requesting this resource\n */\nexports.loadExternalScript = function (url, moduleCode) {\n  if (!moduleCode || !url) {\n    utils.logError('cannot load external script without url and moduleCode');\n    return;\n  }\n  if (!(0, _includes2.default)(_vendorWhitelist, moduleCode)) {\n    utils.logError(moduleCode + ' not whitelisted for loading external JavaScript');\n    return;\n  }\n  // only load each asset once\n  if (_requestCache[url]) {\n    return;\n  }\n\n  utils.logWarn('module ' + moduleCode + ' is loading external JavaScript');\n  var script = document.createElement('script');\n  script.type = 'text/javascript';\n  script.async = true;\n  script.src = url;\n\n  utils.insertElement(script);\n  _requestCache[url] = true;\n};\n\n/**\n *\n * @deprecated\n * Do not use this function. Will be removed in the next release. If external resources are required, use #loadExternalScript instead.\n */\nexports.loadScript = function (tagSrc, callback, cacheRequest) {\n  // var noop = () => {};\n  //\n  // callback = callback || noop;\n  if (!tagSrc) {\n    utils.logError('Error attempting to request empty URL', 'adloader.js:loadScript');\n    return;\n  }\n\n  if (cacheRequest) {\n    if (_requestCache[tagSrc]) {\n      if (callback && typeof callback === 'function') {\n        if (_requestCache[tagSrc].loaded) {\n          // invokeCallbacks immediately\n          callback();\n        } else {\n          // queue the callback\n          _requestCache[tagSrc].callbacks.push(callback);\n        }\n      }\n    } else {\n      _requestCache[tagSrc] = {\n        loaded: false,\n        callbacks: []\n      };\n      if (callback && typeof callback === 'function') {\n        _requestCache[tagSrc].callbacks.push(callback);\n      }\n\n      requestResource(tagSrc, function () {\n        _requestCache[tagSrc].loaded = true;\n        try {\n          for (var i = 0; i < _requestCache[tagSrc].callbacks.length; i++) {\n            _requestCache[tagSrc].callbacks[i]();\n          }\n        } catch (e) {\n          utils.logError('Error executing callback', 'adloader.js:loadScript', e);\n        }\n      });\n    }\n  } else {\n    // trigger one time request\n    requestResource(tagSrc, callback);\n  }\n};\n\nfunction requestResource(tagSrc, callback) {\n  var jptScript = document.createElement('script');\n  jptScript.type = 'text/javascript';\n  jptScript.async = true;\n\n  // Execute a callback if necessary\n  if (callback && typeof callback === 'function') {\n    if (jptScript.readyState) {\n      jptScript.onreadystatechange = function () {\n        if (jptScript.readyState === 'loaded' || jptScript.readyState === 'complete') {\n          jptScript.onreadystatechange = null;\n          callback();\n        }\n      };\n    } else {\n      jptScript.onload = function () {\n        callback();\n      };\n    }\n  }\n\n  jptScript.src = tagSrc;\n\n  // add the new script tag to the page\n  var elToAppend = document.getElementsByTagName('head');\n  elToAppend = elToAppend.length ? elToAppend : document.getElementsByTagName('body');\n  if (elToAppend.length) {\n    elToAppend = elToAppend[0];\n    elToAppend.insertBefore(jptScript, elToAppend.firstChild);\n  }\n}\n\n/***/ }),\n\n/***/ 12:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nexports.parseQS = parseQS;\nexports.formatQS = formatQS;\nexports.parse = parse;\nexports.format = format;\nfunction parseQS(query) {\n  return !query ? {} : query.replace(/^\\?/, '').split('&').reduce(function (acc, criteria) {\n    var _criteria$split = criteria.split('='),\n        _criteria$split2 = _slicedToArray(_criteria$split, 2),\n        k = _criteria$split2[0],\n        v = _criteria$split2[1];\n\n    if (/\\[\\]$/.test(k)) {\n      k = k.replace('[]', '');\n      acc[k] = acc[k] || [];\n      acc[k].push(v);\n    } else {\n      acc[k] = v || '';\n    }\n    return acc;\n  }, {});\n}\n\nfunction formatQS(query) {\n  return Object.keys(query).map(function (k) {\n    return Array.isArray(query[k]) ? query[k].map(function (v) {\n      return k + '[]=' + v;\n    }).join('&') : k + '=' + query[k];\n  }).join('&');\n}\n\nfunction parse(url, options) {\n  var parsed = document.createElement('a');\n  if (options && 'noDecodeWholeURL' in options && options.noDecodeWholeURL) {\n    parsed.href = url;\n  } else {\n    parsed.href = decodeURIComponent(url);\n  }\n  // in window.location 'search' is string, not object\n  var qsAsString = options && 'decodeSearchAsString' in options && options.decodeSearchAsString;\n  return {\n    href: parsed.href,\n    protocol: (parsed.protocol || '').replace(/:$/, ''),\n    hostname: parsed.hostname,\n    port: +parsed.port,\n    pathname: parsed.pathname.replace(/^(?!\\/)/, '/'),\n    search: qsAsString ? parsed.search : parseQS(parsed.search || ''),\n    hash: (parsed.hash || '').replace(/^#/, ''),\n    host: parsed.host || window.location.host\n  };\n}\n\nfunction format(obj) {\n  return (obj.protocol || 'http') + '://' + (obj.host || obj.hostname + (obj.port ? ':' + obj.port : '')) + (obj.pathname || '') + (obj.search ? '?' + formatQS(obj.search || '') : '') + (obj.hash ? '#' + obj.hash : '');\n}\n\n/***/ }),\n\n/***/ 13:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.userSync = undefined;\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nexports.newUserSync = newUserSync;\n\nvar _utils = __webpack_require__(0);\n\nvar utils = _interopRequireWildcard(_utils);\n\nvar _config = __webpack_require__(4);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n// Set userSync default values\n_config.config.setDefaults({\n  'userSync': {\n    syncEnabled: true,\n    pixelEnabled: true,\n    syncsPerBidder: 5,\n    syncDelay: 3000\n  }\n});\n\n/**\n * Factory function which creates a new UserSyncPool.\n *\n * @param {UserSyncDependencies} userSyncDependencies Configuration options and dependencies which the\n *   UserSync object needs in order to behave properly.\n */\nfunction newUserSync(userSyncDependencies) {\n  var publicApi = {};\n  // A queue of user syncs for each adapter\n  // Let getDefaultQueue() set the defaults\n  var queue = getDefaultQueue();\n\n  // Whether or not user syncs have been trigger on this page load\n  var hasFired = false;\n  // How many bids for each adapter\n  var numAdapterBids = {};\n\n  // Use what is in config by default\n  var usConfig = userSyncDependencies.config;\n  // Update if it's (re)set\n  _config.config.getConfig('userSync', function (conf) {\n    usConfig = _extends(usConfig, conf.userSync);\n  });\n\n  /**\n   * @function getDefaultQueue\n   * @summary Returns the default empty queue\n   * @private\n   * @return {object} A queue with no syncs\n   */\n  function getDefaultQueue() {\n    return {\n      image: [],\n      iframe: []\n    };\n  }\n\n  /**\n   * @function fireSyncs\n   * @summary Trigger all user syncs in the queue\n   * @private\n   */\n  function fireSyncs() {\n    if (!usConfig.syncEnabled || !userSyncDependencies.browserSupportsCookies || hasFired) {\n      return;\n    }\n\n    try {\n      // Image pixels\n      fireImagePixels();\n      // Iframe syncs\n      loadIframes();\n    } catch (e) {\n      return utils.logError('Error firing user syncs', e);\n    }\n    // Reset the user sync queue\n    queue = getDefaultQueue();\n    hasFired = true;\n  }\n\n  /**\n   * @function fireImagePixels\n   * @summary Loops through user sync pixels and fires each one\n   * @private\n   */\n  function fireImagePixels() {\n    if (!usConfig.pixelEnabled) {\n      return;\n    }\n    // Randomize the order of the pixels before firing\n    // This is to avoid giving any bidder who has registered multiple syncs\n    // any preferential treatment and balancing them out\n    utils.shuffle(queue.image).forEach(function (sync) {\n      var _sync = _slicedToArray(sync, 2),\n          bidderName = _sync[0],\n          trackingPixelUrl = _sync[1];\n\n      utils.logMessage('Invoking image pixel user sync for bidder: ' + bidderName);\n      // Create image object and add the src url\n      utils.triggerPixel(trackingPixelUrl);\n    });\n  }\n\n  /**\n   * @function loadIframes\n   * @summary Loops through iframe syncs and loads an iframe element into the page\n   * @private\n   */\n  function loadIframes() {\n    if (!usConfig.iframeEnabled) {\n      return;\n    }\n    // Randomize the order of these syncs just like the pixels above\n    utils.shuffle(queue.iframe).forEach(function (sync) {\n      var _sync2 = _slicedToArray(sync, 2),\n          bidderName = _sync2[0],\n          iframeUrl = _sync2[1];\n\n      utils.logMessage('Invoking iframe user sync for bidder: ' + bidderName);\n      // Insert iframe into DOM\n      utils.insertUserSyncIframe(iframeUrl);\n    });\n  }\n\n  /**\n   * @function incrementAdapterBids\n   * @summary Increment the count of user syncs queue for the adapter\n   * @private\n   * @params {object} numAdapterBids The object contain counts for all adapters\n   * @params {string} bidder The name of the bidder adding a sync\n   * @returns {object} The updated version of numAdapterBids\n   */\n  function incrementAdapterBids(numAdapterBids, bidder) {\n    if (!numAdapterBids[bidder]) {\n      numAdapterBids[bidder] = 1;\n    } else {\n      numAdapterBids[bidder] += 1;\n    }\n    return numAdapterBids;\n  }\n\n  /**\n   * @function registerSync\n   * @summary Add sync for this bidder to a queue to be fired later\n   * @public\n   * @params {string} type The type of the sync including image, iframe\n   * @params {string} bidder The name of the adapter. e.g. \"rubicon\"\n   * @params {string} url Either the pixel url or iframe url depending on the type\n    * @example <caption>Using Image Sync</caption>\n   * // registerSync(type, adapter, pixelUrl)\n   * userSync.registerSync('image', 'rubicon', 'http://example.com/pixel')\n   */\n  publicApi.registerSync = function (type, bidder, url) {\n    if (!usConfig.syncEnabled || !utils.isArray(queue[type])) {\n      return utils.logWarn('User sync type \"' + type + '\" not supported');\n    }\n    if (!bidder) {\n      return utils.logWarn('Bidder is required for registering sync');\n    }\n    if (Number(numAdapterBids[bidder]) >= usConfig.syncsPerBidder) {\n      return utils.logWarn('Number of user syncs exceeded for \"' + bidder + '\"');\n    }\n    // All bidders are enabled by default. If specified only register for enabled bidders.\n    var hasEnabledBidders = usConfig.enabledBidders && usConfig.enabledBidders.length;\n    if (hasEnabledBidders && usConfig.enabledBidders.indexOf(bidder) < 0) {\n      return utils.logWarn('Bidder \"' + bidder + '\" not supported');\n    }\n    queue[type].push([bidder, url]);\n    numAdapterBids = incrementAdapterBids(numAdapterBids, bidder);\n  };\n\n  /**\n   * @function syncUsers\n   * @summary Trigger all the user syncs based on publisher-defined timeout\n   * @public\n   * @params {int} timeout The delay in ms before syncing data - default 0\n   */\n  publicApi.syncUsers = function () {\n    var timeout = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n\n    if (timeout) {\n      return setTimeout(fireSyncs, Number(timeout));\n    }\n    fireSyncs();\n  };\n\n  /**\n   * @function triggerUserSyncs\n   * @summary A `syncUsers` wrapper for determining if enableOverride has been turned on\n   * @public\n   */\n  publicApi.triggerUserSyncs = function () {\n    if (usConfig.enableOverride) {\n      publicApi.syncUsers();\n    }\n  };\n\n  return publicApi;\n}\n\nvar browserSupportsCookies = !utils.isSafariBrowser() && utils.cookiesAreEnabled();\n\nvar userSync = exports.userSync = newUserSync({\n  config: _config.config.getConfig('userSync'),\n  browserSupportsCookies: browserSupportsCookies\n});\n\n/**\n * @typedef {Object} UserSyncDependencies\n *\n * @property {UserSyncConfig} config\n * @property {boolean} browserSupportsCookies True if the current browser supports cookies, and false otherwise.\n */\n\n/**\n * @typedef {Object} UserSyncConfig\n *\n * @property {boolean} enableOverride\n * @property {boolean} syncEnabled\n * @property {boolean} pixelEnabled\n * @property {boolean} iframeEnabled\n * @property {int} syncsPerBidder\n * @property {string[]} enabledBidders\n */\n\n/***/ }),\n\n/***/ 14:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Renderer = Renderer;\n\nvar _adloader = __webpack_require__(11);\n\nvar _utils = __webpack_require__(0);\n\nvar utils = _interopRequireWildcard(_utils);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n/**\n * @typedef {object} Renderer\n *\n * A Renderer stores some functions which are used to render a particular Bid.\n * These are used in Outstream Video Bids, returned on the Bid by the adapter, and will\n * be used to render that bid unless the Publisher overrides them.\n */\n\nfunction Renderer(options) {\n  var _this = this;\n\n  var url = options.url,\n      config = options.config,\n      id = options.id,\n      callback = options.callback,\n      loaded = options.loaded;\n\n  this.url = url;\n  this.config = config;\n  this.handlers = {};\n  this.id = id;\n\n  // a renderer may push to the command queue to delay rendering until the\n  // render function is loaded by loadScript, at which point the the command\n  // queue will be processed\n  this.loaded = loaded;\n  this.cmd = [];\n  this.push = function (func) {\n    if (typeof func !== 'function') {\n      utils.logError('Commands given to Renderer.push must be wrapped in a function');\n      return;\n    }\n    _this.loaded ? func.call() : _this.cmd.push(func);\n  };\n\n  // bidders may override this with the `callback` property given to `install`\n  this.callback = callback || function () {\n    _this.loaded = true;\n    _this.process();\n  };\n\n  // we expect to load a renderer url once only so cache the request to load script\n  (0, _adloader.loadScript)(url, this.callback, true);\n}\n\nRenderer.install = function (_ref) {\n  var url = _ref.url,\n      config = _ref.config,\n      id = _ref.id,\n      callback = _ref.callback,\n      loaded = _ref.loaded;\n\n  return new Renderer({ url: url, config: config, id: id, callback: callback, loaded: loaded });\n};\n\nRenderer.prototype.getConfig = function () {\n  return this.config;\n};\n\nRenderer.prototype.setRender = function (fn) {\n  this.render = fn;\n};\n\nRenderer.prototype.setEventHandlers = function (handlers) {\n  this.handlers = handlers;\n};\n\nRenderer.prototype.handleVideoEvent = function (_ref2) {\n  var id = _ref2.id,\n      eventName = _ref2.eventName;\n\n  if (typeof this.handlers[eventName] === 'function') {\n    this.handlers[eventName]();\n  }\n\n  utils.logMessage('Prebid Renderer event for id ' + id + ' type ' + eventName);\n};\n\n/*\n * Calls functions that were pushed to the command queue before the\n * renderer was loaded by `loadScript`\n */\nRenderer.prototype.process = function () {\n  while (this.cmd.length > 0) {\n    try {\n      this.cmd.shift().call();\n    } catch (error) {\n      utils.logError('Error processing Renderer command: ', error);\n    }\n  }\n};\n\n/***/ }),\n\n/***/ 15:\n/***/ (function(module, exports) {\n\nvar core = module.exports = { version: '2.5.5' };\nif (typeof __e == 'number') __e = core; // eslint-disable-line no-undef\n\n\n/***/ }),\n\n/***/ 16:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar global = __webpack_require__(20);\nvar core = __webpack_require__(15);\nvar ctx = __webpack_require__(28);\nvar hide = __webpack_require__(44);\nvar has = __webpack_require__(51);\nvar PROTOTYPE = 'prototype';\n\nvar $export = function (type, name, source) {\n  var IS_FORCED = type & $export.F;\n  var IS_GLOBAL = type & $export.G;\n  var IS_STATIC = type & $export.S;\n  var IS_PROTO = type & $export.P;\n  var IS_BIND = type & $export.B;\n  var IS_WRAP = type & $export.W;\n  var exports = IS_GLOBAL ? core : core[name] || (core[name] = {});\n  var expProto = exports[PROTOTYPE];\n  var target = IS_GLOBAL ? global : IS_STATIC ? global[name] : (global[name] || {})[PROTOTYPE];\n  var key, own, out;\n  if (IS_GLOBAL) source = name;\n  for (key in source) {\n    // contains in native\n    own = !IS_FORCED && target && target[key] !== undefined;\n    if (own && has(exports, key)) continue;\n    // export native or passed\n    out = own ? target[key] : source[key];\n    // prevent global pollution for namespaces\n    exports[key] = IS_GLOBAL && typeof target[key] != 'function' ? source[key]\n    // bind timers to global for call from export context\n    : IS_BIND && own ? ctx(out, global)\n    // wrap global constructors for prevent change them in library\n    : IS_WRAP && target[key] == out ? (function (C) {\n      var F = function (a, b, c) {\n        if (this instanceof C) {\n          switch (arguments.length) {\n            case 0: return new C();\n            case 1: return new C(a);\n            case 2: return new C(a, b);\n          } return new C(a, b, c);\n        } return C.apply(this, arguments);\n      };\n      F[PROTOTYPE] = C[PROTOTYPE];\n      return F;\n    // make static versions for prototype methods\n    })(out) : IS_PROTO && typeof out == 'function' ? ctx(Function.call, out) : out;\n    // export proto methods to core.%CONSTRUCTOR%.methods.%NAME%\n    if (IS_PROTO) {\n      (exports.virtual || (exports.virtual = {}))[key] = out;\n      // export proto methods to core.%CONSTRUCTOR%.prototype.%NAME%\n      if (type & $export.R && expProto && !expProto[key]) hide(expProto, key, out);\n    }\n  }\n};\n// type bitmap\n$export.F = 1;   // forced\n$export.G = 2;   // global\n$export.S = 4;   // static\n$export.P = 8;   // proto\n$export.B = 16;  // bind\n$export.W = 32;  // wrap\n$export.U = 64;  // safe\n$export.R = 128; // real proto method for `library`\nmodule.exports = $export;\n\n\n/***/ }),\n\n/***/ 167:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.addBidResponse = exports.AUCTION_COMPLETED = exports.AUCTION_IN_PROGRESS = exports.AUCTION_STARTED = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; /**\n                                                                                                                                                                                                                                                                   * Module for auction instances.\n                                                                                                                                                                                                                                                                   *\n                                                                                                                                                                                                                                                                   * In Prebid 0.x, pbjs had _bidsRequested and _bidsReceived as public properties.\n                                                                                                                                                                                                                                                                   * Starting 1.0, Prebid will support concurrent auctions. Each auction instance will store private properties, bidsRequested and bidsReceived.\n                                                                                                                                                                                                                                                                   *\n                                                                                                                                                                                                                                                                   * AuctionManager will create instance of auction and will store all the auctions.\n                                                                                                                                                                                                                                                                   *\n                                                                                                                                                                                                                                                                   */\n\n/**\n  * @typedef {Object} AdUnit An object containing the adUnit configuration.\n  *\n  * @property {string} code A code which will be used to uniquely identify this bidder. This should be the same\n  *   one as is used in the call to registerBidAdapter\n  * @property {Array.<size>} sizes A list of size for adUnit.\n  * @property {object} params Any bidder-specific params which the publisher used in their bid request.\n  *   This is guaranteed to have passed the spec.areParamsValid() test.\n  */\n\n/**\n * @typedef {Array.<number>} size\n */\n\n/**\n * @typedef {Array.<string>} AdUnitCode\n */\n\n/**\n * @typedef {Object} BidRequest\n * //TODO add all properties\n */\n\n/**\n * @typedef {Object} BidReceived\n * //TODO add all properties\n */\n\n/**\n * @typedef {Object} Auction\n *\n * @property {function(): string} getAuctionStatus - returns the auction status which can be any one of 'started', 'in progress' or 'completed'\n * @property {function(): AdUnit[]} getAdUnits - return the adUnits for this auction instance\n * @property {function(): AdUnitCode[]} getAdUnitCodes - return the adUnitCodes for this auction instance\n * @property {function(): BidRequest[]} getBidRequests - get all bid requests for this auction instance\n * @property {function(): BidReceived[]} getBidsReceived - get all bid received for this auction instance\n * @property {function(): void} startAuctionTimer - sets the bidsBackHandler callback and starts the timer for auction\n * @property {function(): void} callBids - sends requests to all adapters for bids\n */\n\nexports.newAuction = newAuction;\nexports.getStandardBidderSettings = getStandardBidderSettings;\nexports.getKeyValueTargetingPairs = getKeyValueTargetingPairs;\nexports.adjustBids = adjustBids;\n\nvar _utils = __webpack_require__(0);\n\nvar _cpmBucketManager = __webpack_require__(27);\n\nvar _native = __webpack_require__(18);\n\nvar _videoCache = __webpack_require__(168);\n\nvar _Renderer = __webpack_require__(14);\n\nvar _config = __webpack_require__(4);\n\nvar _userSync = __webpack_require__(13);\n\nvar _hook = __webpack_require__(21);\n\nvar _find = __webpack_require__(10);\n\nvar _find2 = _interopRequireDefault(_find);\n\nvar _includes = __webpack_require__(7);\n\nvar _includes2 = _interopRequireDefault(_includes);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar syncUsers = _userSync.userSync.syncUsers;\n\nvar utils = __webpack_require__(0);\nvar adaptermanager = __webpack_require__(8);\nvar events = __webpack_require__(9);\nvar CONSTANTS = __webpack_require__(2);\n\nvar AUCTION_STARTED = exports.AUCTION_STARTED = 'started';\nvar AUCTION_IN_PROGRESS = exports.AUCTION_IN_PROGRESS = 'inProgress';\nvar AUCTION_COMPLETED = exports.AUCTION_COMPLETED = 'completed';\n\n// register event for bid adjustment\nevents.on(CONSTANTS.EVENTS.BID_ADJUSTMENT, function (bid) {\n  adjustBids(bid);\n});\n\n/**\n  * Creates new auction instance\n  *\n  * @param {Object} requestConfig\n  * @param {AdUnit} requestConfig.adUnits\n  * @param {AdUnitCode} requestConfig.adUnitCode\n  *\n  * @returns {Auction} auction instance\n  */\nfunction newAuction(_ref) {\n  var adUnits = _ref.adUnits,\n      adUnitCodes = _ref.adUnitCodes,\n      callback = _ref.callback,\n      cbTimeout = _ref.cbTimeout,\n      labels = _ref.labels;\n\n  var _adUnits = adUnits;\n  var _labels = labels;\n  var _adUnitCodes = adUnitCodes;\n  var _bidderRequests = [];\n  var _bidsReceived = [];\n  var _auctionStart = void 0;\n  var _auctionId = utils.generateUUID();\n  var _auctionStatus = void 0;\n  var _callback = callback;\n  var _timer = void 0;\n  var _timeout = cbTimeout;\n  var _winningBids = [];\n\n  function addBidRequests(bidderRequests) {\n    _bidderRequests = _bidderRequests.concat(bidderRequests);\n  };\n  function addBidReceived(bidsReceived) {\n    _bidsReceived = _bidsReceived.concat(bidsReceived);\n  }\n\n  function startAuctionTimer() {\n    var timedOut = true;\n    var timeoutCallback = executeCallback.bind(null, timedOut);\n    var timer = setTimeout(timeoutCallback, _timeout);\n    _timer = timer;\n  }\n\n  function executeCallback(timedOut, cleartimer) {\n    // clear timer when done calls executeCallback\n    if (cleartimer) {\n      clearTimeout(_timer);\n    }\n\n    if (_callback != null) {\n      var timedOutBidders = [];\n      if (timedOut) {\n        utils.logMessage('Auction ' + _auctionId + ' timedOut');\n        timedOutBidders = getTimedOutBids(_bidderRequests, _bidsReceived);\n        if (timedOutBidders.length) {\n          events.emit(CONSTANTS.EVENTS.BID_TIMEOUT, timedOutBidders);\n        }\n      }\n\n      events.emit(CONSTANTS.EVENTS.AUCTION_END, { auctionId: _auctionId });\n\n      try {\n        _auctionStatus = AUCTION_COMPLETED;\n        var _adUnitCodes2 = _adUnitCodes;\n        var bids = [_bidsReceived.filter(_utils.adUnitsFilter.bind(this, _adUnitCodes2)).reduce(groupByPlacement, {})];\n        _callback.apply(pbjs, bids);\n      } catch (e) {\n        utils.logError('Error executing bidsBackHandler', null, e);\n      } finally {\n        // Calling timed out bidders\n        if (timedOutBidders.length) {\n          adaptermanager.callTimedOutBidders(adUnits, timedOutBidders, _timeout);\n        }\n        // Only automatically sync if the publisher has not chosen to \"enableOverride\"\n        var userSyncConfig = _config.config.getConfig('userSync') || {};\n        if (!userSyncConfig.enableOverride) {\n          // Delay the auto sync by the config delay\n          syncUsers(userSyncConfig.syncDelay);\n        }\n      }\n      _callback = null;\n    }\n  }\n\n  function done(bidRequestId) {\n    var innerBidRequestId = bidRequestId;\n    return (0, _utils.delayExecution)(function () {\n      var request = (0, _find2.default)(_bidderRequests, function (bidRequest) {\n        return innerBidRequestId === bidRequest.bidderRequestId;\n      });\n\n      // this is done for cache-enabled video bids in tryAddVideoBid, after the cache is stored\n      request.doneCbCallCount += 1;\n      bidsBackAll();\n    }, 1);\n  }\n\n  /**\n   * Execute bidBackHandler if all bidders have called done.\n   */\n  function bidsBackAll() {\n    if (_bidderRequests.every(function (bidRequest) {\n      return bidRequest.doneCbCallCount >= 1;\n    })) {\n      // when all bidders have called done callback atleast once it means auction is complete\n      utils.logInfo('Bids Received for Auction with id: ' + _auctionId, _bidsReceived);\n      _auctionStatus = AUCTION_COMPLETED;\n      executeCallback(false, true);\n    }\n  }\n\n  function callBids() {\n    startAuctionTimer();\n    _auctionStatus = AUCTION_STARTED;\n    _auctionStart = Date.now();\n\n    var auctionInit = {\n      timestamp: _auctionStart,\n      auctionId: _auctionId,\n      timeout: _timeout\n    };\n    events.emit(CONSTANTS.EVENTS.AUCTION_INIT, auctionInit);\n\n    var bidRequests = adaptermanager.makeBidRequests(_adUnits, _auctionStart, _auctionId, _timeout, _labels);\n    utils.logInfo('Bids Requested for Auction with id: ' + _auctionId, bidRequests);\n    bidRequests.forEach(function (bidRequest) {\n      addBidRequests(bidRequest);\n    });\n\n    _auctionStatus = AUCTION_IN_PROGRESS;\n    adaptermanager.callBids(_adUnits, bidRequests, addBidResponse.bind(this), done.bind(this));\n  };\n\n  return {\n    addBidReceived: addBidReceived,\n    executeCallback: executeCallback,\n    callBids: callBids,\n    bidsBackAll: bidsBackAll,\n    addWinningBid: function addWinningBid(winningBid) {\n      _winningBids = _winningBids.concat(winningBid);\n    },\n    getWinningBids: function getWinningBids() {\n      return _winningBids;\n    },\n    getTimeout: function getTimeout() {\n      return _timeout;\n    },\n    getAuctionId: function getAuctionId() {\n      return _auctionId;\n    },\n    getAuctionStatus: function getAuctionStatus() {\n      return _auctionStatus;\n    },\n    getAdUnits: function getAdUnits() {\n      return _adUnits;\n    },\n    getAdUnitCodes: function getAdUnitCodes() {\n      return _adUnitCodes;\n    },\n    getBidRequests: function getBidRequests() {\n      return _bidderRequests;\n    },\n    getBidsReceived: function getBidsReceived() {\n      return _bidsReceived;\n    }\n  };\n}\n\nfunction doCallbacksIfTimedout(auctionInstance, bidResponse) {\n  if (bidResponse.timeToRespond > auctionInstance.getTimeout() + _config.config.getConfig('timeoutBuffer')) {\n    auctionInstance.executeCallback(true);\n  }\n}\n\n// Add a bid to the auction.\nfunction addBidToAuction(auctionInstance, bidResponse) {\n  events.emit(CONSTANTS.EVENTS.BID_RESPONSE, bidResponse);\n  auctionInstance.addBidReceived(bidResponse);\n\n  doCallbacksIfTimedout(auctionInstance, bidResponse);\n}\n\n// Video bids may fail if the cache is down, or there's trouble on the network.\nfunction tryAddVideoBid(auctionInstance, bidResponse, bidRequest) {\n  var addBid = true;\n  if (_config.config.getConfig('cache.url')) {\n    if (!bidResponse.videoCacheKey) {\n      addBid = false;\n      (0, _videoCache.store)([bidResponse], function (error, cacheIds) {\n        if (error) {\n          utils.logWarn('Failed to save to the video cache: ' + error + '. Video bid must be discarded.');\n\n          doCallbacksIfTimedout(auctionInstance, bidResponse);\n        } else {\n          bidResponse.videoCacheKey = cacheIds[0].uuid;\n          if (!bidResponse.vastUrl) {\n            bidResponse.vastUrl = (0, _videoCache.getCacheUrl)(bidResponse.videoCacheKey);\n          }\n          // only set this prop after the bid has been cached to avoid early ending auction early in bidsBackAll\n          bidRequest.doneCbCallCount += 1;\n          addBidToAuction(auctionInstance, bidResponse);\n          auctionInstance.bidsBackAll();\n        }\n      });\n    } else if (!bidResponse.vastUrl) {\n      utils.logError('videoCacheKey specified but not required vastUrl for video bid');\n      addBid = false;\n    }\n  }\n  if (addBid) {\n    addBidToAuction(auctionInstance, bidResponse);\n  }\n}\n\nvar addBidResponse = exports.addBidResponse = (0, _hook.createHook)('asyncSeries', function (adUnitCode, bid) {\n  var auctionInstance = this;\n  var bidRequests = auctionInstance.getBidRequests();\n  var auctionId = auctionInstance.getAuctionId();\n\n  var bidRequest = (0, _utils.getBidderRequest)(bidRequests, bid.bidderCode, adUnitCode);\n  var bidResponse = getPreparedBidForAuction({ adUnitCode: adUnitCode, bid: bid, bidRequest: bidRequest, auctionId: auctionId });\n\n  if (bidResponse.mediaType === 'video') {\n    tryAddVideoBid(auctionInstance, bidResponse, bidRequest);\n  } else {\n    addBidToAuction(auctionInstance, bidResponse);\n  }\n}, 'addBidResponse');\n\n// Postprocess the bids so that all the universal properties exist, no matter which bidder they came from.\n// This should be called before addBidToAuction().\nfunction getPreparedBidForAuction(_ref2) {\n  var adUnitCode = _ref2.adUnitCode,\n      bid = _ref2.bid,\n      bidRequest = _ref2.bidRequest,\n      auctionId = _ref2.auctionId;\n\n  var start = bidRequest.start;\n\n  var bidObject = _extends({}, bid, {\n    auctionId: auctionId,\n    responseTimestamp: (0, _utils.timestamp)(),\n    requestTimestamp: start,\n    cpm: parseFloat(bid.cpm) || 0,\n    bidder: bid.bidderCode,\n    adUnitCode: adUnitCode\n  });\n\n  bidObject.timeToRespond = bidObject.responseTimestamp - bidObject.requestTimestamp;\n\n  // Let listeners know that now is the time to adjust the bid, if they want to.\n  //\n  // CAREFUL: Publishers rely on certain bid properties to be available (like cpm),\n  // but others to not be set yet (like priceStrings). See #1372 and #1389.\n  events.emit(CONSTANTS.EVENTS.BID_ADJUSTMENT, bidObject);\n\n  // a publisher-defined renderer can be used to render bids\n  var bidReq = bidRequest.bids && (0, _find2.default)(bidRequest.bids, function (bid) {\n    return bid.adUnitCode == adUnitCode;\n  });\n  var adUnitRenderer = bidReq && bidReq.renderer;\n\n  if (adUnitRenderer && adUnitRenderer.url) {\n    bidObject.renderer = _Renderer.Renderer.install({ url: adUnitRenderer.url });\n    bidObject.renderer.setRender(adUnitRenderer.render);\n  }\n\n  var priceStringsObj = (0, _cpmBucketManager.getPriceBucketString)(bidObject.cpm, _config.config.getConfig('customPriceBucket'), _config.config.getConfig('currency.granularityMultiplier'));\n  bidObject.pbLg = priceStringsObj.low;\n  bidObject.pbMg = priceStringsObj.med;\n  bidObject.pbHg = priceStringsObj.high;\n  bidObject.pbAg = priceStringsObj.auto;\n  bidObject.pbDg = priceStringsObj.dense;\n  bidObject.pbCg = priceStringsObj.custom;\n\n  // if there is any key value pairs to map do here\n  var keyValues;\n  if (bidObject.bidderCode && (bidObject.cpm > 0 || bidObject.dealId)) {\n    keyValues = getKeyValueTargetingPairs(bidObject.bidderCode, bidObject);\n  }\n\n  // use any targeting provided as defaults, otherwise just set from getKeyValueTargetingPairs\n  bidObject.adserverTargeting = _extends(bidObject.adserverTargeting || {}, keyValues);\n\n  return bidObject;\n}\n\nfunction getStandardBidderSettings() {\n  var granularity = _config.config.getConfig('priceGranularity');\n  var bidder_settings = pbjs.bidderSettings;\n  if (!bidder_settings[CONSTANTS.JSON_MAPPING.BD_SETTING_STANDARD]) {\n    bidder_settings[CONSTANTS.JSON_MAPPING.BD_SETTING_STANDARD] = {};\n  }\n  if (!bidder_settings[CONSTANTS.JSON_MAPPING.BD_SETTING_STANDARD][CONSTANTS.JSON_MAPPING.ADSERVER_TARGETING]) {\n    bidder_settings[CONSTANTS.JSON_MAPPING.BD_SETTING_STANDARD][CONSTANTS.JSON_MAPPING.ADSERVER_TARGETING] = [{\n      key: 'hb_bidder',\n      val: function val(bidResponse) {\n        return bidResponse.bidderCode;\n      }\n    }, {\n      key: 'hb_adid',\n      val: function val(bidResponse) {\n        return bidResponse.adId;\n      }\n    }, {\n      key: 'hb_pb',\n      val: function val(bidResponse) {\n        if (granularity === CONSTANTS.GRANULARITY_OPTIONS.AUTO) {\n          return bidResponse.pbAg;\n        } else if (granularity === CONSTANTS.GRANULARITY_OPTIONS.DENSE) {\n          return bidResponse.pbDg;\n        } else if (granularity === CONSTANTS.GRANULARITY_OPTIONS.LOW) {\n          return bidResponse.pbLg;\n        } else if (granularity === CONSTANTS.GRANULARITY_OPTIONS.MEDIUM) {\n          return bidResponse.pbMg;\n        } else if (granularity === CONSTANTS.GRANULARITY_OPTIONS.HIGH) {\n          return bidResponse.pbHg;\n        } else if (granularity === CONSTANTS.GRANULARITY_OPTIONS.CUSTOM) {\n          return bidResponse.pbCg;\n        }\n      }\n    }, {\n      key: 'hb_size',\n      val: function val(bidResponse) {\n        return bidResponse.size;\n      }\n    }, {\n      key: 'hb_deal',\n      val: function val(bidResponse) {\n        return bidResponse.dealId;\n      }\n    }, {\n      key: 'hb_source',\n      val: function val(bidResponse) {\n        return bidResponse.source;\n      }\n    }, {\n      key: 'hb_format',\n      val: function val(bidResponse) {\n        return bidResponse.mediaType;\n      }\n    }];\n  }\n  return bidder_settings[CONSTANTS.JSON_MAPPING.BD_SETTING_STANDARD];\n}\n\nfunction getKeyValueTargetingPairs(bidderCode, custBidObj) {\n  if (!custBidObj) {\n    return {};\n  }\n\n  var keyValues = {};\n  var bidder_settings = pbjs.bidderSettings;\n\n  // 1) set the keys from \"standard\" setting or from prebid defaults\n  if (bidder_settings) {\n    // initialize default if not set\n    var standardSettings = getStandardBidderSettings();\n    setKeys(keyValues, standardSettings, custBidObj);\n\n    // 2) set keys from specific bidder setting override if they exist\n    if (bidderCode && bidder_settings[bidderCode] && bidder_settings[bidderCode][CONSTANTS.JSON_MAPPING.ADSERVER_TARGETING]) {\n      setKeys(keyValues, bidder_settings[bidderCode], custBidObj);\n      custBidObj.sendStandardTargeting = bidder_settings[bidderCode].sendStandardTargeting;\n    }\n  }\n\n  // set native key value targeting\n  if (custBidObj['native']) {\n    keyValues = _extends({}, keyValues, (0, _native.getNativeTargeting)(custBidObj));\n  }\n\n  return keyValues;\n}\n\nfunction setKeys(keyValues, bidderSettings, custBidObj) {\n  var targeting = bidderSettings[CONSTANTS.JSON_MAPPING.ADSERVER_TARGETING];\n  custBidObj.size = custBidObj.getSize();\n\n  utils._each(targeting, function (kvPair) {\n    var key = kvPair.key;\n    var value = kvPair.val;\n\n    if (keyValues[key]) {\n      utils.logWarn('The key: ' + key + ' is getting ovewritten');\n    }\n\n    if (utils.isFn(value)) {\n      try {\n        value = value(custBidObj);\n      } catch (e) {\n        utils.logError('bidmanager', 'ERROR', e);\n      }\n    }\n\n    if ((typeof bidderSettings.suppressEmptyKeys !== 'undefined' && bidderSettings.suppressEmptyKeys === true || key === 'hb_deal') && ( // hb_deal is suppressed automatically if not set\n    utils.isEmptyStr(value) || value === null || value === undefined)) {\n      utils.logInfo(\"suppressing empty key '\" + key + \"' from adserver targeting\");\n    } else {\n      keyValues[key] = value;\n    }\n  });\n\n  return keyValues;\n}\n\nfunction adjustBids(bid) {\n  var code = bid.bidderCode;\n  var bidPriceAdjusted = bid.cpm;\n  var bidCpmAdjustment = void 0;\n  if (pbjs.bidderSettings) {\n    if (code && pbjs.bidderSettings[code] && typeof pbjs.bidderSettings[code].bidCpmAdjustment === 'function') {\n      bidCpmAdjustment = pbjs.bidderSettings[code].bidCpmAdjustment;\n    } else if (pbjs.bidderSettings[CONSTANTS.JSON_MAPPING.BD_SETTING_STANDARD] && typeof pbjs.bidderSettings[CONSTANTS.JSON_MAPPING.BD_SETTING_STANDARD].bidCpmAdjustment === 'function') {\n      bidCpmAdjustment = pbjs.bidderSettings[CONSTANTS.JSON_MAPPING.BD_SETTING_STANDARD].bidCpmAdjustment;\n    }\n    if (bidCpmAdjustment) {\n      try {\n        bidPriceAdjusted = bidCpmAdjustment(bid.cpm, _extends({}, bid));\n      } catch (e) {\n        utils.logError('Error during bid adjustment', 'bidmanager.js', e);\n      }\n    }\n  }\n\n  if (bidPriceAdjusted >= 0) {\n    bid.cpm = bidPriceAdjusted;\n  }\n}\n\n/**\n * groupByPlacement is a reduce function that converts an array of Bid objects\n * to an object with placement codes as keys, with each key representing an object\n * with an array of `Bid` objects for that placement\n * @returns {*} as { [adUnitCode]: { bids: [Bid, Bid, Bid] } }\n */\nfunction groupByPlacement(bidsByPlacement, bid) {\n  if (!bidsByPlacement[bid.adUnitCode]) {\n    bidsByPlacement[bid.adUnitCode] = { bids: [] };\n  }\n  bidsByPlacement[bid.adUnitCode].bids.push(bid);\n  return bidsByPlacement;\n}\n\n/**\n * Returns a list of bids that we haven't received a response yet where the bidder did not call done\n * @param {BidRequest[]} bidderRequests List of bids requested for auction instance\n * @param {BidReceived[]} bidsReceived List of bids received for auction instance\n *\n * @typedef {Object} TimedOutBid\n * @property {string} bidId The id representing the bid\n * @property {string} bidder The string name of the bidder\n * @property {string} adUnitCode The code used to uniquely identify the ad unit on the publisher's page\n * @property {string} auctionId The id representing the auction\n *\n * @return {Array<TimedOutBid>} List of bids that Prebid hasn't received a response for\n */\nfunction getTimedOutBids(bidderRequests, bidsReceived) {\n  var bidRequestedWithoutDoneCodes = bidderRequests.filter(function (bidderRequest) {\n    return !bidderRequest.doneCbCallCount;\n  }).map(function (bid) {\n    return bid.bidderCode;\n  }).filter(_utils.uniques);\n\n  var bidReceivedCodes = bidsReceived.map(function (bid) {\n    return bid.bidder;\n  }).filter(_utils.uniques);\n\n  var timedOutBidderCodes = bidRequestedWithoutDoneCodes.filter(function (bidder) {\n    return !(0, _includes2.default)(bidReceivedCodes, bidder);\n  });\n\n  var timedOutBids = bidderRequests.map(function (bid) {\n    return (bid.bids || []).filter(function (bid) {\n      return (0, _includes2.default)(timedOutBidderCodes, bid.bidder);\n    });\n  }).reduce(_utils.flatten, []).map(function (bid) {\n    return {\n      bidId: bid.bidId,\n      bidder: bid.bidder,\n      adUnitCode: bid.adUnitCode,\n      auctionId: bid.auctionId\n    };\n  });\n\n  return timedOutBids;\n}\n\n/***/ }),\n\n/***/ 168:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.store = store;\nexports.getCacheUrl = getCacheUrl;\n\nvar _ajax = __webpack_require__(6);\n\nvar _config = __webpack_require__(4);\n\n/**\n * @typedef {object} CacheableUrlBid\n * @property {string} vastUrl A URL which loads some valid VAST XML.\n */\n\n/**\n * @typedef {object} CacheablePayloadBid\n * @property {string} vastXml Some VAST XML which loads an ad in a video player.\n */\n\n/**\n * A CacheableBid describes the types which the videoCache can store.\n *\n * @typedef {CacheableUrlBid|CacheablePayloadBid} CacheableBid\n */\n\n/**\n * Function which wraps a URI that serves VAST XML, so that it can be loaded.\n *\n * @param {string} uri The URI where the VAST content can be found.\n * @param {string} impUrl An impression tracker URL for the delivery of the video ad\n * @return A VAST URL which loads XML from the given URI.\n */\n/**\n * This module interacts with the server used to cache video ad content to be restored later.\n * At a high level, the expected workflow goes like this:\n *\n *   - Request video ads from Bidders\n *   - Generate IDs for each valid bid, and cache the key/value pair on the server.\n *   - Return these IDs so that publishers can use them to fetch the bids later.\n *\n * This trickery helps integrate with ad servers, which set character limits on request params.\n */\n\nfunction wrapURI(uri, impUrl) {\n  // Technically, this is vulnerable to cross-script injection by sketchy vastUrl bids.\n  // We could make sure it's a valid URI... but since we're loading VAST XML from the\n  // URL they provide anyway, that's probably not a big deal.\n  var vastImp = impUrl ? '<![CDATA[' + impUrl + ']]>' : '';\n  return '<VAST version=\"3.0\">\\n    <Ad>\\n      <Wrapper>\\n        <AdSystem>prebid.org wrapper</AdSystem>\\n        <VASTAdTagURI><![CDATA[' + uri + ']]></VASTAdTagURI>\\n        <Impression>' + vastImp + '</Impression>\\n        <Creatives></Creatives>\\n      </Wrapper>\\n    </Ad>\\n  </VAST>';\n}\n\n/**\n * Wraps a bid in the format expected by the prebid-server endpoints, or returns null if\n * the bid can't be converted cleanly.\n *\n * @param {CacheableBid} bid\n */\nfunction toStorageRequest(bid) {\n  var vastValue = bid.vastXml ? bid.vastXml : wrapURI(bid.vastUrl, bid.vastImpUrl);\n  return {\n    type: 'xml',\n    value: vastValue\n  };\n}\n\n/**\n * A function which should be called with the results of the storage operation.\n *\n * @callback videoCacheStoreCallback\n *\n * @param {Error} [error] The error, if one occurred.\n * @param {?string[]} uuids An array of unique IDs. The array will have one element for each bid we were asked\n *   to store. It may include null elements if some of the bids were malformed, or an error occurred.\n *   Each non-null element in this array is a valid input into the retrieve function, which will fetch\n *   some VAST XML which can be used to render this bid's ad.\n */\n\n/**\n * A function which bridges the APIs between the videoCacheStoreCallback and our ajax function's API.\n *\n * @param {videoCacheStoreCallback} done A callback to the \"store\" function.\n * @return {Function} A callback which interprets the cache server's responses, and makes up the right\n *   arguments for our callback.\n */\nfunction shimStorageCallback(done) {\n  return {\n    success: function success(responseBody) {\n      var ids = void 0;\n      try {\n        ids = JSON.parse(responseBody).responses;\n      } catch (e) {\n        done(e, []);\n        return;\n      }\n\n      if (ids) {\n        done(null, ids);\n      } else {\n        done(new Error(\"The cache server didn't respond with a responses property.\"), []);\n      }\n    },\n    error: function error(statusText, responseBody) {\n      done(new Error('Error storing video ad in the cache: ' + statusText + ': ' + JSON.stringify(responseBody)), []);\n    }\n  };\n}\n\n/**\n * If the given bid is for a Video ad, generate a unique ID and cache it somewhere server-side.\n *\n * @param {CacheableBid[]} bids A list of bid objects which should be cached.\n * @param {videoCacheStoreCallback} [done] An optional callback which should be executed after\n *   the data has been stored in the cache.\n */\nfunction store(bids, done) {\n  var requestData = {\n    puts: bids.map(toStorageRequest)\n  };\n\n  (0, _ajax.ajax)(_config.config.getConfig('cache.url'), shimStorageCallback(done), JSON.stringify(requestData), {\n    contentType: 'text/plain',\n    withCredentials: true\n  });\n}\n\nfunction getCacheUrl(id) {\n  return _config.config.getConfig('cache.url') + '?uuid=' + id;\n}\n\n/***/ }),\n\n/***/ 17:\n/***/ (function(module, exports) {\n\nmodule.exports = function (it) {\n  return typeof it === 'object' ? it !== null : typeof it === 'function';\n};\n\n\n/***/ }),\n\n/***/ 18:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.hasNonNativeBidder = exports.nativeBidder = exports.nativeAdUnit = exports.NATIVE_TARGETING_KEYS = exports.NATIVE_KEYS = exports.nativeAdapters = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.processNativeAdUnitParams = processNativeAdUnitParams;\nexports.nativeBidIsValid = nativeBidIsValid;\nexports.fireNativeTrackers = fireNativeTrackers;\nexports.getNativeTargeting = getNativeTargeting;\n\nvar _utils = __webpack_require__(0);\n\nvar _includes = __webpack_require__(7);\n\nvar _includes2 = _interopRequireDefault(_includes);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar nativeAdapters = exports.nativeAdapters = [];\n\nvar NATIVE_KEYS = exports.NATIVE_KEYS = {\n  title: 'hb_native_title',\n  body: 'hb_native_body',\n  sponsoredBy: 'hb_native_brand',\n  image: 'hb_native_image',\n  icon: 'hb_native_icon',\n  clickUrl: 'hb_native_linkurl',\n  cta: 'hb_native_cta'\n};\n\nvar NATIVE_TARGETING_KEYS = exports.NATIVE_TARGETING_KEYS = Object.keys(NATIVE_KEYS).map(function (key) {\n  return NATIVE_KEYS[key];\n});\n\nvar IMAGE = {\n  image: { required: true },\n  title: { required: true },\n  sponsoredBy: { required: true },\n  clickUrl: { required: true },\n  body: { required: false },\n  icon: { required: false }\n};\n\nvar SUPPORTED_TYPES = {\n  image: IMAGE\n};\n\n/**\n * Recieves nativeParams from an adUnit. If the params were not of type 'type',\n * passes them on directly. If they were of type 'type', translate\n * them into the predefined specific asset requests for that type of native ad.\n */\nfunction processNativeAdUnitParams(params) {\n  if (params && params.type && typeIsSupported(params.type)) {\n    return SUPPORTED_TYPES[params.type];\n  }\n\n  return params;\n}\n\n/**\n * Check if the native type specified in the adUnit is supported by Prebid.\n */\nfunction typeIsSupported(type) {\n  if (!(type && (0, _includes2.default)(Object.keys(SUPPORTED_TYPES), type))) {\n    (0, _utils.logError)(type + ' nativeParam is not supported');\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Helper functions for working with native-enabled adUnits\n * TODO: abstract this and the video helper functions into general\n * adunit validation helper functions\n */\nvar nativeAdUnit = exports.nativeAdUnit = function nativeAdUnit(adUnit) {\n  var mediaType = adUnit.mediaType === 'native';\n  var mediaTypes = (0, _utils.deepAccess)(adUnit, 'mediaTypes.native');\n  return mediaType || mediaTypes;\n};\nvar nativeBidder = exports.nativeBidder = function nativeBidder(bid) {\n  return (0, _includes2.default)(nativeAdapters, bid.bidder);\n};\nvar hasNonNativeBidder = exports.hasNonNativeBidder = function hasNonNativeBidder(adUnit) {\n  return adUnit.bids.filter(function (bid) {\n    return !nativeBidder(bid);\n  }).length;\n};\n\n/**\n * Validate that the native assets on this bid contain all assets that were\n * marked as required in the adUnit configuration.\n * @param {Bid} bid Native bid to validate\n * @param {BidRequest[]} bidRequests All bid requests for an auction\n * @return {Boolean} If object is valid\n */\nfunction nativeBidIsValid(bid, bidRequests) {\n  var bidRequest = (0, _utils.getBidRequest)(bid.adId, bidRequests);\n  if (!bidRequest) {\n    return false;\n  }\n\n  // all native bid responses must define a landing page url\n  if (!(0, _utils.deepAccess)(bid, 'native.clickUrl')) {\n    return false;\n  }\n\n  if ((0, _utils.deepAccess)(bid, 'native.image')) {\n    if (!(0, _utils.deepAccess)(bid, 'native.image.height') || !(0, _utils.deepAccess)(bid, 'native.image.width')) {\n      return false;\n    }\n  }\n\n  if ((0, _utils.deepAccess)(bid, 'native.icon')) {\n    if (!(0, _utils.deepAccess)(bid, 'native.icon.height') || !(0, _utils.deepAccess)(bid, 'native.icon.width')) {\n      return false;\n    }\n  }\n\n  var requestedAssets = bidRequest.nativeParams;\n  if (!requestedAssets) {\n    return true;\n  }\n\n  var requiredAssets = Object.keys(requestedAssets).filter(function (key) {\n    return requestedAssets[key].required;\n  });\n  var returnedAssets = Object.keys(bid['native']).filter(function (key) {\n    return bid['native'][key];\n  });\n\n  return requiredAssets.every(function (asset) {\n    return (0, _includes2.default)(returnedAssets, asset);\n  });\n}\n\n/*\n * Native responses may have associated impression or click trackers.\n * This retrieves the appropriate tracker urls for the given ad object and\n * fires them. As a native creatives may be in a cross-origin frame, it may be\n * necessary to invoke this function via postMessage. secureCreatives is\n * configured to fire this function when it receives a `message` of 'Prebid Native'\n * and an `adId` with the value of the `bid.adId`. When a message is posted with\n * these parameters, impression trackers are fired. To fire click trackers, the\n * message should contain an `action` set to 'click'.\n *\n * // Native creative template example usage\n * <a href=\"%%CLICK_URL_UNESC%%%%PATTERN:hb_native_linkurl%%\"\n *    target=\"_blank\"\n *    onclick=\"fireTrackers('click')\">\n *    %%PATTERN:hb_native_title%%\n * </a>\n *\n * <script>\n *   function fireTrackers(action) {\n *     var message = {message: 'Prebid Native', adId: '%%PATTERN:hb_adid%%'};\n *     if (action === 'click') {message.action = 'click';} // fires click trackers\n *     window.parent.postMessage(JSON.stringify(message), '*');\n *   }\n *   fireTrackers(); // fires impressions when creative is loaded\n * </script>\n */\nfunction fireNativeTrackers(message, adObject) {\n  var trackers = void 0;\n\n  if (message.action === 'click') {\n    trackers = adObject['native'] && adObject['native'].clickTrackers;\n  } else {\n    trackers = adObject['native'] && adObject['native'].impressionTrackers;\n\n    if (adObject['native'] && adObject['native'].javascriptTrackers) {\n      (0, _utils.insertHtmlIntoIframe)(adObject['native'].javascriptTrackers);\n    }\n  }\n\n  (trackers || []).forEach(_utils.triggerPixel);\n}\n\n/**\n * Gets native targeting key-value paris\n * @param {Object} bid\n * @return {Object} targeting\n */\nfunction getNativeTargeting(bid) {\n  var keyValues = {};\n\n  Object.keys(bid['native']).forEach(function (asset) {\n    var key = NATIVE_KEYS[asset];\n    var value = bid['native'][asset];\n\n    // native image-type assets can be a string or an object with a url prop\n    if ((typeof value === 'undefined' ? 'undefined' : _typeof(value)) === 'object' && value.url) {\n      value = value.url;\n    }\n\n    if (key) {\n      keyValues[key] = value;\n    }\n  });\n\n  return keyValues;\n}\n\n/***/ }),\n\n/***/ 19:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar utils = __webpack_require__(0);\n\n/**\n Required paramaters\n bidderCode,\n height,\n width,\n statusCode\n Optional paramaters\n adId,\n cpm,\n ad,\n adUrl,\n dealId,\n priceKeyString;\n */\nfunction Bid(statusCode, bidRequest) {\n  var _bidId = bidRequest && bidRequest.bidId || utils.getUniqueIdentifierStr();\n  var _bidSrc = bidRequest && bidRequest.src || 'client';\n  var _statusCode = statusCode || 0;\n\n  this.bidderCode = bidRequest && bidRequest.bidder || '';\n  this.width = 0;\n  this.height = 0;\n  this.statusMessage = _getStatus();\n  this.adId = _bidId;\n  this.mediaType = 'banner';\n  this.source = _bidSrc;\n\n  function _getStatus() {\n    switch (_statusCode) {\n      case 0:\n        return 'Pending';\n      case 1:\n        return 'Bid available';\n      case 2:\n        return 'Bid returned empty or error response';\n      case 3:\n        return 'Bid timed out';\n    }\n  }\n\n  this.getStatusCode = function () {\n    return _statusCode;\n  };\n\n  // returns the size of the bid creative. Concatenation of width and height by ‘x’.\n  this.getSize = function () {\n    return this.width + 'x' + this.height;\n  };\n}\n\n// Bid factory function.\nexports.createBid = function (statusCode, bidRequest) {\n  return new Bid(statusCode, bidRequest);\n};\n\n/***/ }),\n\n/***/ 2:\n/***/ (function(module, exports) {\n\nmodule.exports = {\"JSON_MAPPING\":{\"PL_CODE\":\"code\",\"PL_SIZE\":\"sizes\",\"PL_BIDS\":\"bids\",\"BD_BIDDER\":\"bidder\",\"BD_ID\":\"paramsd\",\"BD_PL_ID\":\"placementId\",\"ADSERVER_TARGETING\":\"adserverTargeting\",\"BD_SETTING_STANDARD\":\"standard\"},\"REPO_AND_VERSION\":\"Wikia_prebid_1.11.0\",\"DEBUG_MODE\":\"pbjs_debug\",\"STATUS\":{\"GOOD\":1,\"NO_BID\":2},\"CB\":{\"TYPE\":{\"ALL_BIDS_BACK\":\"allRequestedBidsBack\",\"AD_UNIT_BIDS_BACK\":\"adUnitBidsBack\",\"BID_WON\":\"bidWon\",\"REQUEST_BIDS\":\"requestBids\"}},\"EVENTS\":{\"AUCTION_INIT\":\"auctionInit\",\"AUCTION_END\":\"auctionEnd\",\"BID_ADJUSTMENT\":\"bidAdjustment\",\"BID_TIMEOUT\":\"bidTimeout\",\"BID_REQUESTED\":\"bidRequested\",\"BID_RESPONSE\":\"bidResponse\",\"BID_WON\":\"bidWon\",\"BIDDER_DONE\":\"bidderDone\",\"SET_TARGETING\":\"setTargeting\",\"REQUEST_BIDS\":\"requestBids\",\"ADD_AD_UNITS\":\"addAdUnits\",\"AD_RENDER_FAILED\":\"adRenderFailed\"},\"AD_RENDER_FAILED_REASON\":{\"PREVENT_WRITING_ON_MAIN_DOCUMENT\":\"preventWritingOnMainDocuemnt\",\"NO_AD\":\"noAd\",\"EXCEPTION\":\"exception\",\"CANNOT_FIND_AD\":\"cannotFindAd\",\"MISSING_DOC_OR_ADID\":\"missingDocOrAdid\"},\"EVENT_ID_PATHS\":{\"bidWon\":\"adUnitCode\"},\"GRANULARITY_OPTIONS\":{\"LOW\":\"low\",\"MEDIUM\":\"medium\",\"HIGH\":\"high\",\"AUTO\":\"auto\",\"DENSE\":\"dense\",\"CUSTOM\":\"custom\"},\"TARGETING_KEYS\":[\"hb_bidder\",\"hb_adid\",\"hb_pb\",\"hb_size\",\"hb_deal\",\"hb_source\",\"hb_format\"],\"S2S\":{\"SRC\":\"s2s\",\"SYNCED_BIDDERS_KEY\":\"pbjsSyncs\"}}\n\n/***/ }),\n\n/***/ 20:\n/***/ (function(module, exports) {\n\n// https://github.com/zloirock/core-js/issues/86#issuecomment-115759028\nvar global = module.exports = typeof window != 'undefined' && window.Math == Math\n  ? window : typeof self != 'undefined' && self.Math == Math ? self\n  // eslint-disable-next-line no-new-func\n  : Function('return this')();\nif (typeof __g == 'number') __g = global; // eslint-disable-line no-undef\n\n\n/***/ }),\n\n/***/ 21:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.createHook = createHook;\n\n/**\n * @typedef {function} HookedFunction\n * @property {function(function(), [number])} addHook A method that takes a new function to attach as a hook\n *  to the HookedFunction\n * @property {function(function())} removeHook A method to remove attached hooks\n */\n\n/**\n * A map of global hook methods to allow easy extension of hooked functions that are intended to be extended globally\n * @type {{}}\n */\nvar hooks = exports.hooks = {};\n\n/**\n * A utility function for allowing a regular function to be extensible with additional hook functions\n * @param {string} type The method for applying all attached hooks when this hooked function is called\n * @param {function()} fn The function to make hookable\n * @param {string} hookName If provided this allows you to register a name for a global hook to have easy access to\n *  the addHook and removeHook methods for that hook (which are usually accessed as methods on the function itself)\n * @returns {HookedFunction} A new function that implements the HookedFunction interface\n */\nfunction createHook(type, fn, hookName) {\n  var _hooks = [{ fn: fn, priority: 0 }];\n\n  var types = {\n    sync: function sync() {\n      var _this = this;\n\n      for (var _len = arguments.length, args = Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      _hooks.forEach(function (hook) {\n        hook.fn.apply(_this, args);\n      });\n    },\n    asyncSeries: function asyncSeries() {\n      var _this2 = this;\n\n      for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      var curr = 0;\n\n      var asyncSeriesNext = function asyncSeriesNext() {\n        for (var _len3 = arguments.length, args = Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n          args[_key3] = arguments[_key3];\n        }\n\n        var hook = _hooks[++curr];\n        if ((typeof hook === 'undefined' ? 'undefined' : _typeof(hook)) === 'object' && typeof hook.fn === 'function') {\n          return hook.fn.apply(_this2, args.concat(asyncSeriesNext));\n        }\n      };\n\n      return _hooks[curr].fn.apply(this, args.concat(asyncSeriesNext));\n    }\n  };\n\n  if (!types[type]) {\n    throw 'invalid hook type';\n  }\n\n  var methods = {\n    addHook: function addHook(fn) {\n      var priority = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 10;\n\n      if (typeof fn === 'function') {\n        _hooks.push({\n          fn: fn,\n          priority: priority\n        });\n\n        _hooks.sort(function (a, b) {\n          return b.priority - a.priority;\n        });\n      }\n    },\n    removeHook: function removeHook(removeFn) {\n      _hooks = _hooks.filter(function (hook) {\n        return hook.fn === fn || hook.fn !== removeFn;\n      });\n    }\n  };\n\n  if (typeof hookName === 'string') {\n    hooks[hookName] = methods;\n  }\n\n  function hookedFn() {\n    for (var _len4 = arguments.length, args = Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n      args[_key4] = arguments[_key4];\n    }\n\n    if (_hooks.length === 1 && _hooks[0].fn === fn) {\n      return fn.apply(this, args);\n    }\n    return types[type].apply(this, args);\n  }\n\n  return _extends(hookedFn, methods);\n}\n\n/***/ }),\n\n/***/ 22:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(101);\nmodule.exports = __webpack_require__(15).Array.findIndex;\n\n\n/***/ }),\n\n/***/ 23:\n/***/ (function(module, exports, __webpack_require__) {\n\n// Thank's IE8 for his funny defineProperty\nmodule.exports = !__webpack_require__(29)(function () {\n  return Object.defineProperty({}, 'a', { get: function () { return 7; } }).a != 7;\n});\n\n\n/***/ }),\n\n/***/ 24:\n/***/ (function(module, exports) {\n\nmodule.exports = function () { /* empty */ };\n\n\n/***/ }),\n\n/***/ 25:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = Adapter;\nfunction Adapter(code) {\n  var bidderCode = code;\n\n  function setBidderCode(code) {\n    bidderCode = code;\n  }\n\n  function getBidderCode() {\n    return bidderCode;\n  }\n\n  function callBids() {}\n\n  return {\n    callBids: callBids,\n    setBidderCode: setBidderCode,\n    getBidderCode: getBidderCode\n  };\n}\n\n/***/ }),\n\n/***/ 26:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.auctionManager = undefined;\nexports.newAuctionManager = newAuctionManager;\n\nvar _utils = __webpack_require__(0);\n\nvar _auction = __webpack_require__(167);\n\nvar _find = __webpack_require__(10);\n\nvar _find2 = _interopRequireDefault(_find);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar CONSTANTS = __webpack_require__(2);\n\n/**\n * Creates new instance of auctionManager. There will only be one instance of auctionManager but\n * a factory is created to assist in testing.\n *\n * @returns {AuctionManager} auctionManagerInstance\n */\n/**\n * AuctionManager modules is responsible for creating auction instances.\n * This module is the gateway for Prebid core to access auctions.\n * It stores all created instances of auction and can be used to get consolidated values from auction.\n */\n\n/**\n * @typedef {Object} AuctionManager\n *\n * @property {function(): Array} getBidsRequested - returns consolidated bid requests\n * @property {function(): Array} getBidsReceived - returns consolidated bid received\n * @property {function(): Array} getAdUnits - returns consolidated adUnits\n * @property {function(): Array} getAdUnitCodes - returns consolidated adUnitCodes\n * @property {function(): Object} createAuction - creates auction instance and stores it for future reference\n * @property {function(): Object} findBidByAdId - find bid received by adId. This function will be called by pbjs.renderAd\n * @property {function(): Object} getStandardBidderAdServerTargeting - returns standard bidder targeting for all the adapters. Refer http://prebid.org/dev-docs/publisher-api-reference.html#module_pbjs.bidderSettings for more details\n */\n\nfunction newAuctionManager() {\n  var _auctions = [];\n  var auctionManager = {};\n\n  auctionManager.addWinningBid = function (bid) {\n    var auction = (0, _find2.default)(_auctions, function (auction) {\n      return auction.getAuctionId() === bid.auctionId;\n    });\n    if (auction) {\n      auction.addWinningBid(bid);\n    } else {\n      utils.logWarn('Auction not found when adding winning bid');\n    }\n  };\n\n  auctionManager.getAllWinningBids = function () {\n    return _auctions.map(function (auction) {\n      return auction.getWinningBids();\n    }).reduce(_utils.flatten, []);\n  };\n\n  auctionManager.getBidsRequested = function () {\n    return _auctions.map(function (auction) {\n      return auction.getBidRequests();\n    }).reduce(_utils.flatten, []);\n  };\n\n  auctionManager.getBidsReceived = function () {\n    // As of now, an old bid which is not used in auction 1 can be used in auction n.\n    // To prevent this, bid.ttl (time to live) will be added to this logic and bid pool will also be added\n    // As of now none of the adapters are sending back bid.ttl\n    return _auctions.map(function (auction) {\n      if (auction.getAuctionStatus() === _auction.AUCTION_COMPLETED) {\n        return auction.getBidsReceived();\n      }\n    }).reduce(_utils.flatten, []).filter(function (bid) {\n      return bid;\n    });\n  };\n\n  auctionManager.getAdUnits = function () {\n    return _auctions.map(function (auction) {\n      return auction.getAdUnits();\n    }).reduce(_utils.flatten, []);\n  };\n\n  auctionManager.getAdUnitCodes = function () {\n    return _auctions.map(function (auction) {\n      return auction.getAdUnitCodes();\n    }).reduce(_utils.flatten, []).filter(_utils.uniques);\n  };\n\n  auctionManager.createAuction = function (_ref) {\n    var adUnits = _ref.adUnits,\n        adUnitCodes = _ref.adUnitCodes,\n        callback = _ref.callback,\n        cbTimeout = _ref.cbTimeout,\n        labels = _ref.labels;\n\n    var auction = (0, _auction.newAuction)({ adUnits: adUnits, adUnitCodes: adUnitCodes, callback: callback, cbTimeout: cbTimeout, labels: labels });\n    _addAuction(auction);\n    return auction;\n  };\n\n  auctionManager.findBidByAdId = function (adId) {\n    return (0, _find2.default)(_auctions.map(function (auction) {\n      return auction.getBidsReceived();\n    }).reduce(_utils.flatten, []), function (bid) {\n      return bid.adId === adId;\n    });\n  };\n\n  auctionManager.getStandardBidderAdServerTargeting = function () {\n    return (0, _auction.getStandardBidderSettings)()[CONSTANTS.JSON_MAPPING.ADSERVER_TARGETING];\n  };\n\n  function _addAuction(auction) {\n    _auctions.push(auction);\n  }\n\n  return auctionManager;\n}\n\nvar auctionManager = exports.auctionManager = newAuctionManager();\n\n/***/ }),\n\n/***/ 27:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.isValidPriceConfig = exports.getPriceBucketString = undefined;\n\nvar _find = __webpack_require__(10);\n\nvar _find2 = _interopRequireDefault(_find);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar utils = __webpack_require__(0);\n\nvar _defaultPrecision = 2;\nvar _lgPriceConfig = {\n  'buckets': [{\n    'min': 0,\n    'max': 5,\n    'increment': 0.5\n  }]\n};\nvar _mgPriceConfig = {\n  'buckets': [{\n    'min': 0,\n    'max': 20,\n    'increment': 0.1\n  }]\n};\nvar _hgPriceConfig = {\n  'buckets': [{\n    'min': 0,\n    'max': 20,\n    'increment': 0.01\n  }]\n};\nvar _densePriceConfig = {\n  'buckets': [{\n    'min': 0,\n    'max': 3,\n    'increment': 0.01\n  }, {\n    'min': 3,\n    'max': 8,\n    'increment': 0.05\n  }, {\n    'min': 8,\n    'max': 20,\n    'increment': 0.5\n  }]\n};\nvar _autoPriceConfig = {\n  'buckets': [{\n    'min': 0,\n    'max': 5,\n    'increment': 0.05\n  }, {\n    'min': 5,\n    'max': 10,\n    'increment': 0.1\n  }, {\n    'min': 10,\n    'max': 20,\n    'increment': 0.5\n  }]\n};\n\nfunction getPriceBucketString(cpm, customConfig) {\n  var granularityMultiplier = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n\n  var cpmFloat = parseFloat(cpm);\n  if (isNaN(cpmFloat)) {\n    cpmFloat = '';\n  }\n\n  return {\n    low: cpmFloat === '' ? '' : getCpmStringValue(cpm, _lgPriceConfig, granularityMultiplier),\n    med: cpmFloat === '' ? '' : getCpmStringValue(cpm, _mgPriceConfig, granularityMultiplier),\n    high: cpmFloat === '' ? '' : getCpmStringValue(cpm, _hgPriceConfig, granularityMultiplier),\n    auto: cpmFloat === '' ? '' : getCpmStringValue(cpm, _autoPriceConfig, granularityMultiplier),\n    dense: cpmFloat === '' ? '' : getCpmStringValue(cpm, _densePriceConfig, granularityMultiplier),\n    custom: cpmFloat === '' ? '' : getCpmStringValue(cpm, customConfig, granularityMultiplier)\n  };\n}\n\nfunction getCpmStringValue(cpm, config, granularityMultiplier) {\n  var cpmStr = '';\n  if (!isValidPriceConfig(config)) {\n    return cpmStr;\n  }\n  var cap = config.buckets.reduce(function (prev, curr) {\n    if (prev.max > curr.max) {\n      return prev;\n    }\n    return curr;\n  }, {\n    'max': 0\n  });\n  var bucket = (0, _find2.default)(config.buckets, function (bucket) {\n    if (cpm > cap.max * granularityMultiplier) {\n      // cpm exceeds cap, just return the cap.\n      var precision = bucket.precision;\n      if (typeof precision === 'undefined') {\n        precision = _defaultPrecision;\n      }\n      cpmStr = (bucket.max * granularityMultiplier).toFixed(precision);\n    } else if (cpm <= bucket.max * granularityMultiplier && cpm >= bucket.min * granularityMultiplier) {\n      return bucket;\n    }\n  });\n  if (bucket) {\n    cpmStr = getCpmTarget(cpm, bucket, granularityMultiplier);\n  }\n  return cpmStr;\n}\n\nfunction isValidPriceConfig(config) {\n  if (utils.isEmpty(config) || !config.buckets || !Array.isArray(config.buckets)) {\n    return false;\n  }\n  var isValid = true;\n  config.buckets.forEach(function (bucket) {\n    if (typeof bucket.min === 'undefined' || !bucket.max || !bucket.increment) {\n      isValid = false;\n    }\n  });\n  return isValid;\n}\n\nfunction getCpmTarget(cpm, bucket, granularityMultiplier) {\n  var precision = typeof bucket.precision !== 'undefined' ? bucket.precision : _defaultPrecision;\n  var increment = bucket.increment * granularityMultiplier;\n  var bucketMin = bucket.min * granularityMultiplier;\n\n  // start increments at the bucket min and then add bucket min back to arrive at the correct rounding\n  var cpmTarget = Math.floor((cpm - bucketMin) / increment) * increment + bucketMin;\n  // force to 10 decimal places to deal with imprecise decimal/binary conversions\n  //    (for example 0.1 * 3 = 0.30000000000000004)\n  cpmTarget = Number(cpmTarget.toFixed(10));\n  return cpmTarget.toFixed(precision);\n}\n\nexports.getPriceBucketString = getPriceBucketString;\nexports.isValidPriceConfig = isValidPriceConfig;\n\n/***/ }),\n\n/***/ 28:\n/***/ (function(module, exports, __webpack_require__) {\n\n// optional / simple context binding\nvar aFunction = __webpack_require__(43);\nmodule.exports = function (fn, that, length) {\n  aFunction(fn);\n  if (that === undefined) return fn;\n  switch (length) {\n    case 1: return function (a) {\n      return fn.call(that, a);\n    };\n    case 2: return function (a, b) {\n      return fn.call(that, a, b);\n    };\n    case 3: return function (a, b, c) {\n      return fn.call(that, a, b, c);\n    };\n  }\n  return function (/* ...args */) {\n    return fn.apply(that, arguments);\n  };\n};\n\n\n/***/ }),\n\n/***/ 29:\n/***/ (function(module, exports) {\n\nmodule.exports = function (exec) {\n  try {\n    return !!exec();\n  } catch (e) {\n    return true;\n  }\n};\n\n\n/***/ }),\n\n/***/ 3:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n/**\n * This file contains the valid Media Types in Prebid.\n *\n * All adapters are assumed to support banner ads. Other media types are specified by Adapters when they\n * register themselves with prebid-core.\n */\n\n/**\n * @typedef {('native'|'video'|'banner')} MediaType\n */\n\n/** @type MediaType */\nvar NATIVE = exports.NATIVE = 'native';\n/** @type MediaType */\nvar VIDEO = exports.VIDEO = 'video';\n/** @type MediaType */\nvar BANNER = exports.BANNER = 'banner';\n\n/***/ }),\n\n/***/ 30:\n/***/ (function(module, exports, __webpack_require__) {\n\n// 0 -> Array#forEach\n// 1 -> Array#map\n// 2 -> Array#filter\n// 3 -> Array#some\n// 4 -> Array#every\n// 5 -> Array#find\n// 6 -> Array#findIndex\nvar ctx = __webpack_require__(28);\nvar IObject = __webpack_require__(31);\nvar toObject = __webpack_require__(52);\nvar toLength = __webpack_require__(34);\nvar asc = __webpack_require__(53);\nmodule.exports = function (TYPE, $create) {\n  var IS_MAP = TYPE == 1;\n  var IS_FILTER = TYPE == 2;\n  var IS_SOME = TYPE == 3;\n  var IS_EVERY = TYPE == 4;\n  var IS_FIND_INDEX = TYPE == 6;\n  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;\n  var create = $create || asc;\n  return function ($this, callbackfn, that) {\n    var O = toObject($this);\n    var self = IObject(O);\n    var f = ctx(callbackfn, that, 3);\n    var length = toLength(self.length);\n    var index = 0;\n    var result = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined;\n    var val, res;\n    for (;length > index; index++) if (NO_HOLES || index in self) {\n      val = self[index];\n      res = f(val, index, O);\n      if (TYPE) {\n        if (IS_MAP) result[index] = res;   // map\n        else if (res) switch (TYPE) {\n          case 3: return true;             // some\n          case 5: return val;              // find\n          case 6: return index;            // findIndex\n          case 2: result.push(val);        // filter\n        } else if (IS_EVERY) return false; // every\n      }\n    }\n    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : result;\n  };\n};\n\n\n/***/ }),\n\n/***/ 31:\n/***/ (function(module, exports, __webpack_require__) {\n\n// fallback for non-array-like ES3 and non-enumerable old V8 strings\nvar cof = __webpack_require__(32);\n// eslint-disable-next-line no-prototype-builtins\nmodule.exports = Object('z').propertyIsEnumerable(0) ? Object : function (it) {\n  return cof(it) == 'String' ? it.split('') : Object(it);\n};\n\n\n/***/ }),\n\n/***/ 32:\n/***/ (function(module, exports) {\n\nvar toString = {}.toString;\n\nmodule.exports = function (it) {\n  return toString.call(it).slice(8, -1);\n};\n\n\n/***/ }),\n\n/***/ 33:\n/***/ (function(module, exports) {\n\n// 7.2.1 RequireObjectCoercible(argument)\nmodule.exports = function (it) {\n  if (it == undefined) throw TypeError(\"Can't call method on  \" + it);\n  return it;\n};\n\n\n/***/ }),\n\n/***/ 34:\n/***/ (function(module, exports, __webpack_require__) {\n\n// 7.1.15 ToLength\nvar toInteger = __webpack_require__(35);\nvar min = Math.min;\nmodule.exports = function (it) {\n  return it > 0 ? min(toInteger(it), 0x1fffffffffffff) : 0; // pow(2, 53) - 1 == 9007199254740991\n};\n\n\n/***/ }),\n\n/***/ 35:\n/***/ (function(module, exports) {\n\n// 7.1.4 ToInteger\nvar ceil = Math.ceil;\nvar floor = Math.floor;\nmodule.exports = function (it) {\n  return isNaN(it = +it) ? 0 : (it > 0 ? floor : ceil)(it);\n};\n\n\n/***/ }),\n\n/***/ 36:\n/***/ (function(module, exports, __webpack_require__) {\n\n// 7.2.2 IsArray(argument)\nvar cof = __webpack_require__(32);\nmodule.exports = Array.isArray || function isArray(arg) {\n  return cof(arg) == 'Array';\n};\n\n\n/***/ }),\n\n/***/ 37:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.getGlobal = getGlobal;\n// if pbjs already exists in global document scope, use it, if not, create the object\n// global defination should happen BEFORE imports to avoid global undefined errors.\nwindow.pbjs = window.pbjs || {};\nwindow.pbjs.cmd = window.pbjs.cmd || [];\nwindow.pbjs.que = window.pbjs.que || [];\n\nfunction getGlobal() {\n  return window.pbjs;\n}\n\n/***/ }),\n\n/***/ 38:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.targeting = exports.getOldestBid = exports.isBidExpired = exports.RENDERED = exports.BID_TARGETING_SET = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nexports.newTargeting = newTargeting;\n\nvar _utils = __webpack_require__(0);\n\nvar _config = __webpack_require__(4);\n\nvar _native = __webpack_require__(18);\n\nvar _auctionManager = __webpack_require__(26);\n\nvar _includes = __webpack_require__(7);\n\nvar _includes2 = _interopRequireDefault(_includes);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar utils = __webpack_require__(0);\nvar CONSTANTS = __webpack_require__(2);\n\nvar pbTargetingKeys = [];\n\nvar BID_TARGETING_SET = exports.BID_TARGETING_SET = 'targetingSet';\nvar RENDERED = exports.RENDERED = 'rendered';\n\nvar MAX_DFP_KEYLENGTH = 20;\nvar TTL_BUFFER = 1000;\n\n// return unexpired bids\nvar isBidExpired = exports.isBidExpired = function isBidExpired(bid) {\n  return bid.responseTimestamp + bid.ttl * 1000 + TTL_BUFFER > (0, _utils.timestamp)();\n};\n\n// return bids whose status is not set. Winning bid can have status `targetingSet` or `rendered`.\nvar isUnusedBid = function isUnusedBid(bid) {\n  return bid && (bid.status && !(0, _includes2.default)([BID_TARGETING_SET, RENDERED], bid.status) || !bid.status);\n};\n\n// If two bids are found for same adUnitCode, we will use the latest one to take part in auction\n// This can happen in case of concurrent auctions\nvar getOldestBid = exports.getOldestBid = function getOldestBid(bid, i, arr) {\n  var oldestBid = true;\n  arr.forEach(function (val, j) {\n    if (i === j) return;\n    if (bid.bidder === val.bidder && bid.adUnitCode === val.adUnitCode && bid.responseTimestamp > val.responseTimestamp) {\n      oldestBid = false;\n    }\n  });\n  return oldestBid;\n};\n\n/**\n * @typedef {Object.<string,string>} targeting\n * @property {string} targeting_key\n */\n\n/**\n * @typedef {Object.<string,Object.<string,string[]>[]>[]} targetingArray\n */\n\nfunction newTargeting(auctionManager) {\n  var targeting = {};\n\n  targeting.resetPresetTargeting = function (adUnitCode) {\n    if ((0, _utils.isGptPubadsDefined)()) {\n      var adUnitCodes = getAdUnitCodes(adUnitCode);\n      var adUnits = auctionManager.getAdUnits().filter(function (adUnit) {\n        return (0, _includes2.default)(adUnitCodes, adUnit.code);\n      });\n      window.googletag.pubads().getSlots().forEach(function (slot) {\n        pbTargetingKeys.forEach(function (key) {\n          // reset only registered adunits\n          adUnits.forEach(function (unit) {\n            if (unit.code === slot.getAdUnitPath() || unit.code === slot.getSlotElementId()) {\n              slot.setTargeting(key, null);\n            }\n          });\n        });\n      });\n    }\n  };\n\n  /**\n   * Returns all ad server targeting for all ad units.\n   * @param {string=} adUnitCode\n   * @return {Object.<string,targeting>} targeting\n   */\n  targeting.getAllTargeting = function (adUnitCode) {\n    var bidsReceived = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : getBidsReceived();\n\n    var adUnitCodes = getAdUnitCodes(adUnitCode);\n\n    // Get targeting for the winning bid. Add targeting for any bids that have\n    // `alwaysUseBid=true`. If sending all bids is enabled, add targeting for losing bids.\n    var targeting = getWinningBidTargeting(adUnitCodes, bidsReceived).concat(getCustomBidTargeting(adUnitCodes, bidsReceived)).concat(_config.config.getConfig('enableSendAllBids') ? getBidLandscapeTargeting(adUnitCodes, bidsReceived) : []);\n\n    // store a reference of the targeting keys\n    targeting.map(function (adUnitCode) {\n      Object.keys(adUnitCode).map(function (key) {\n        adUnitCode[key].map(function (targetKey) {\n          if (pbTargetingKeys.indexOf(Object.keys(targetKey)[0]) === -1) {\n            pbTargetingKeys = Object.keys(targetKey).concat(pbTargetingKeys);\n          }\n        });\n      });\n    });\n\n    targeting = flattenTargeting(targeting);\n    return targeting;\n  };\n\n  /**\n   * Converts targeting array and flattens to make it easily iteratable\n   * e.g: Sample input to this function\n   * ```\n   * [\n   *    {\n   *      \"div-gpt-ad-1460505748561-0\": [{\"hb_bidder\": [\"appnexusAst\"]}]\n   *    },\n   *    {\n   *      \"div-gpt-ad-1460505748561-0\": [{\"hb_bidder_appnexusAs\": [\"appnexusAst\"]}]\n   *    }\n   * ]\n   * ```\n   * Resulting array\n   * ```\n   * {\n   *  \"div-gpt-ad-1460505748561-0\": {\n   *    \"hb_bidder\": \"appnexusAst\",\n   *    \"hb_bidder_appnexusAs\": \"appnexusAst\"\n   *  }\n   * }\n   * ```\n   *\n   * @param {targetingArray}  targeting\n   * @return {Object.<string,targeting>}  targeting\n   */\n  function flattenTargeting(targeting) {\n    var targetingObj = targeting.map(function (targeting) {\n      return _defineProperty({}, Object.keys(targeting)[0], targeting[Object.keys(targeting)[0]].map(function (target) {\n        return _defineProperty({}, Object.keys(target)[0], target[Object.keys(target)[0]].join(', '));\n      }).reduce(function (p, c) {\n        return _extends(c, p);\n      }, {}));\n    }).reduce(function (accumulator, targeting) {\n      var key = Object.keys(targeting)[0];\n      accumulator[key] = _extends({}, accumulator[key], targeting[key]);\n      return accumulator;\n    }, {});\n    return targetingObj;\n  }\n\n  /**\n   * Sets targeting for DFP\n   * @param {Object.<string,Object.<string,string>>} targetingConfig\n   */\n  targeting.setTargetingForGPT = function (targetingConfig) {\n    window.googletag.pubads().getSlots().forEach(function (slot) {\n      Object.keys(targetingConfig).filter((0, _utils.isAdUnitCodeMatchingSlot)(slot)).forEach(function (targetId) {\n        return Object.keys(targetingConfig[targetId]).forEach(function (key) {\n          var valueArr = targetingConfig[targetId][key].split(',');\n          valueArr = valueArr.length > 1 ? [valueArr] : valueArr;\n          valueArr.map(function (value) {\n            utils.logMessage('Attempting to set key value for slot: ' + slot.getSlotElementId() + ' key: ' + key + ' value: ' + value);\n            return value;\n          }).forEach(function (value) {\n            slot.setTargeting(key, value);\n          });\n        });\n      });\n    });\n  };\n\n  /**\n   * normlizes input to a `adUnit.code` array\n   * @param  {(string|string[])} adUnitCode [description]\n   * @return {string[]}     AdUnit code array\n   */\n  function getAdUnitCodes(adUnitCode) {\n    if (typeof adUnitCode === 'string') {\n      return [adUnitCode];\n    } else if (utils.isArray(adUnitCode)) {\n      return adUnitCode;\n    }\n    return auctionManager.getAdUnitCodes() || [];\n  }\n\n  function getBidsReceived() {\n    return auctionManager.getBidsReceived().filter(isUnusedBid).filter(exports.isBidExpired).filter(getOldestBid);\n  }\n\n  /**\n   * Returns top bids for a given adUnit or set of adUnits.\n   * @param  {(string|string[])} adUnitCode adUnitCode or array of adUnitCodes\n   * @return {[type]}            [description]\n   */\n  targeting.getWinningBids = function (adUnitCode) {\n    var bidsReceived = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : getBidsReceived();\n\n    var adUnitCodes = getAdUnitCodes(adUnitCode);\n\n    return bidsReceived.filter(function (bid) {\n      return (0, _includes2.default)(adUnitCodes, bid.adUnitCode);\n    }).filter(function (bid) {\n      return bid.cpm > 0;\n    }).map(function (bid) {\n      return bid.adUnitCode;\n    }).filter(_utils.uniques).map(function (adUnitCode) {\n      return bidsReceived.filter(function (bid) {\n        return bid.adUnitCode === adUnitCode ? bid : null;\n      }).reduce(_utils.getHighestCpm, getEmptyBid(adUnitCode));\n    });\n  };\n\n  /**\n   * Sets targeting for AST\n   */\n  targeting.setTargetingForAst = function () {\n    var astTargeting = targeting.getAllTargeting();\n    Object.keys(astTargeting).forEach(function (targetId) {\n      return Object.keys(astTargeting[targetId]).forEach(function (key) {\n        utils.logMessage('Attempting to set targeting for targetId: ' + targetId + ' key: ' + key + ' value: ' + astTargeting[targetId][key]);\n        // setKeywords supports string and array as value\n        if (utils.isStr(astTargeting[targetId][key]) || utils.isArray(astTargeting[targetId][key])) {\n          var keywordsObj = {};\n          keywordsObj[key.toUpperCase()] = astTargeting[targetId][key];\n          window.apntag.setKeywords(targetId, keywordsObj);\n        }\n      });\n    });\n  };\n\n  /**\n   * Get targeting key value pairs for winning bid.\n   * @param {string[]}    AdUnit code array\n   * @return {targetingArray}   winning bids targeting\n   */\n  function getWinningBidTargeting(adUnitCodes, bidsReceived) {\n    var winners = targeting.getWinningBids(adUnitCodes, bidsReceived);\n    winners.forEach(function (winner) {\n      winner.status = BID_TARGETING_SET;\n    });\n\n    // TODO : Add losing bids to pool from here ?\n    var standardKeys = getStandardKeys();\n\n    winners = winners.map(function (winner) {\n      return _defineProperty({}, winner.adUnitCode, Object.keys(winner.adserverTargeting).filter(function (key) {\n        return typeof winner.sendStandardTargeting === 'undefined' || winner.sendStandardTargeting || standardKeys.indexOf(key) === -1;\n      }).map(function (key) {\n        return _defineProperty({}, key === 'hb_deal' ? (key + '_' + winner.bidderCode).substring(0, MAX_DFP_KEYLENGTH) : key.substring(0, MAX_DFP_KEYLENGTH), [winner.adserverTargeting[key]]);\n      }));\n    });\n\n    return winners;\n  }\n\n  function getStandardKeys() {\n    return auctionManager.getStandardBidderAdServerTargeting() // in case using a custom standard key set\n    .map(function (targeting) {\n      return targeting.key;\n    }).concat(CONSTANTS.TARGETING_KEYS).filter(_utils.uniques); // standard keys defined in the library.\n  }\n\n  /**\n   * Merge custom adserverTargeting with same key name for same adUnitCode.\n   * e.g: Appnexus defining custom keyvalue pair foo:bar and Rubicon defining custom keyvalue pair foo:baz will be merged to foo: ['bar','baz']\n   *\n   * @param {Object[]} acc Accumulator for reducer. It will store updated bidResponse objects\n   * @param {Object} bid BidResponse\n   * @param {number} index current index\n   * @param {Array} arr original array\n   */\n  function mergeAdServerTargeting(acc, bid, index, arr) {\n    function concatTargetingValue(key) {\n      return function (currentBidElement) {\n        if (!utils.isArray(currentBidElement.adserverTargeting[key])) {\n          currentBidElement.adserverTargeting[key] = [currentBidElement.adserverTargeting[key]];\n        }\n        currentBidElement.adserverTargeting[key] = currentBidElement.adserverTargeting[key].concat(bid.adserverTargeting[key]).filter(_utils.uniques);\n        delete bid.adserverTargeting[key];\n      };\n    }\n\n    function hasSameAdunitCodeAndKey(key) {\n      return function (currentBidElement) {\n        return currentBidElement.adUnitCode === bid.adUnitCode && currentBidElement.adserverTargeting[key];\n      };\n    }\n\n    Object.keys(bid.adserverTargeting).filter(getCustomKeys()).forEach(function (key) {\n      if (acc.length) {\n        acc.filter(hasSameAdunitCodeAndKey(key)).forEach(concatTargetingValue(key));\n      }\n    });\n    acc.push(bid);\n    return acc;\n  }\n\n  function getCustomKeys() {\n    var standardKeys = getStandardKeys();\n    return function (key) {\n      return standardKeys.indexOf(key) === -1;\n    };\n  }\n\n  function truncateCustomKeys(bid) {\n    return _defineProperty({}, bid.adUnitCode, Object.keys(bid.adserverTargeting)\n    // Get only the non-standard keys of the losing bids, since we\n    // don't want to override the standard keys of the winning bid.\n    .filter(getCustomKeys()).map(function (key) {\n      return _defineProperty({}, key.substring(0, MAX_DFP_KEYLENGTH), [bid.adserverTargeting[key]]);\n    }));\n  }\n\n  /**\n   * Get custom targeting key value pairs for bids.\n   * @param {string[]}    AdUnit code array\n   * @return {targetingArray}   bids with custom targeting defined in bidderSettings\n   */\n  function getCustomBidTargeting(adUnitCodes, bidsReceived) {\n    return bidsReceived.filter(function (bid) {\n      return (0, _includes2.default)(adUnitCodes, bid.adUnitCode);\n    }).map(function (bid) {\n      return _extends({}, bid);\n    }).reduce(mergeAdServerTargeting, []).map(truncateCustomKeys).filter(function (bid) {\n      return bid;\n    }); // removes empty elements in array;\n  }\n\n  /**\n   * Get targeting key value pairs for non-winning bids.\n   * @param {string[]}    AdUnit code array\n   * @return {targetingArray}   all non-winning bids targeting\n   */\n  function getBidLandscapeTargeting(adUnitCodes, bidsReceived) {\n    var standardKeys = CONSTANTS.TARGETING_KEYS.concat(_native.NATIVE_TARGETING_KEYS);\n    var bids = [];\n    // bucket by adUnitcode\n    var buckets = (0, _utils.groupBy)(bidsReceived, 'adUnitCode');\n    // filter top bid for each bucket by bidder\n    Object.keys(buckets).forEach(function (bucketKey) {\n      var bidsByBidder = (0, _utils.groupBy)(buckets[bucketKey], 'bidderCode');\n      Object.keys(bidsByBidder).forEach(function (key) {\n        return bids.push(bidsByBidder[key].reduce(_utils.getHighestCpm, getEmptyBid()));\n      });\n    });\n    // populate targeting keys for the remaining bids\n    return bids.map(function (bid) {\n      if (bid.adserverTargeting && adUnitCodes && (utils.isArray(adUnitCodes) && (0, _includes2.default)(adUnitCodes, bid.adUnitCode) || typeof adUnitCodes === 'string' && bid.adUnitCode === adUnitCodes)) {\n        return _defineProperty({}, bid.adUnitCode, getTargetingMap(bid, standardKeys.filter(function (key) {\n          return typeof bid.adserverTargeting[key] !== 'undefined';\n        })));\n      }\n    }).filter(function (bid) {\n      return bid;\n    }); // removes empty elements in array\n  }\n\n  function getTargetingMap(bid, keys) {\n    return keys.map(function (key) {\n      return _defineProperty({}, (key + '_' + bid.bidderCode).substring(0, MAX_DFP_KEYLENGTH), [bid.adserverTargeting[key]]);\n    });\n  }\n\n  targeting.isApntagDefined = function () {\n    if (window.apntag && utils.isFn(window.apntag.setKeywords)) {\n      return true;\n    }\n  };\n\n  function getEmptyBid(adUnitCode) {\n    return {\n      adUnitCode: adUnitCode,\n      cpm: 0,\n      adserverTargeting: {},\n      timeToRespond: 0\n    };\n  }\n  return targeting;\n}\n\nvar targeting = exports.targeting = newTargeting(_auctionManager.auctionManager);\n\n/***/ }),\n\n/***/ 39:\n/***/ (function(module, exports) {\n\nvar g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || Function(\"return this\")() || (1,eval)(\"this\");\n} catch(e) {\n\t// This works if the window reference is available\n\tif(typeof window === \"object\")\n\t\tg = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n\n\n/***/ }),\n\n/***/ 4:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.config = exports.RANDOM = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; /*\n                                                                                                                                                                                                                                                                               * Module for getting and setting Prebid configuration.\n                                                                                                                                                                                                                                                                               *\n                                                                                                                                                                                                                                                                               * Prebid previously defined these properties directly on the global object:\n                                                                                                                                                                                                                                                                               * pbjs.logging = true;\n                                                                                                                                                                                                                                                                               *\n                                                                                                                                                                                                                                                                               * Defining and access properties in this way is now deprecated, but these will\n                                                                                                                                                                                                                                                                               * continue to work during a deprecation window.\n                                                                                                                                                                                                                                                                               */\n\n\nexports.newConfig = newConfig;\n\nvar _cpmBucketManager = __webpack_require__(27);\n\nvar _find = __webpack_require__(10);\n\nvar _find2 = _interopRequireDefault(_find);\n\nvar _includes = __webpack_require__(7);\n\nvar _includes2 = _interopRequireDefault(_includes);\n\nvar _hook = __webpack_require__(21);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nvar utils = __webpack_require__(0);\n\nvar DEFAULT_DEBUG = false;\nvar DEFAULT_BIDDER_TIMEOUT = 3000;\nvar DEFAULT_PUBLISHER_DOMAIN = window.location.origin;\nvar DEFAULT_COOKIESYNC_DELAY = 100;\nvar DEFAULT_ENABLE_SEND_ALL_BIDS = true;\n\nvar DEFAULT_TIMEOUTBUFFER = 200;\n\nvar RANDOM = exports.RANDOM = 'random';\nvar FIXED = 'fixed';\n\nvar VALID_ORDERS = {};\nVALID_ORDERS[RANDOM] = true;\nVALID_ORDERS[FIXED] = true;\n\nvar DEFAULT_BIDDER_SEQUENCE = RANDOM;\n\nvar GRANULARITY_OPTIONS = {\n  LOW: 'low',\n  MEDIUM: 'medium',\n  HIGH: 'high',\n  AUTO: 'auto',\n  DENSE: 'dense',\n  CUSTOM: 'custom'\n};\n\nvar ALL_TOPICS = '*';\n\n/**\n * @typedef {object} PrebidConfig\n *\n * @property {string} cache.url Set a url if we should use prebid-cache to store video bids before adding\n *   bids to the auction. **NOTE** This must be set if you want to use the dfpAdServerVideo module.\n */\n\nfunction newConfig() {\n  var listeners = [];\n  var defaults = void 0;\n  var config = void 0;\n\n  function resetConfig() {\n    defaults = {};\n    config = {\n      // `debug` is equivalent to legacy `pbjs.logging` property\n      _debug: DEFAULT_DEBUG,\n      get debug() {\n        return this._debug;\n      },\n      set debug(val) {\n        this._debug = val;\n      },\n\n      // default timeout for all bids\n      _bidderTimeout: DEFAULT_BIDDER_TIMEOUT,\n      get bidderTimeout() {\n        return this._bidderTimeout;\n      },\n      set bidderTimeout(val) {\n        this._bidderTimeout = val;\n      },\n\n      // domain where prebid is running for cross domain iframe communication\n      _publisherDomain: DEFAULT_PUBLISHER_DOMAIN,\n      get publisherDomain() {\n        return this._publisherDomain;\n      },\n      set publisherDomain(val) {\n        this._publisherDomain = val;\n      },\n\n      // delay to request cookie sync to stay out of critical path\n      _cookieSyncDelay: DEFAULT_COOKIESYNC_DELAY,\n      get cookieSyncDelay() {\n        return pbjs.cookieSyncDelay || this._cookieSyncDelay;\n      },\n      set cookieSyncDelay(val) {\n        this._cookieSyncDelay = val;\n      },\n\n      // calls existing function which may be moved after deprecation\n      _priceGranularity: GRANULARITY_OPTIONS.MEDIUM,\n      set priceGranularity(val) {\n        if (validatePriceGranularity(val)) {\n          if (typeof val === 'string') {\n            this._priceGranularity = hasGranularity(val) ? val : GRANULARITY_OPTIONS.MEDIUM;\n          } else if ((typeof val === 'undefined' ? 'undefined' : _typeof(val)) === 'object') {\n            this._customPriceBucket = val;\n            this._priceGranularity = GRANULARITY_OPTIONS.CUSTOM;\n            utils.logMessage('Using custom price granularity');\n          }\n        }\n      },\n      get priceGranularity() {\n        return this._priceGranularity;\n      },\n\n      _customPriceBucket: {},\n      get customPriceBucket() {\n        return this._customPriceBucket;\n      },\n\n      _sendAllBids: DEFAULT_ENABLE_SEND_ALL_BIDS,\n      get enableSendAllBids() {\n        return this._sendAllBids;\n      },\n      set enableSendAllBids(val) {\n        this._sendAllBids = val;\n      },\n\n      _bidderSequence: DEFAULT_BIDDER_SEQUENCE,\n      get bidderSequence() {\n        return this._bidderSequence;\n      },\n      set bidderSequence(val) {\n        if (VALID_ORDERS[val]) {\n          this._bidderSequence = val;\n        } else {\n          utils.logWarn('Invalid order: ' + val + '. Bidder Sequence was not set.');\n        }\n      },\n\n      // timeout buffer to adjust for bidder CDN latency\n      _timoutBuffer: DEFAULT_TIMEOUTBUFFER,\n      get timeoutBuffer() {\n        return this._timoutBuffer;\n      },\n      set timeoutBuffer(val) {\n        this._timoutBuffer = val;\n      }\n\n    };\n\n    function hasGranularity(val) {\n      return (0, _find2.default)(Object.keys(GRANULARITY_OPTIONS), function (option) {\n        return val === GRANULARITY_OPTIONS[option];\n      });\n    }\n\n    function validatePriceGranularity(val) {\n      if (!val) {\n        utils.logError('Prebid Error: no value passed to `setPriceGranularity()`');\n        return false;\n      }\n      if (typeof val === 'string') {\n        if (!hasGranularity(val)) {\n          utils.logWarn('Prebid Warning: setPriceGranularity was called with invalid setting, using `medium` as default.');\n        }\n      } else if ((typeof val === 'undefined' ? 'undefined' : _typeof(val)) === 'object') {\n        if (!(0, _cpmBucketManager.isValidPriceConfig)(val)) {\n          utils.logError('Invalid custom price value passed to `setPriceGranularity()`');\n          return false;\n        }\n      }\n      return true;\n    }\n  }\n\n  /*\n   * Returns configuration object if called without parameters,\n   * or single configuration property if given a string matching a configuration\n   * property name.  Allows deep access e.g. getConfig('currency.adServerCurrency')\n   *\n   * If called with callback parameter, or a string and a callback parameter,\n   * subscribes to configuration updates. See `subscribe` function for usage.\n   */\n  function getConfig() {\n    if (arguments.length <= 1 && typeof (arguments.length <= 0 ? undefined : arguments[0]) !== 'function') {\n      var option = arguments.length <= 0 ? undefined : arguments[0];\n      return option ? utils.deepAccess(config, option) : config;\n    }\n\n    return subscribe.apply(undefined, arguments);\n  }\n\n  /*\n   * Sets configuration given an object containing key-value pairs and calls\n   * listeners that were added by the `subscribe` function\n   */\n  var setConfig = (0, _hook.createHook)('asyncSeries', function setConfig(options) {\n    if ((typeof options === 'undefined' ? 'undefined' : _typeof(options)) !== 'object') {\n      utils.logError('setConfig options must be an object');\n      return;\n    }\n\n    var topics = Object.keys(options);\n    var topicalConfig = {};\n\n    topics.forEach(function (topic) {\n      var option = options[topic];\n\n      if (_typeof(defaults[topic]) === 'object' && (typeof option === 'undefined' ? 'undefined' : _typeof(option)) === 'object') {\n        option = _extends({}, defaults[topic], option);\n      }\n\n      topicalConfig[topic] = config[topic] = option;\n    });\n\n    callSubscribers(topicalConfig);\n  });\n\n  /**\n   * Sets configuration defaults which setConfig values can be applied on top of\n   * @param {object} options\n   */\n  function setDefaults(options) {\n    if ((typeof defaults === 'undefined' ? 'undefined' : _typeof(defaults)) !== 'object') {\n      utils.logError('defaults must be an object');\n      return;\n    }\n\n    _extends(defaults, options);\n    // Add default values to config as well\n    _extends(config, options);\n  }\n\n  /*\n   * Adds a function to a set of listeners that are invoked whenever `setConfig`\n   * is called. The subscribed function will be passed the options object that\n   * was used in the `setConfig` call. Topics can be subscribed to to only get\n   * updates when specific properties are updated by passing a topic string as\n   * the first parameter.\n   *\n   * Returns an `unsubscribe` function for removing the subscriber from the\n   * set of listeners\n   *\n   * Example use:\n   * // subscribe to all configuration changes\n   * subscribe((config) => console.log('config set:', config));\n   *\n   * // subscribe to only 'logging' changes\n   * subscribe('logging', (config) => console.log('logging set:', config));\n   *\n   * // unsubscribe\n   * const unsubscribe = subscribe(...);\n   * unsubscribe(); // no longer listening\n   */\n  function subscribe(topic, listener) {\n    var callback = listener;\n\n    if (typeof topic !== 'string') {\n      // first param should be callback function in this case,\n      // meaning it gets called for any config change\n      callback = topic;\n      topic = ALL_TOPICS;\n    }\n\n    if (typeof callback !== 'function') {\n      utils.logError('listener must be a function');\n      return;\n    }\n\n    listeners.push({ topic: topic, callback: callback });\n\n    // save and call this function to remove the listener\n    return function unsubscribe() {\n      listeners.splice(listeners.indexOf(listener), 1);\n    };\n  }\n\n  /*\n   * Calls listeners that were added by the `subscribe` function\n   */\n  function callSubscribers(options) {\n    var TOPICS = Object.keys(options);\n\n    // call subscribers of a specific topic, passing only that configuration\n    listeners.filter(function (listener) {\n      return (0, _includes2.default)(TOPICS, listener.topic);\n    }).forEach(function (listener) {\n      listener.callback(_defineProperty({}, listener.topic, options[listener.topic]));\n    });\n\n    // call subscribers that didn't give a topic, passing everything that was set\n    listeners.filter(function (listener) {\n      return listener.topic === ALL_TOPICS;\n    }).forEach(function (listener) {\n      return listener.callback(options);\n    });\n  }\n\n  resetConfig();\n\n  return {\n    getConfig: getConfig,\n    setConfig: setConfig,\n    setDefaults: setDefaults,\n    resetConfig: resetConfig\n  };\n}\n\nvar config = exports.config = newConfig();\n\n/***/ }),\n\n/***/ 42:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n// 22.1.3.8 Array.prototype.find(predicate, thisArg = undefined)\nvar $export = __webpack_require__(16);\nvar $find = __webpack_require__(30)(5);\nvar KEY = 'find';\nvar forced = true;\n// Shouldn't skip holes\nif (KEY in []) Array(1)[KEY](function () { forced = false; });\n$export($export.P + $export.F * forced, 'Array', {\n  find: function find(callbackfn /* , that = undefined */) {\n    return $find(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n__webpack_require__(24)(KEY);\n\n\n/***/ }),\n\n/***/ 43:\n/***/ (function(module, exports) {\n\nmodule.exports = function (it) {\n  if (typeof it != 'function') throw TypeError(it + ' is not a function!');\n  return it;\n};\n\n\n/***/ }),\n\n/***/ 44:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar dP = __webpack_require__(45);\nvar createDesc = __webpack_require__(50);\nmodule.exports = __webpack_require__(23) ? function (object, key, value) {\n  return dP.f(object, key, createDesc(1, value));\n} : function (object, key, value) {\n  object[key] = value;\n  return object;\n};\n\n\n/***/ }),\n\n/***/ 45:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar anObject = __webpack_require__(46);\nvar IE8_DOM_DEFINE = __webpack_require__(47);\nvar toPrimitive = __webpack_require__(49);\nvar dP = Object.defineProperty;\n\nexports.f = __webpack_require__(23) ? Object.defineProperty : function defineProperty(O, P, Attributes) {\n  anObject(O);\n  P = toPrimitive(P, true);\n  anObject(Attributes);\n  if (IE8_DOM_DEFINE) try {\n    return dP(O, P, Attributes);\n  } catch (e) { /* empty */ }\n  if ('get' in Attributes || 'set' in Attributes) throw TypeError('Accessors not supported!');\n  if ('value' in Attributes) O[P] = Attributes.value;\n  return O;\n};\n\n\n/***/ }),\n\n/***/ 46:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar isObject = __webpack_require__(17);\nmodule.exports = function (it) {\n  if (!isObject(it)) throw TypeError(it + ' is not an object!');\n  return it;\n};\n\n\n/***/ }),\n\n/***/ 463:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(464);\n\n\n/***/ }),\n\n/***/ 464:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _prebidGlobal = __webpack_require__(37);\n\nvar _utils = __webpack_require__(0);\n\nvar _secureCreatives = __webpack_require__(465);\n\nvar _userSync = __webpack_require__(13);\n\nvar _adloader = __webpack_require__(11);\n\nvar _config = __webpack_require__(4);\n\nvar _auctionManager = __webpack_require__(26);\n\nvar _targeting = __webpack_require__(38);\n\nvar _hook = __webpack_require__(21);\n\nvar _includes = __webpack_require__(7);\n\nvar _includes2 = _interopRequireDefault(_includes);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; } /** @module pbjs */\n\nvar pbjs = (0, _prebidGlobal.getGlobal)();\nvar CONSTANTS = __webpack_require__(2);\nvar utils = __webpack_require__(0);\nvar adaptermanager = __webpack_require__(8);\nvar bidfactory = __webpack_require__(19);\nvar events = __webpack_require__(9);\nvar triggerUserSyncs = _userSync.userSync.triggerUserSyncs;\n\n/* private variables */\n\nvar _CONSTANTS$EVENTS = CONSTANTS.EVENTS,\n    ADD_AD_UNITS = _CONSTANTS$EVENTS.ADD_AD_UNITS,\n    BID_WON = _CONSTANTS$EVENTS.BID_WON,\n    REQUEST_BIDS = _CONSTANTS$EVENTS.REQUEST_BIDS,\n    SET_TARGETING = _CONSTANTS$EVENTS.SET_TARGETING,\n    AD_RENDER_FAILED = _CONSTANTS$EVENTS.AD_RENDER_FAILED;\nvar _CONSTANTS$AD_RENDER_ = CONSTANTS.AD_RENDER_FAILED_REASON,\n    PREVENT_WRITING_ON_MAIN_DOCUMENT = _CONSTANTS$AD_RENDER_.PREVENT_WRITING_ON_MAIN_DOCUMENT,\n    NO_AD = _CONSTANTS$AD_RENDER_.NO_AD,\n    EXCEPTION = _CONSTANTS$AD_RENDER_.EXCEPTION,\n    CANNOT_FIND_AD = _CONSTANTS$AD_RENDER_.CANNOT_FIND_AD,\n    MISSING_DOC_OR_ADID = _CONSTANTS$AD_RENDER_.MISSING_DOC_OR_ADID;\n\n\nvar eventValidators = {\n  bidWon: checkDefinedPlacement\n};\n\n/* Public vars */\npbjs.bidderSettings = pbjs.bidderSettings || {};\n\n// current timeout set in `requestBids` or to default `bidderTimeout`\npbjs.cbTimeout = pbjs.cbTimeout || 200;\n\n// let the world know we are loaded\npbjs.libLoaded = true;\n\n// version auto generated from build\npbjs.version = 'v1.11.0';\nutils.logInfo('Prebid.js v1.11.0 loaded');\n\n// create adUnit array\npbjs.adUnits = pbjs.adUnits || [];\n\n// Allow publishers who enable user sync override to trigger their sync\npbjs.triggerUserSyncs = triggerUserSyncs;\n\nfunction checkDefinedPlacement(id) {\n  var adUnitCodes = _auctionManager.auctionManager.getBidsRequested().map(function (bidSet) {\n    return bidSet.bids.map(function (bid) {\n      return bid.adUnitCode;\n    });\n  }).reduce(_utils.flatten).filter(_utils.uniques);\n\n  if (!utils.contains(adUnitCodes, id)) {\n    utils.logError('The \"' + id + '\" placement is not defined.');\n    return;\n  }\n\n  return true;\n}\n\nfunction setRenderSize(doc, width, height) {\n  if (doc.defaultView && doc.defaultView.frameElement) {\n    doc.defaultView.frameElement.width = width;\n    doc.defaultView.frameElement.height = height;\n  }\n}\n\n/// ///////////////////////////////\n//                              //\n//    Start Public APIs         //\n//                              //\n/// ///////////////////////////////\n\n/**\n * This function returns the query string targeting parameters available at this moment for a given ad unit. Note that some bidder's response may not have been received if you call this function too quickly after the requests are sent.\n * @param  {string} [adunitCode] adUnitCode to get the bid responses for\n * @alias module:pbjs.getAdserverTargetingForAdUnitCodeStr\n * @return {Array}  returnObj return bids array\n */\npbjs.getAdserverTargetingForAdUnitCodeStr = function (adunitCode) {\n  utils.logInfo('Invoking pbjs.getAdserverTargetingForAdUnitCodeStr', arguments);\n\n  // call to retrieve bids array\n  if (adunitCode) {\n    var res = pbjs.getAdserverTargetingForAdUnitCode(adunitCode);\n    return utils.transformAdServerTargetingObj(res);\n  } else {\n    utils.logMessage('Need to call getAdserverTargetingForAdUnitCodeStr with adunitCode');\n  }\n};\n\n/**\n * This function returns the query string targeting parameters available at this moment for a given ad unit. Note that some bidder's response may not have been received if you call this function too quickly after the requests are sent.\n * @param adUnitCode {string} adUnitCode to get the bid responses for\n * @alias module:pbjs.getAdserverTargetingForAdUnitCode\n * @returns {Object}  returnObj return bids\n */\npbjs.getAdserverTargetingForAdUnitCode = function (adUnitCode) {\n  return pbjs.getAdserverTargeting(adUnitCode)[adUnitCode];\n};\n\n/**\n * returns all ad server targeting for all ad units\n * @return {Object} Map of adUnitCodes and targeting values []\n * @alias module:pbjs.getAdserverTargeting\n */\n\npbjs.getAdserverTargeting = function (adUnitCode) {\n  utils.logInfo('Invoking pbjs.getAdserverTargeting', arguments);\n  var bidsReceived = _auctionManager.auctionManager.getBidsReceived();\n  return _targeting.targeting.getAllTargeting(adUnitCode, bidsReceived);\n};\n\n/**\n * This function returns the bid responses at the given moment.\n * @alias module:pbjs.getBidResponses\n * @return {Object}            map | object that contains the bidResponses\n */\n\npbjs.getBidResponses = function () {\n  utils.logInfo('Invoking pbjs.getBidResponses', arguments);\n  var responses = _auctionManager.auctionManager.getBidsReceived().filter(_utils.adUnitsFilter.bind(this, _auctionManager.auctionManager.getAdUnitCodes()));\n\n  // find the last auction id to get responses for most recent auction only\n  var currentAuctionId = responses && responses.length && responses[responses.length - 1].auctionId;\n\n  return responses.map(function (bid) {\n    return bid.adUnitCode;\n  }).filter(_utils.uniques).map(function (adUnitCode) {\n    return responses.filter(function (bid) {\n      return bid.auctionId === currentAuctionId && bid.adUnitCode === adUnitCode;\n    });\n  }).filter(function (bids) {\n    return bids && bids[0] && bids[0].adUnitCode;\n  }).map(function (bids) {\n    return _defineProperty({}, bids[0].adUnitCode, { bids: bids.map(_utils.removeRequestId) });\n  }).reduce(function (a, b) {\n    return _extends(a, b);\n  }, {});\n};\n\n/**\n * Returns bidResponses for the specified adUnitCode\n * @param  {string} adUnitCode adUnitCode\n * @alias module:pbjs.getBidResponsesForAdUnitCode\n * @return {Object}            bidResponse object\n */\n\npbjs.getBidResponsesForAdUnitCode = function (adUnitCode) {\n  var bids = _auctionManager.auctionManager.getBidsReceived().filter(function (bid) {\n    return bid.adUnitCode === adUnitCode;\n  });\n  return {\n    bids: bids.map(_utils.removeRequestId)\n  };\n};\n\n/**\n * Set query string targeting on one or more GPT ad units.\n * @param {(string|string[])} adUnit a single `adUnit.code` or multiple.\n * @alias module:pbjs.setTargetingForGPTAsync\n */\npbjs.setTargetingForGPTAsync = function (adUnit) {\n  utils.logInfo('Invoking pbjs.setTargetingForGPTAsync', arguments);\n  if (!(0, _utils.isGptPubadsDefined)()) {\n    utils.logError('window.googletag is not defined on the page');\n    return;\n  }\n\n  // get our ad unit codes\n  var targetingSet = _targeting.targeting.getAllTargeting(adUnit);\n\n  // first reset any old targeting\n  _targeting.targeting.resetPresetTargeting(adUnit);\n\n  // now set new targeting keys\n  _targeting.targeting.setTargetingForGPT(targetingSet);\n\n  // emit event\n  events.emit(SET_TARGETING, targetingSet);\n};\n\n/**\n * Set query string targeting on all AST (AppNexus Seller Tag) ad units. Note that this function has to be called after all ad units on page are defined. For working example code, see [Using Prebid.js with AppNexus Publisher Ad Server](http://prebid.org/dev-docs/examples/use-prebid-with-appnexus-ad-server.html).\n * @alias module:pbjs.setTargetingForAst\n */\npbjs.setTargetingForAst = function () {\n  utils.logInfo('Invoking pbjs.setTargetingForAn', arguments);\n  if (!_targeting.targeting.isApntagDefined()) {\n    utils.logError('window.apntag is not defined on the page');\n    return;\n  }\n\n  _targeting.targeting.setTargetingForAst();\n\n  // emit event\n  events.emit(SET_TARGETING, _targeting.targeting.getAllTargeting());\n};\n\nfunction emitAdRenderFail(reason, message, bid) {\n  var data = {};\n\n  data.reason = reason;\n  data.message = message;\n  if (bid) {\n    data.bid = bid;\n  }\n\n  utils.logError(message);\n  events.emit(AD_RENDER_FAILED, data);\n}\n/**\n * This function will render the ad (based on params) in the given iframe document passed through.\n * Note that doc SHOULD NOT be the parent document page as we can't doc.write() asynchronously\n * @param  {HTMLDocument} doc document\n * @param  {string} id bid id to locate the ad\n * @alias module:pbjs.renderAd\n */\npbjs.renderAd = function (doc, id) {\n  utils.logInfo('Invoking pbjs.renderAd', arguments);\n  utils.logMessage('Calling renderAd with adId :' + id);\n\n  if (doc && id) {\n    try {\n      // lookup ad by ad Id\n      var bid = _auctionManager.auctionManager.findBidByAdId(id);\n      if (bid) {\n        bid.status = _targeting.RENDERED;\n        // replace macros according to openRTB with price paid = bid.cpm\n        bid.ad = utils.replaceAuctionPrice(bid.ad, bid.cpm);\n        bid.adUrl = utils.replaceAuctionPrice(bid.adUrl, bid.cpm);\n        // save winning bids\n        _auctionManager.auctionManager.addWinningBid(bid);\n\n        // emit 'bid won' event here\n        events.emit(BID_WON, bid);\n\n        var height = bid.height,\n            width = bid.width,\n            ad = bid.ad,\n            mediaType = bid.mediaType,\n            adUrl = bid.adUrl,\n            renderer = bid.renderer;\n\n\n        var creativeComment = document.createComment('Creative ' + bid.creativeId + ' served by ' + bid.bidder + ' Prebid.js Header Bidding');\n        utils.insertElement(creativeComment, doc, 'body');\n\n        if (renderer && renderer.url) {\n          renderer.render(bid);\n        } else if (doc === document && !utils.inIframe() || mediaType === 'video') {\n          var message = 'Error trying to write ad. Ad render call ad id ' + id + ' was prevented from writing to the main document.';\n          emitAdRenderFail(PREVENT_WRITING_ON_MAIN_DOCUMENT, message, bid);\n        } else if (ad) {\n          doc.write(ad);\n          doc.close();\n          setRenderSize(doc, width, height);\n          utils.callBurl(bid);\n        } else if (adUrl) {\n          var iframe = utils.createInvisibleIframe();\n          iframe.height = height;\n          iframe.width = width;\n          iframe.style.display = 'inline';\n          iframe.style.overflow = 'hidden';\n          iframe.src = adUrl;\n\n          utils.insertElement(iframe, doc, 'body');\n          setRenderSize(doc, width, height);\n          utils.callBurl(bid);\n        } else {\n          var _message = 'Error trying to write ad. No ad for bid response id: ' + id;\n          emitAdRenderFail(NO_AD, _message, bid);\n        }\n      } else {\n        var _message2 = 'Error trying to write ad. Cannot find ad by given id : ' + id;\n        emitAdRenderFail(CANNOT_FIND_AD, _message2);\n      }\n    } catch (e) {\n      var _message3 = 'Error trying to write ad Id :' + id + ' to the page:' + e.message;\n      emitAdRenderFail(EXCEPTION, _message3);\n    }\n  } else {\n    var _message4 = 'Error trying to write ad Id :' + id + ' to the page. Missing document or adId';\n    emitAdRenderFail(MISSING_DOC_OR_ADID, _message4);\n  }\n};\n\n/**\n * Remove adUnit from the pbjs configuration\n * @param  {string} adUnitCode the adUnitCode to remove\n * @alias module:pbjs.removeAdUnit\n */\npbjs.removeAdUnit = function (adUnitCode) {\n  utils.logInfo('Invoking pbjs.removeAdUnit', arguments);\n  if (adUnitCode) {\n    for (var i = 0; i < pbjs.adUnits.length; i++) {\n      if (pbjs.adUnits[i].code === adUnitCode) {\n        pbjs.adUnits.splice(i, 1);\n      }\n    }\n  }\n};\n\n/**\n * @param {Object} requestOptions\n * @param {function} requestOptions.bidsBackHandler\n * @param {number} requestOptions.timeout\n * @param {Array} requestOptions.adUnits\n * @param {Array} requestOptions.adUnitCodes\n * @param {Array} requestOptions.labels\n * @alias module:pbjs.requestBids\n */\npbjs.requestBids = (0, _hook.createHook)('asyncSeries', function () {\n  var _ref2 = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      bidsBackHandler = _ref2.bidsBackHandler,\n      timeout = _ref2.timeout,\n      adUnits = _ref2.adUnits,\n      adUnitCodes = _ref2.adUnitCodes,\n      labels = _ref2.labels;\n\n  events.emit(REQUEST_BIDS);\n  var cbTimeout = timeout || _config.config.getConfig('bidderTimeout');\n  adUnits = adUnits || pbjs.adUnits;\n\n  utils.logInfo('Invoking pbjs.requestBids', arguments);\n\n  if (adUnitCodes && adUnitCodes.length) {\n    // if specific adUnitCodes supplied filter adUnits for those codes\n    adUnits = adUnits.filter(function (unit) {\n      return (0, _includes2.default)(adUnitCodes, unit.code);\n    });\n  } else {\n    // otherwise derive adUnitCodes from adUnits\n    adUnitCodes = adUnits && adUnits.map(function (unit) {\n      return unit.code;\n    });\n  }\n\n  /*\n   * for a given adunit which supports a set of mediaTypes\n   * and a given bidder which supports a set of mediaTypes\n   * a bidder is eligible to participate on the adunit\n   * if it supports at least one of the mediaTypes on the adunit\n   */\n  adUnits.forEach(function (adUnit) {\n    // get the adunit's mediaTypes, defaulting to banner if mediaTypes isn't present\n    var adUnitMediaTypes = Object.keys(adUnit.mediaTypes || { 'banner': 'banner' });\n\n    // get the bidder's mediaTypes\n    var bidders = adUnit.bids.map(function (bid) {\n      return bid.bidder;\n    });\n    var bidderRegistry = adaptermanager.bidderRegistry;\n\n    bidders.forEach(function (bidder) {\n      var adapter = bidderRegistry[bidder];\n      var spec = adapter && adapter.getSpec && adapter.getSpec();\n      // banner is default if not specified in spec\n      var bidderMediaTypes = spec && spec.supportedMediaTypes || ['banner'];\n\n      // check if the bidder's mediaTypes are not in the adUnit's mediaTypes\n      var bidderEligible = adUnitMediaTypes.some(function (type) {\n        return (0, _includes2.default)(bidderMediaTypes, type);\n      });\n      if (!bidderEligible) {\n        // drop the bidder from the ad unit if it's not compatible\n        utils.logWarn(utils.unsupportedBidderMessage(adUnit, bidder));\n        adUnit.bids = adUnit.bids.filter(function (bid) {\n          return bid.bidder !== bidder;\n        });\n      }\n    });\n  });\n\n  if (!adUnits || adUnits.length === 0) {\n    utils.logMessage('No adUnits configured. No bids requested.');\n    if (typeof bidsBackHandler === 'function') {\n      // executeCallback, this will only be called in case of first request\n      try {\n        bidsBackHandler();\n      } catch (e) {\n        utils.logError('Error executing bidsBackHandler', null, e);\n      }\n    }\n    return;\n  }\n\n  var auction = _auctionManager.auctionManager.createAuction({ adUnits: adUnits, adUnitCodes: adUnitCodes, callback: bidsBackHandler, cbTimeout: cbTimeout, labels: labels });\n  auction.callBids();\n  return auction;\n});\n\n/**\n *\n * Add adunit(s)\n * @param {Array|Object} adUnitArr Array of adUnits or single adUnit Object.\n * @alias module:pbjs.addAdUnits\n */\npbjs.addAdUnits = function (adUnitArr) {\n  utils.logInfo('Invoking pbjs.addAdUnits', arguments);\n  if (utils.isArray(adUnitArr)) {\n    // generate transactionid for each new adUnits\n    // Append array to existing\n    adUnitArr.forEach(function (adUnit) {\n      return adUnit.transactionId = utils.generateUUID();\n    });\n    pbjs.adUnits.push.apply(pbjs.adUnits, adUnitArr);\n  } else if ((typeof adUnitArr === 'undefined' ? 'undefined' : _typeof(adUnitArr)) === 'object') {\n    // Generate the transaction id for the adunit\n    adUnitArr.transactionId = utils.generateUUID();\n    pbjs.adUnits.push(adUnitArr);\n  }\n  // emit event\n  events.emit(ADD_AD_UNITS);\n};\n\n/**\n * @param {string} event the name of the event\n * @param {Function} handler a callback to set on event\n * @param {string} id an identifier in the context of the event\n * @alias module:pbjs.onEvent\n *\n * This API call allows you to register a callback to handle a Prebid.js event.\n * An optional `id` parameter provides more finely-grained event callback registration.\n * This makes it possible to register callback events for a specific item in the\n * event context. For example, `bidWon` events will accept an `id` for ad unit code.\n * `bidWon` callbacks registered with an ad unit code id will be called when a bid\n * for that ad unit code wins the auction. Without an `id` this method registers the\n * callback for every `bidWon` event.\n *\n * Currently `bidWon` is the only event that accepts an `id` parameter.\n */\npbjs.onEvent = function (event, handler, id) {\n  utils.logInfo('Invoking pbjs.onEvent', arguments);\n  if (!utils.isFn(handler)) {\n    utils.logError('The event handler provided is not a function and was not set on event \"' + event + '\".');\n    return;\n  }\n\n  if (id && !eventValidators[event].call(null, id)) {\n    utils.logError('The id provided is not valid for event \"' + event + '\" and no handler was set.');\n    return;\n  }\n\n  events.on(event, handler, id);\n};\n\n/**\n * @param {string} event the name of the event\n * @param {Function} handler a callback to remove from the event\n * @param {string} id an identifier in the context of the event (see `pbjs.onEvent`)\n * @alias module:pbjs.offEvent\n */\npbjs.offEvent = function (event, handler, id) {\n  utils.logInfo('Invoking pbjs.offEvent', arguments);\n  if (id && !eventValidators[event].call(null, id)) {\n    return;\n  }\n\n  events.off(event, handler, id);\n};\n\n/*\n * Wrapper to register bidderAdapter externally (adaptermanager.registerBidAdapter())\n * @param  {Function} bidderAdaptor [description]\n * @param  {string} bidderCode [description]\n * @alias module:pbjs.registerBidAdapter\n */\npbjs.registerBidAdapter = function (bidderAdaptor, bidderCode) {\n  utils.logInfo('Invoking pbjs.registerBidAdapter', arguments);\n  try {\n    adaptermanager.registerBidAdapter(bidderAdaptor(), bidderCode);\n  } catch (e) {\n    utils.logError('Error registering bidder adapter : ' + e.message);\n  }\n};\n\n/**\n * Wrapper to register analyticsAdapter externally (adaptermanager.registerAnalyticsAdapter())\n * @param  {Object} options [description]\n * @alias module:pbjs.registerAnalyticsAdapter\n */\npbjs.registerAnalyticsAdapter = function (options) {\n  utils.logInfo('Invoking pbjs.registerAnalyticsAdapter', arguments);\n  try {\n    adaptermanager.registerAnalyticsAdapter(options);\n  } catch (e) {\n    utils.logError('Error registering analytics adapter : ' + e.message);\n  }\n};\n\n/**\n * Wrapper to bidfactory.createBid()\n * @param  {string} statusCode [description]\n * @alias module:pbjs.createBid\n * @return {Object} bidResponse [description]\n */\npbjs.createBid = function (statusCode) {\n  utils.logInfo('Invoking pbjs.createBid', arguments);\n  return bidfactory.createBid(statusCode);\n};\n\n/**\n * @deprecated this function will be removed in the next release. Prebid has deprected external JS loading.\n * @param  {string} tagSrc [description]\n * @param  {Function} callback [description]\n * @alias module:pbjs.loadScript\n */\npbjs.loadScript = function (tagSrc, callback, useCache) {\n  utils.logInfo('Invoking pbjs.loadScript', arguments);\n  (0, _adloader.loadScript)(tagSrc, callback, useCache);\n};\n\n/**\n * Enable sending analytics data to the analytics provider of your\n * choice.\n *\n * For usage, see [Integrate with the Prebid Analytics\n * API](http://prebid.org/dev-docs/integrate-with-the-prebid-analytics-api.html).\n *\n * For a list of analytics adapters, see [Analytics for\n * Prebid](http://prebid.org/overview/analytics.html).\n * @param  {Object} config\n * @param {string} config.provider The name of the provider, e.g., `\"ga\"` for Google Analytics.\n * @param {Object} config.options The options for this particular analytics adapter.  This will likely vary between adapters.\n * @alias module:pbjs.enableAnalytics\n */\npbjs.enableAnalytics = function (config) {\n  if (config && !utils.isEmpty(config)) {\n    utils.logInfo('Invoking pbjs.enableAnalytics for: ', config);\n    adaptermanager.enableAnalytics(config);\n  } else {\n    utils.logError('pbjs.enableAnalytics should be called with option {}');\n  }\n};\n\n/**\n * @alias module:pbjs.aliasBidder\n */\npbjs.aliasBidder = function (bidderCode, alias) {\n  utils.logInfo('Invoking pbjs.aliasBidder', arguments);\n  if (bidderCode && alias) {\n    adaptermanager.aliasBidAdapter(bidderCode, alias);\n  } else {\n    utils.logError('bidderCode and alias must be passed as arguments', 'pbjs.aliasBidder');\n  }\n};\n\n/**\n * The bid response object returned by an external bidder adapter during the auction.\n * @typedef {Object} AdapterBidResponse\n * @property {string} pbAg Auto granularity price bucket; CPM <= 5 ? increment = 0.05 : CPM > 5 && CPM <= 10 ? increment = 0.10 : CPM > 10 && CPM <= 20 ? increment = 0.50 : CPM > 20 ? priceCap = 20.00.  Example: `\"0.80\"`.\n * @property {string} pbCg Custom price bucket.  For example setup, see {@link setPriceGranularity}.  Example: `\"0.84\"`.\n * @property {string} pbDg Dense granularity price bucket; CPM <= 3 ? increment = 0.01 : CPM > 3 && CPM <= 8 ? increment = 0.05 : CPM > 8 && CPM <= 20 ? increment = 0.50 : CPM > 20? priceCap = 20.00.  Example: `\"0.84\"`.\n * @property {string} pbLg Low granularity price bucket; $0.50 increment, capped at $5, floored to two decimal places.  Example: `\"0.50\"`.\n * @property {string} pbMg Medium granularity price bucket; $0.10 increment, capped at $20, floored to two decimal places.  Example: `\"0.80\"`.\n * @property {string} pbHg High granularity price bucket; $0.01 increment, capped at $20, floored to two decimal places.  Example: `\"0.84\"`.\n *\n * @property {string} bidder The string name of the bidder.  This *may* be the same as the `bidderCode`.  For For a list of all bidders and their codes, see [Bidders' Params](http://prebid.org/dev-docs/bidders.html).\n * @property {string} bidderCode The unique string that identifies this bidder.  For a list of all bidders and their codes, see [Bidders' Params](http://prebid.org/dev-docs/bidders.html).\n *\n * @property {string} requestId The [UUID](https://en.wikipedia.org/wiki/Universally_unique_identifier) representing the bid request.\n * @property {number} requestTimestamp The time at which the bid request was sent out, expressed in milliseconds.\n * @property {number} responseTimestamp The time at which the bid response was received, expressed in milliseconds.\n * @property {number} timeToRespond How long it took for the bidder to respond with this bid, expressed in milliseconds.\n *\n * @property {string} size The size of the ad creative, expressed in `\"AxB\"` format, where A and B are numbers of pixels.  Example: `\"320x50\"`.\n * @property {string} width The width of the ad creative in pixels.  Example: `\"320\"`.\n * @property {string} height The height of the ad creative in pixels.  Example: `\"50\"`.\n *\n * @property {string} ad The actual ad creative content, often HTML with CSS, JavaScript, and/or links to additional content.  Example: `\"<div id='beacon_-YQbipJtdxmMCgEPHExLhmqzEm' style='position: absolute; left: 0px; top: 0px; visibility: hidden;'><img src='http://aplus-...'/></div><iframe src=\\\"http://aax-us-east.amazon-adsystem.com/e/is/8dcfcd...\" width=\\\"728\\\" height=\\\"90\\\" frameborder=\\\"0\\\" ...></iframe>\",`.\n * @property {number} ad_id The ad ID of the creative, as understood by the bidder's system.  Used by the line item's [creative in the ad server](http://prebid.org/adops/send-all-bids-adops.html#step-3-add-a-creative).\n * @property {string} adUnitCode The code used to uniquely identify the ad unit on the publisher's page.\n *\n * @property {string} statusMessage The status of the bid.  Allowed values: `\"Bid available\"` or `\"Bid returned empty or error response\"`.\n * @property {number} cpm The exact bid price from the bidder, expressed to the thousandths place.  Example: `\"0.849\"`.\n *\n * @property {Object} adserverTargeting An object whose values represent the ad server's targeting on the bid.\n * @property {string} adserverTargeting.hb_adid The ad ID of the creative, as understood by the ad server.\n * @property {string} adserverTargeting.hb_pb The price paid to show the creative, as logged in the ad server.\n * @property {string} adserverTargeting.hb_bidder The winning bidder whose ad creative will be served by the ad server.\n*/\n\n/**\n * Get all of the bids that have been rendered.  Useful for [troubleshooting your integration](http://prebid.org/dev-docs/prebid-troubleshooting-guide.html).\n * @return {Array<AdapterBidResponse>} A list of bids that have been rendered.\n*/\npbjs.getAllWinningBids = function () {\n  return _auctionManager.auctionManager.getAllWinningBids().map(_utils.removeRequestId);\n};\n\n/**\n * Get all of the bids that have won their respective auctions.\n * @return {Array<AdapterBidResponse>} A list of bids that have won their respective auctions.\n */\npbjs.getAllPrebidWinningBids = function () {\n  return _auctionManager.auctionManager.getBidsReceived().filter(function (bid) {\n    return bid.status === _targeting.BID_TARGETING_SET;\n  }).map(_utils.removeRequestId);\n};\n\n/**\n * Get array of highest cpm bids for all adUnits, or highest cpm bid\n * object for the given adUnit\n * @param {string} adUnitCode - optional ad unit code\n * @alias module:pbjs.getHighestCpmBids\n * @return {Array} array containing highest cpm bid object(s)\n */\npbjs.getHighestCpmBids = function (adUnitCode) {\n  var bidsReceived = _auctionManager.auctionManager.getBidsReceived().filter(_targeting.getOldestBid);\n  return _targeting.targeting.getWinningBids(adUnitCode, bidsReceived).map(_utils.removeRequestId);\n};\n\n/**\n * Get Prebid config options\n * @param {Object} options\n * @alias module:pbjs.getConfig\n */\npbjs.getConfig = _config.config.getConfig;\n\n/**\n * Set Prebid config options.\n * (Added in version 0.27.0).\n *\n * `setConfig` is designed to allow for advanced configuration while\n * reducing the surface area of the public API.  For more information\n * about the move to `setConfig` (and the resulting deprecations of\n * some other public methods), see [the Prebid 1.0 public API\n * proposal](https://gist.github.com/mkendall07/51ee5f6b9f2df01a89162cf6de7fe5b6).\n *\n * #### Troubleshooting your configuration\n *\n * If you call `pbjs.setConfig` without an object, e.g.,\n *\n * `pbjs.setConfig('debug', 'true'))`\n *\n * then Prebid.js will print an error to the console that says:\n *\n * ```\n * ERROR: setConfig options must be an object\n * ```\n *\n * If you don't see that message, you can assume the config object is valid.\n *\n * @param {Object} options Global Prebid configuration object. Must be JSON - no JavaScript functions are allowed.\n * @param {string} options.bidderSequence The order in which bidders are called.  Example: `pbjs.setConfig({ bidderSequence: \"fixed\" })`.  Allowed values: `\"fixed\"` (order defined in `adUnit.bids` array on page), `\"random\"`.\n * @param {boolean} options.debug Turn debug logging on/off. Example: `pbjs.setConfig({ debug: true })`.\n * @param {string} options.priceGranularity The bid price granularity to use.  Example: `pbjs.setConfig({ priceGranularity: \"medium\" })`. Allowed values: `\"low\"` ($0.50), `\"medium\"` ($0.10), `\"high\"` ($0.01), `\"auto\"` (sliding scale), `\"dense\"` (like `\"auto\"`, with smaller increments at lower CPMs), or a custom price bucket object, e.g., `{ \"buckets\" : [{\"min\" : 0,\"max\" : 20,\"increment\" : 0.1,\"cap\" : true}]}`.\n * @param {boolean} options.enableSendAllBids Turn \"send all bids\" mode on/off.  Example: `pbjs.setConfig({ enableSendAllBids: true })`.\n * @param {number} options.bidderTimeout Set a global bidder timeout, in milliseconds.  Example: `pbjs.setConfig({ bidderTimeout: 3000 })`.  Note that it's still possible for a bid to get into the auction that responds after this timeout. This is due to how [`setTimeout`](https://developer.mozilla.org/en-US/docs/Web/API/WindowOrWorkerGlobalScope/setTimeout) works in JS: it queues the callback in the event loop in an approximate location that should execute after this time but it is not guaranteed.  For more information about the asynchronous event loop and `setTimeout`, see [How JavaScript Timers Work](https://johnresig.com/blog/how-javascript-timers-work/).\n * @param {string} options.publisherDomain The publisher's domain where Prebid is running, for cross-domain iFrame communication.  Example: `pbjs.setConfig({ publisherDomain: \"https://www.theverge.com\" })`.\n * @param {number} options.cookieSyncDelay A delay (in milliseconds) for requesting cookie sync to stay out of the critical path of page load.  Example: `pbjs.setConfig({ cookieSyncDelay: 100 })`.\n * @param {Object} options.s2sConfig The configuration object for [server-to-server header bidding](http://prebid.org/dev-docs/get-started-with-prebid-server.html).  Example:\n * @alias module:pbjs.setConfig\n * ```\n * pbjs.setConfig({\n *     s2sConfig: {\n *         accountId: '1',\n *         enabled: true,\n *         bidders: ['appnexus', 'pubmatic'],\n *         timeout: 1000,\n *         adapter: 'prebidServer',\n *         endpoint: 'https://prebid.adnxs.com/pbs/v1/auction'\n *     }\n * })\n * ```\n */\npbjs.setConfig = _config.config.setConfig;\n\npbjs.que.push(function () {\n  return (0, _secureCreatives.listenMessagesFromCreative)();\n});\n\n/**\n * This queue lets users load Prebid asynchronously, but run functions the same way regardless of whether it gets loaded\n * before or after their script executes. For example, given the code:\n *\n * <script src=\"url/to/Prebid.js\" async></script>\n * <script>\n *   var pbjs = pbjs || {};\n *   pbjs.cmd = pbjs.cmd || [];\n *   pbjs.cmd.push(functionToExecuteOncePrebidLoads);\n * </script>\n *\n * If the page's script runs before prebid loads, then their function gets added to the queue, and executed\n * by prebid once it's done loading. If it runs after prebid loads, then this monkey-patch causes their\n * function to execute immediately.\n *\n * @memberof pbjs\n * @param  {function} command A function which takes no arguments. This is guaranteed to run exactly once, and only after\n *                            the Prebid script has been fully loaded.\n * @alias module:pbjs.cmd.push\n */\npbjs.cmd.push = function (command) {\n  if (typeof command === 'function') {\n    try {\n      command.call();\n    } catch (e) {\n      utils.logError('Error processing command :', e.message, e.stack);\n    }\n  } else {\n    utils.logError('Commands written into pbjs.cmd.push must be wrapped in a function');\n  }\n};\n\npbjs.que.push = pbjs.cmd.push;\n\nfunction processQueue(queue) {\n  queue.forEach(function (cmd) {\n    if (typeof cmd.called === 'undefined') {\n      try {\n        cmd.call();\n        cmd.called = true;\n      } catch (e) {\n        utils.logError('Error processing command :', 'prebid.js', e);\n      }\n    }\n  });\n}\n\n/**\n * @alias module:pbjs.processQueue\n */\npbjs.processQueue = function () {\n  processQueue(pbjs.que);\n  processQueue(pbjs.cmd);\n};\n\n/***/ }),\n\n/***/ 465:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.listenMessagesFromCreative = listenMessagesFromCreative;\n\nvar _events = __webpack_require__(9);\n\nvar _events2 = _interopRequireDefault(_events);\n\nvar _native = __webpack_require__(18);\n\nvar _constants = __webpack_require__(2);\n\nvar _utils = __webpack_require__(0);\n\nvar _auctionManager = __webpack_require__(26);\n\nvar _find = __webpack_require__(10);\n\nvar _find2 = _interopRequireDefault(_find);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/* Secure Creatives\n  Provides support for rendering creatives into cross domain iframes such as SafeFrame to prevent\n   access to a publisher page from creative payloads.\n */\n\nvar BID_WON = _constants.EVENTS.BID_WON;\n\nfunction listenMessagesFromCreative() {\n  addEventListener('message', receiveMessage, false);\n}\n\nfunction receiveMessage(ev) {\n  var key = ev.message ? 'message' : 'data';\n  var data = {};\n  try {\n    data = JSON.parse(ev[key]);\n  } catch (e) {\n    return;\n  }\n\n  if (data.adId) {\n    var adObject = (0, _find2.default)(_auctionManager.auctionManager.getBidsReceived(), function (bid) {\n      return bid.adId === data.adId;\n    });\n\n    if (data.message === 'Prebid Request') {\n      sendAdToCreative(adObject, data.adServerDomain, ev.source);\n\n      // save winning bids\n      _auctionManager.auctionManager.addWinningBid(adObject);\n\n      _events2.default.emit(BID_WON, adObject);\n    }\n\n    // handle this script from native template in an ad server\n    // window.parent.postMessage(JSON.stringify({\n    //   message: 'Prebid Native',\n    //   adId: '%%PATTERN:hb_adid%%'\n    // }), '*');\n    if (data.message === 'Prebid Native') {\n      (0, _native.fireNativeTrackers)(data, adObject);\n      _auctionManager.auctionManager.addWinningBid(adObject);\n      _events2.default.emit(BID_WON, adObject);\n    }\n  }\n}\n\nfunction sendAdToCreative(adObject, remoteDomain, source) {\n  var adId = adObject.adId,\n      ad = adObject.ad,\n      adUrl = adObject.adUrl,\n      width = adObject.width,\n      height = adObject.height;\n\n\n  if (adId) {\n    resizeRemoteCreative(adObject);\n    source.postMessage(JSON.stringify({\n      message: 'Prebid Response',\n      ad: ad,\n      adUrl: adUrl,\n      adId: adId,\n      width: width,\n      height: height\n    }), remoteDomain);\n  }\n}\n\nfunction resizeRemoteCreative(_ref) {\n  var adUnitCode = _ref.adUnitCode,\n      width = _ref.width,\n      height = _ref.height;\n\n  var iframe = document.getElementById((0, _find2.default)(window.googletag.pubads().getSlots().filter((0, _utils.isSlotMatchingAdUnitCode)(adUnitCode)), function (slot) {\n    return slot;\n  }).getSlotElementId()).querySelector('iframe');\n\n  iframe.width = '' + width;\n  iframe.height = '' + height;\n}\n\n/***/ }),\n\n/***/ 47:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = !__webpack_require__(23) && !__webpack_require__(29)(function () {\n  return Object.defineProperty(__webpack_require__(48)('div'), 'a', { get: function () { return 7; } }).a != 7;\n});\n\n\n/***/ }),\n\n/***/ 48:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar isObject = __webpack_require__(17);\nvar document = __webpack_require__(20).document;\n// typeof document.createElement is 'object' in old IE\nvar is = isObject(document) && isObject(document.createElement);\nmodule.exports = function (it) {\n  return is ? document.createElement(it) : {};\n};\n\n\n/***/ }),\n\n/***/ 49:\n/***/ (function(module, exports, __webpack_require__) {\n\n// 7.1.1 ToPrimitive(input [, PreferredType])\nvar isObject = __webpack_require__(17);\n// instead of the ES6 spec version, we didn't implement @@toPrimitive case\n// and the second argument - flag - preferred type is a string\nmodule.exports = function (it, S) {\n  if (!isObject(it)) return it;\n  var fn, val;\n  if (S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (typeof (fn = it.valueOf) == 'function' && !isObject(val = fn.call(it))) return val;\n  if (!S && typeof (fn = it.toString) == 'function' && !isObject(val = fn.call(it))) return val;\n  throw TypeError(\"Can't convert object to primitive value\");\n};\n\n\n/***/ }),\n\n/***/ 50:\n/***/ (function(module, exports) {\n\nmodule.exports = function (bitmap, value) {\n  return {\n    enumerable: !(bitmap & 1),\n    configurable: !(bitmap & 2),\n    writable: !(bitmap & 4),\n    value: value\n  };\n};\n\n\n/***/ }),\n\n/***/ 51:\n/***/ (function(module, exports) {\n\nvar hasOwnProperty = {}.hasOwnProperty;\nmodule.exports = function (it, key) {\n  return hasOwnProperty.call(it, key);\n};\n\n\n/***/ }),\n\n/***/ 52:\n/***/ (function(module, exports, __webpack_require__) {\n\n// 7.1.13 ToObject(argument)\nvar defined = __webpack_require__(33);\nmodule.exports = function (it) {\n  return Object(defined(it));\n};\n\n\n/***/ }),\n\n/***/ 53:\n/***/ (function(module, exports, __webpack_require__) {\n\n// 9.4.2.3 ArraySpeciesCreate(originalArray, length)\nvar speciesConstructor = __webpack_require__(54);\n\nmodule.exports = function (original, length) {\n  return new (speciesConstructor(original))(length);\n};\n\n\n/***/ }),\n\n/***/ 54:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar isObject = __webpack_require__(17);\nvar isArray = __webpack_require__(36);\nvar SPECIES = __webpack_require__(55)('species');\n\nmodule.exports = function (original) {\n  var C;\n  if (isArray(original)) {\n    C = original.constructor;\n    // cross-realm fallback\n    if (typeof C == 'function' && (C === Array || isArray(C.prototype))) C = undefined;\n    if (isObject(C)) {\n      C = C[SPECIES];\n      if (C === null) C = undefined;\n    }\n  } return C === undefined ? Array : C;\n};\n\n\n/***/ }),\n\n/***/ 55:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar store = __webpack_require__(56)('wks');\nvar uid = __webpack_require__(57);\nvar Symbol = __webpack_require__(20).Symbol;\nvar USE_SYMBOL = typeof Symbol == 'function';\n\nvar $exports = module.exports = function (name) {\n  return store[name] || (store[name] =\n    USE_SYMBOL && Symbol[name] || (USE_SYMBOL ? Symbol : uid)('Symbol.' + name));\n};\n\n$exports.store = store;\n\n\n/***/ }),\n\n/***/ 56:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar global = __webpack_require__(20);\nvar SHARED = '__core-js_shared__';\nvar store = global[SHARED] || (global[SHARED] = {});\nmodule.exports = function (key) {\n  return store[key] || (store[key] = {});\n};\n\n\n/***/ }),\n\n/***/ 57:\n/***/ (function(module, exports) {\n\nvar id = 0;\nvar px = Math.random();\nmodule.exports = function (key) {\n  return 'Symbol('.concat(key === undefined ? '' : key, ')_', (++id + px).toString(36));\n};\n\n\n/***/ }),\n\n/***/ 58:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n// https://github.com/tc39/Array.prototype.includes\nvar $export = __webpack_require__(16);\nvar $includes = __webpack_require__(59)(true);\n\n$export($export.P, 'Array', {\n  includes: function includes(el /* , fromIndex = 0 */) {\n    return $includes(this, el, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n\n__webpack_require__(24)('includes');\n\n\n/***/ }),\n\n/***/ 59:\n/***/ (function(module, exports, __webpack_require__) {\n\n// false -> Array#indexOf\n// true  -> Array#includes\nvar toIObject = __webpack_require__(60);\nvar toLength = __webpack_require__(34);\nvar toAbsoluteIndex = __webpack_require__(61);\nmodule.exports = function (IS_INCLUDES) {\n  return function ($this, el, fromIndex) {\n    var O = toIObject($this);\n    var length = toLength(O.length);\n    var index = toAbsoluteIndex(fromIndex, length);\n    var value;\n    // Array#includes uses SameValueZero equality algorithm\n    // eslint-disable-next-line no-self-compare\n    if (IS_INCLUDES && el != el) while (length > index) {\n      value = O[index++];\n      // eslint-disable-next-line no-self-compare\n      if (value != value) return true;\n    // Array#indexOf ignores holes, Array#includes - not\n    } else for (;length > index; index++) if (IS_INCLUDES || index in O) {\n      if (O[index] === el) return IS_INCLUDES || index || 0;\n    } return !IS_INCLUDES && -1;\n  };\n};\n\n\n/***/ }),\n\n/***/ 6:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.ajax = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.ajaxBuilder = ajaxBuilder;\n\nvar _url = __webpack_require__(12);\n\nvar utils = __webpack_require__(0);\n\nvar XHR_DONE = 4;\n\n/**\n * Simple IE9+ and cross-browser ajax request function\n * Note: x-domain requests in IE9 do not support the use of cookies\n *\n * @param url string url\n * @param callback {object | function} callback\n * @param data mixed data\n * @param options object\n */\nvar ajax = exports.ajax = ajaxBuilder();\n\nfunction ajaxBuilder() {\n  var timeout = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 3000;\n\n  return function (url, callback, data) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n    try {\n      var x = void 0;\n      var useXDomainRequest = false;\n      var method = options.method || (data ? 'POST' : 'GET');\n\n      var callbacks = (typeof callback === 'undefined' ? 'undefined' : _typeof(callback)) === 'object' && callback !== null ? callback : {\n        success: function success() {\n          utils.logMessage('xhr success');\n        },\n        error: function error(e) {\n          utils.logError('xhr error', null, e);\n        }\n      };\n\n      if (typeof callback === 'function') {\n        callbacks.success = callback;\n      }\n\n      if (!window.XMLHttpRequest) {\n        useXDomainRequest = true;\n      } else {\n        x = new window.XMLHttpRequest();\n        if (x.responseType === undefined) {\n          useXDomainRequest = true;\n        }\n      }\n\n      if (useXDomainRequest) {\n        x = new window.XDomainRequest();\n        x.onload = function () {\n          callbacks.success(x.responseText, x);\n        };\n\n        // http://stackoverflow.com/questions/15786966/xdomainrequest-aborts-post-on-ie-9\n        x.onerror = function () {\n          callbacks.error('error', x);\n        };\n        x.ontimeout = function () {\n          callbacks.error('timeout', x);\n        };\n        x.onprogress = function () {\n          utils.logMessage('xhr onprogress');\n        };\n      } else {\n        x.onreadystatechange = function () {\n          if (x.readyState === XHR_DONE) {\n            var status = x.status;\n            if (status >= 200 && status < 300 || status === 304) {\n              callbacks.success(x.responseText, x);\n            } else {\n              callbacks.error(x.statusText, x);\n            }\n          }\n        };\n        x.ontimeout = function () {\n          utils.logError('  xhr timeout after ', x.timeout, 'ms');\n        };\n      }\n\n      if (method === 'GET' && data) {\n        var urlInfo = (0, _url.parse)(url, options);\n        _extends(urlInfo.search, data);\n        url = (0, _url.format)(urlInfo);\n      }\n\n      x.open(method, url);\n      // IE needs timoeut to be set after open - see #1410\n      x.timeout = timeout;\n\n      if (!useXDomainRequest) {\n        if (options.withCredentials) {\n          x.withCredentials = true;\n        }\n        utils._each(options.customHeaders, function (value, header) {\n          x.setRequestHeader(header, value);\n        });\n        if (options.preflight) {\n          x.setRequestHeader('X-Requested-With', 'XMLHttpRequest');\n        }\n        x.setRequestHeader('Content-Type', options.contentType || 'text/plain');\n      }\n      if (method === 'POST' && data) {\n        x.send(data);\n      } else {\n        x.send();\n      }\n    } catch (error) {\n      utils.logError('xhr construction', error);\n    }\n  };\n}\n\n/***/ }),\n\n/***/ 60:\n/***/ (function(module, exports, __webpack_require__) {\n\n// to indexed object, toObject with fallback for non-array-like ES3 strings\nvar IObject = __webpack_require__(31);\nvar defined = __webpack_require__(33);\nmodule.exports = function (it) {\n  return IObject(defined(it));\n};\n\n\n/***/ }),\n\n/***/ 61:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar toInteger = __webpack_require__(35);\nvar max = Math.max;\nvar min = Math.min;\nmodule.exports = function (index, length) {\n  index = toInteger(index);\n  return index < 0 ? max(index + length, 0) : min(index, length);\n};\n\n\n/***/ }),\n\n/***/ 62:\n/***/ (function(module, exports) {\n\nmodule.exports = clone;\n\n/*\n  Identical to `just-extend(true, {}, obj1)`\n\n  var arr = [1, 2, 3];\n  var subObj = {aa: 1};\n  var obj = {a: 3, b: 5, c: arr, d: subObj};\n  var objClone = clone(obj);\n  arr.push(4);\n  subObj.bb = 2;\n  obj; // {a: 3, b: 5, c: [1, 2, 3, 4], d: {aa: 1}}\n  objClone; // {a: 3, b: 5, c: [1, 2, 3], d: {aa: 1, bb: 2}}\n*/\n\nfunction clone(obj) {\n  var result = Array.isArray(obj) ? [] : {};\n  for (var key in obj) {\n    // include prototype properties\n    var value = obj[key];\n    if (value && typeof value == 'object') {\n      result[key] = clone(value);\n    } else {\n      result[key] = value;\n    }\n  }\n  return result;\n}\n\n\n/***/ }),\n\n/***/ 63:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.setSizeConfig = setSizeConfig;\nexports.resolveStatus = resolveStatus;\n\nvar _config = __webpack_require__(4);\n\nvar _utils = __webpack_require__(0);\n\nvar _includes = __webpack_require__(7);\n\nvar _includes2 = _interopRequireDefault(_includes);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar sizeConfig = [];\n\n/**\n * @typedef {object} SizeConfig\n *\n * @property {string} [mediaQuery] A CSS media query string that will to be interpreted by window.matchMedia.  If the\n *  media query matches then the this config will be active and sizesSupported will filter bid and adUnit sizes.  If\n *  this property is not present then this SizeConfig will only be active if triggered manually by a call to\n *  pbjs.setConfig({labels:['label']) specifying one of the labels present on this SizeConfig.\n * @property {Array<Array>} sizesSupported The sizes to be accepted if this SizeConfig is enabled.\n * @property {Array<string>} labels The active labels to match this SizeConfig to an adUnits and/or bidders.\n */\n\n/**\n *\n * @param {Array<SizeConfig>} config\n */\nfunction setSizeConfig(config) {\n  sizeConfig = config;\n}\n_config.config.getConfig('sizeConfig', function (config) {\n  return setSizeConfig(config.sizeConfig);\n});\n\n/**\n * Resolves the unique set of the union of all sizes and labels that are active from a SizeConfig.mediaQuery match\n * @param {Array<string>} labels Labels specified on adUnit or bidder\n * @param {boolean} labelAll if true, all labels must match to be enabled\n * @param {Array<string>} activeLabels Labels passed in through requestBids\n * @param {Array<Array<number>>} sizes Sizes specified on adUnit\n * @param {Array<SizeConfig>} configs\n * @returns {{labels: Array<string>, sizes: Array<Array<number>>}}\n */\nfunction resolveStatus() {\n  var _ref = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {},\n      _ref$labels = _ref.labels,\n      labels = _ref$labels === undefined ? [] : _ref$labels,\n      _ref$labelAll = _ref.labelAll,\n      labelAll = _ref$labelAll === undefined ? false : _ref$labelAll,\n      _ref$activeLabels = _ref.activeLabels,\n      activeLabels = _ref$activeLabels === undefined ? [] : _ref$activeLabels;\n\n  var sizes = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var configs = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : sizeConfig;\n\n  var maps = evaluateSizeConfig(configs);\n\n  var filteredSizes = void 0;\n  if (maps.shouldFilter) {\n    filteredSizes = sizes.filter(function (size) {\n      return maps.sizesSupported[size];\n    });\n  } else {\n    filteredSizes = sizes;\n  }\n\n  return {\n    active: filteredSizes.length > 0 && (labels.length === 0 || !labelAll && (labels.some(function (label) {\n      return maps.labels[label];\n    }) || labels.some(function (label) {\n      return (0, _includes2.default)(activeLabels, label);\n    })) || labelAll && labels.reduce(function (result, label) {\n      return !result ? result : maps.labels[label] || (0, _includes2.default)(activeLabels, label);\n    }, true)),\n    sizes: filteredSizes\n  };\n}\n\nfunction evaluateSizeConfig(configs) {\n  return configs.reduce(function (results, config) {\n    if ((typeof config === 'undefined' ? 'undefined' : _typeof(config)) === 'object' && typeof config.mediaQuery === 'string') {\n      if (matchMedia(config.mediaQuery).matches) {\n        if (Array.isArray(config.sizesSupported)) {\n          results.shouldFilter = true;\n        }\n        ['labels', 'sizesSupported'].forEach(function (type) {\n          return (config[type] || []).forEach(function (thing) {\n            return results[type][thing] = true;\n          });\n        });\n      }\n    } else {\n      (0, _utils.logWarn)('sizeConfig rule missing required property \"mediaQuery\"');\n    }\n    return results;\n  }, {\n    labels: {},\n    sizesSupported: {},\n    shouldFilter: false\n  });\n}\n\n/***/ }),\n\n/***/ 64:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.hasNonVideoBidder = exports.videoBidder = exports.videoAdUnit = undefined;\nexports.isValidVideoBid = isValidVideoBid;\n\nvar _adaptermanager = __webpack_require__(8);\n\nvar _utils = __webpack_require__(0);\n\nvar _config = __webpack_require__(4);\n\nvar _includes = __webpack_require__(7);\n\nvar _includes2 = _interopRequireDefault(_includes);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar VIDEO_MEDIA_TYPE = 'video';\nvar OUTSTREAM = 'outstream';\n\n/**\n * Helper functions for working with video-enabled adUnits\n */\nvar videoAdUnit = exports.videoAdUnit = function videoAdUnit(adUnit) {\n  var mediaType = adUnit.mediaType === VIDEO_MEDIA_TYPE;\n  var mediaTypes = (0, _utils.deepAccess)(adUnit, 'mediaTypes.video');\n  return mediaType || mediaTypes;\n};\nvar videoBidder = exports.videoBidder = function videoBidder(bid) {\n  return (0, _includes2.default)(_adaptermanager.videoAdapters, bid.bidder);\n};\nvar hasNonVideoBidder = exports.hasNonVideoBidder = function hasNonVideoBidder(adUnit) {\n  return adUnit.bids.filter(function (bid) {\n    return !videoBidder(bid);\n  }).length;\n};\n\n/**\n * @typedef {object} VideoBid\n * @property {string} adId id of the bid\n */\n\n/**\n * Validate that the assets required for video context are present on the bid\n * @param {VideoBid} bid Video bid to validate\n * @param {BidRequest[]} bidRequests All bid requests for an auction\n * @return {Boolean} If object is valid\n */\nfunction isValidVideoBid(bid, bidRequests) {\n  var bidRequest = (0, _utils.getBidRequest)(bid.adId, bidRequests);\n\n  var videoMediaType = bidRequest && (0, _utils.deepAccess)(bidRequest, 'mediaTypes.video');\n  var context = videoMediaType && (0, _utils.deepAccess)(videoMediaType, 'context');\n\n  // if context not defined assume default 'instream' for video bids\n  // instream bids require a vast url or vast xml content\n  if (!bidRequest || videoMediaType && context !== OUTSTREAM) {\n    // xml-only video bids require a prebid cache url\n    if (!_config.config.getConfig('cache.url') && bid.vastXml && !bid.vastUrl) {\n      (0, _utils.logError)('\\n        This bid contains only vastXml and will not work when a prebid cache url is not specified.\\n        Try enabling prebid cache with pbjs.setConfig({ cache: {url: \"...\"} });\\n      ');\n      return false;\n    }\n\n    return !!(bid.vastUrl || bid.vastXml);\n  }\n\n  // outstream bids require a renderer on the bid or pub-defined on adunit\n  if (context === OUTSTREAM) {\n    // WIKIA_CHANGE: Set as valid if bidder renderer is disabled for outstream bids\n    return !!(bid.renderer || bidRequest.renderer || bid.vastContent);\n  }\n\n  return true;\n}\n\n/***/ }),\n\n/***/ 7:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(58);\nmodule.exports = __webpack_require__(15).Array.includes;\n\n\n/***/ }),\n\n/***/ 8:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; /** @module adaptermanger */\n\nvar _utils = __webpack_require__(0);\n\nvar _sizeMapping = __webpack_require__(63);\n\nvar _native = __webpack_require__(18);\n\nvar _bidderFactory = __webpack_require__(1);\n\nvar _ajax = __webpack_require__(6);\n\nvar _config = __webpack_require__(4);\n\nvar _includes = __webpack_require__(7);\n\nvar _includes2 = _interopRequireDefault(_includes);\n\nvar _find = __webpack_require__(10);\n\nvar _find2 = _interopRequireDefault(_find);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar utils = __webpack_require__(0);\nvar CONSTANTS = __webpack_require__(2);\nvar events = __webpack_require__(9);\nvar s2sTestingModule = void 0; // store s2sTesting module if it's loaded\n\nvar _bidderRegistry = {};\nexports.bidderRegistry = _bidderRegistry;\nexports.aliasRegistry = {};\n\nvar _s2sConfig = {};\n_config.config.getConfig('s2sConfig', function (config) {\n  _s2sConfig = config.s2sConfig;\n});\n\nvar _analyticsRegistry = {};\n\n/**\n * @typedef {object} LabelDescriptor\n * @property {boolean} labelAll describes whether or not this object expects all labels to match, or any label to match\n * @property {Array<string>} labels the labels listed on the bidder or adUnit\n * @property {Array<string>} activeLabels the labels specified as being active by requestBids\n */\n\n/**\n * Returns object describing the status of labels on the adUnit or bidder along with labels passed into requestBids\n * @param bidOrAdUnit the bidder or adUnit to get label info on\n * @param activeLabels the labels passed to requestBids\n * @returns {LabelDescriptor}\n */\nfunction getLabels(bidOrAdUnit, activeLabels) {\n  if (bidOrAdUnit.labelAll) {\n    return { labelAll: true, labels: bidOrAdUnit.labelAll, activeLabels: activeLabels };\n  }\n  return { labelAll: false, labels: bidOrAdUnit.labelAny, activeLabels: activeLabels };\n}\n\nfunction getBids(_ref) {\n  var bidderCode = _ref.bidderCode,\n      auctionId = _ref.auctionId,\n      bidderRequestId = _ref.bidderRequestId,\n      adUnits = _ref.adUnits,\n      labels = _ref.labels;\n\n  return adUnits.reduce(function (result, adUnit) {\n    var _resolveStatus = (0, _sizeMapping.resolveStatus)(getLabels(adUnit, labels), adUnit.sizes),\n        active = _resolveStatus.active,\n        filteredAdUnitSizes = _resolveStatus.sizes;\n\n    if (active) {\n      result.push(adUnit.bids.filter(function (bid) {\n        return bid.bidder === bidderCode;\n      }).reduce(function (bids, bid) {\n        if (adUnit.mediaTypes) {\n          if (utils.isValidMediaTypes(adUnit.mediaTypes)) {\n            bid = _extends({}, bid, { mediaTypes: adUnit.mediaTypes });\n          } else {\n            utils.logError('mediaTypes is not correctly configured for adunit ' + adUnit.code);\n          }\n        }\n\n        var nativeParams = adUnit.nativeParams || utils.deepAccess(adUnit, 'mediaTypes.native');\n        if (nativeParams) {\n          bid = _extends({}, bid, {\n            nativeParams: (0, _native.processNativeAdUnitParams)(nativeParams)\n          });\n        }\n\n        bid = _extends({}, bid, (0, _utils.getDefinedParams)(adUnit, ['mediaType', 'renderer']));\n\n        var _resolveStatus2 = (0, _sizeMapping.resolveStatus)(getLabels(bid, labels), filteredAdUnitSizes),\n            active = _resolveStatus2.active,\n            sizes = _resolveStatus2.sizes;\n\n        if (active) {\n          bids.push(_extends({}, bid, {\n            adUnitCode: adUnit.code,\n            transactionId: adUnit.transactionId,\n            sizes: sizes,\n            bidId: bid.bid_id || utils.getUniqueIdentifierStr(),\n            bidderRequestId: bidderRequestId,\n            auctionId: auctionId\n          }));\n        }\n        return bids;\n      }, []));\n    }\n    return result;\n  }, []).reduce(_utils.flatten, []).filter(function (val) {\n    return val !== '';\n  });\n}\n\nfunction getAdUnitCopyForPrebidServer(adUnits) {\n  var adaptersServerSide = _s2sConfig.bidders;\n  var adUnitsCopy = utils.deepClone(adUnits);\n\n  adUnitsCopy.forEach(function (adUnit) {\n    // filter out client side bids\n    adUnit.bids = adUnit.bids.filter(function (bid) {\n      return (0, _includes2.default)(adaptersServerSide, bid.bidder) && (!doingS2STesting() || bid.finalSource !== s2sTestingModule.CLIENT);\n    }).map(function (bid) {\n      bid.bid_id = utils.getUniqueIdentifierStr();\n      return bid;\n    });\n  });\n\n  // don't send empty requests\n  adUnitsCopy = adUnitsCopy.filter(function (adUnit) {\n    return adUnit.bids.length !== 0;\n  });\n  return adUnitsCopy;\n}\n\nfunction getAdUnitCopyForClientAdapters(adUnits) {\n  var adUnitsClientCopy = utils.deepClone(adUnits);\n  // filter out s2s bids\n  adUnitsClientCopy.forEach(function (adUnit) {\n    adUnit.bids = adUnit.bids.filter(function (bid) {\n      return !doingS2STesting() || bid.finalSource !== s2sTestingModule.SERVER;\n    });\n  });\n\n  // don't send empty requests\n  adUnitsClientCopy = adUnitsClientCopy.filter(function (adUnit) {\n    return adUnit.bids.length !== 0;\n  });\n\n  return adUnitsClientCopy;\n}\n\nexports.gdprDataHandler = {\n  consentData: null,\n  setConsentData: function setConsentData(consentInfo) {\n    this.consentData = consentInfo;\n  },\n  getConsentData: function getConsentData() {\n    return this.consentData;\n  }\n};\n\nexports.makeBidRequests = function (adUnits, auctionStart, auctionId, cbTimeout, labels) {\n  var bidRequests = [];\n\n  adUnits = exports.checkBidRequestSizes(adUnits);\n\n  var bidderCodes = (0, _utils.getBidderCodes)(adUnits);\n  if (_config.config.getConfig('bidderSequence') === _config.RANDOM) {\n    bidderCodes = (0, _utils.shuffle)(bidderCodes);\n  }\n\n  var clientBidderCodes = bidderCodes;\n  var clientTestAdapters = [];\n  if (_s2sConfig.enabled) {\n    // if s2sConfig.bidderControl testing is turned on\n    if (doingS2STesting()) {\n      // get all adapters doing client testing\n      clientTestAdapters = s2sTestingModule.getSourceBidderMap(adUnits)[s2sTestingModule.CLIENT];\n    }\n\n    // these are called on the s2s adapter\n    var adaptersServerSide = _s2sConfig.bidders;\n\n    // don't call these client side (unless client request is needed for testing)\n    clientBidderCodes = bidderCodes.filter(function (elm) {\n      return !(0, _includes2.default)(adaptersServerSide, elm) || (0, _includes2.default)(clientTestAdapters, elm);\n    });\n\n    var adUnitsS2SCopy = getAdUnitCopyForPrebidServer(adUnits);\n    var tid = utils.generateUUID();\n    adaptersServerSide.forEach(function (bidderCode) {\n      var bidderRequestId = utils.getUniqueIdentifierStr();\n      var bidderRequest = {\n        bidderCode: bidderCode,\n        auctionId: auctionId,\n        bidderRequestId: bidderRequestId,\n        tid: tid,\n        adUnitsS2SCopy: adUnitsS2SCopy,\n        bids: getBids({ bidderCode: bidderCode, auctionId: auctionId, bidderRequestId: bidderRequestId, 'adUnits': adUnitsS2SCopy, labels: labels }),\n        auctionStart: auctionStart,\n        timeout: _s2sConfig.timeout,\n        src: CONSTANTS.S2S.SRC\n      };\n      if (bidderRequest.bids.length !== 0) {\n        bidRequests.push(bidderRequest);\n      }\n    });\n  }\n\n  // client adapters\n  var adUnitsClientCopy = getAdUnitCopyForClientAdapters(adUnits);\n  clientBidderCodes.forEach(function (bidderCode) {\n    var bidderRequestId = utils.getUniqueIdentifierStr();\n    var bidderRequest = {\n      bidderCode: bidderCode,\n      auctionId: auctionId,\n      bidderRequestId: bidderRequestId,\n      bids: getBids({ bidderCode: bidderCode, auctionId: auctionId, bidderRequestId: bidderRequestId, 'adUnits': adUnitsClientCopy, labels: labels }),\n      auctionStart: auctionStart,\n      timeout: cbTimeout\n    };\n    if (bidderRequest.bids && bidderRequest.bids.length !== 0) {\n      bidRequests.push(bidderRequest);\n    }\n  });\n\n  if (exports.gdprDataHandler.getConsentData()) {\n    bidRequests.forEach(function (bidRequest) {\n      bidRequest['gdprConsent'] = exports.gdprDataHandler.getConsentData();\n    });\n  }\n  return bidRequests;\n};\n\nexports.checkBidRequestSizes = function (adUnits) {\n  function isArrayOfNums(val) {\n    return Array.isArray(val) && val.length === 2 && utils.isInteger(val[0]) && utils.isInteger(val[1]);\n  }\n\n  adUnits.forEach(function (adUnit) {\n    if (adUnit.sizes) {\n      utils.logWarn('Usage of adUnits.sizes will eventually be deprecated.  Please define size dimensions within the corresponding area of the mediaTypes.<object> (eg mediaTypes.banner.sizes).');\n    }\n\n    var mediaTypes = adUnit.mediaTypes;\n    if (mediaTypes && mediaTypes.banner) {\n      var banner = mediaTypes.banner;\n      if (banner.sizes) {\n        adUnit.sizes = banner.sizes;\n      } else {\n        utils.logError('Detected a mediaTypes.banner object did not include sizes.  This is a required field for the mediaTypes.banner object.  Removing invalid mediaTypes.banner object from request.');\n        delete adUnit.mediaTypes.banner;\n      }\n    }\n\n    if (mediaTypes && mediaTypes.video) {\n      var video = mediaTypes.video;\n      if (video.playerSize) {\n        if (Array.isArray(video.playerSize) && video.playerSize.length === 1 && video.playerSize.every(isArrayOfNums)) {\n          adUnit.sizes = video.playerSize;\n        } else if (isArrayOfNums(video.playerSize)) {\n          var newPlayerSize = [];\n          newPlayerSize.push(video.playerSize);\n          utils.logInfo('Transforming video.playerSize from ' + video.playerSize + ' to ' + newPlayerSize + ' so it\\'s in the proper format.');\n          adUnit.sizes = video.playerSize = newPlayerSize;\n        } else {\n          utils.logError('Detected incorrect configuration of mediaTypes.video.playerSize.  Please specify only one set of dimensions in a format like: [[640, 480]]. Removing invalid mediaTypes.video.playerSize property from request.');\n          delete adUnit.mediaTypes.video.playerSize;\n        }\n      }\n    }\n\n    if (mediaTypes && mediaTypes.native) {\n      var native = mediaTypes.native;\n      if (native.image && native.image.sizes && !Array.isArray(native.image.sizes)) {\n        utils.logError('Please use an array of sizes for native.image.sizes field.  Removing invalid mediaTypes.native.image.sizes property from request.');\n        delete adUnit.mediaTypes.native.image.sizes;\n      }\n      if (native.image && native.image.aspect_ratios && !Array.isArray(native.image.aspect_ratios)) {\n        utils.logError('Please use an array of sizes for native.image.aspect_ratios field.  Removing invalid mediaTypes.native.image.aspect_ratios property from request.');\n        delete adUnit.mediaTypes.native.image.aspect_ratios;\n      }\n      if (native.icon && native.icon.sizes && !Array.isArray(native.icon.sizes)) {\n        utils.logError('Please use an array of sizes for native.icon.sizes field.  Removing invalid mediaTypes.native.icon.sizes property from request.');\n        delete adUnit.mediaTypes.native.icon.sizes;\n      }\n    }\n  });\n  return adUnits;\n};\n\nexports.callBids = function (adUnits, bidRequests, addBidResponse, doneCb) {\n  if (!bidRequests.length) {\n    utils.logWarn('callBids executed with no bidRequests.  Were they filtered by labels or sizing?');\n    return;\n  }\n\n  var ajax = (0, _ajax.ajaxBuilder)(bidRequests[0].timeout);\n\n  var _bidRequests$reduce = bidRequests.reduce(function (partitions, bidRequest) {\n    partitions[Number(typeof bidRequest.src !== 'undefined' && bidRequest.src === CONSTANTS.S2S.SRC)].push(bidRequest);\n    return partitions;\n  }, [[], []]),\n      _bidRequests$reduce2 = _slicedToArray(_bidRequests$reduce, 2),\n      clientBidRequests = _bidRequests$reduce2[0],\n      serverBidRequests = _bidRequests$reduce2[1];\n\n  if (serverBidRequests.length) {\n    var adaptersServerSide = _s2sConfig.bidders;\n    var s2sAdapter = _bidderRegistry[_s2sConfig.adapter];\n    var tid = serverBidRequests[0].tid;\n    var adUnitsS2SCopy = serverBidRequests[0].adUnitsS2SCopy;\n    adUnitsS2SCopy.forEach(function (adUnitCopy) {\n      var validBids = adUnitCopy.bids.filter(function (bid) {\n        return (0, _find2.default)(serverBidRequests, function (request) {\n          return request.bidderCode === bid.bidder && (0, _find2.default)(request.bids, function (reqBid) {\n            return reqBid.adUnitCode === adUnitCopy.code;\n          });\n        });\n      });\n      adUnitCopy.bids = validBids;\n    });\n\n    adUnitsS2SCopy = adUnitsS2SCopy.filter(function (adUnitCopy) {\n      return adUnitCopy.bids.length > 0;\n    });\n\n    if (s2sAdapter) {\n      var s2sBidRequest = { tid: tid, 'ad_units': adUnitsS2SCopy };\n      if (s2sBidRequest.ad_units.length) {\n        var doneCbs = serverBidRequests.map(function (bidRequest) {\n          bidRequest.start = (0, _utils.timestamp)();\n          bidRequest.doneCbCallCount = 0;\n          return doneCb(bidRequest.bidderRequestId);\n        });\n\n        // only log adapters that actually have adUnit bids\n        var allBidders = s2sBidRequest.ad_units.reduce(function (adapters, adUnit) {\n          return adapters.concat((adUnit.bids || []).reduce(function (adapters, bid) {\n            return adapters.concat(bid.bidder);\n          }, []));\n        }, []);\n        utils.logMessage('CALLING S2S HEADER BIDDERS ==== ' + adaptersServerSide.filter(function (adapter) {\n          return (0, _includes2.default)(allBidders, adapter);\n        }).join(','));\n\n        // fire BID_REQUESTED event for each s2s bidRequest\n        serverBidRequests.forEach(function (bidRequest) {\n          events.emit(CONSTANTS.EVENTS.BID_REQUESTED, bidRequest);\n        });\n\n        // make bid requests\n        s2sAdapter.callBids(s2sBidRequest, serverBidRequests, addBidResponse, function () {\n          return doneCbs.forEach(function (done) {\n            return done();\n          });\n        }, ajax);\n      }\n    }\n  }\n\n  // handle client adapter requests\n  clientBidRequests.forEach(function (bidRequest) {\n    bidRequest.start = (0, _utils.timestamp)();\n    // TODO : Do we check for bid in pool from here and skip calling adapter again ?\n    var adapter = _bidderRegistry[bidRequest.bidderCode];\n    if (adapter) {\n      utils.logMessage('CALLING BIDDER ======= ' + bidRequest.bidderCode);\n      events.emit(CONSTANTS.EVENTS.BID_REQUESTED, bidRequest);\n      bidRequest.doneCbCallCount = 0;\n      var done = doneCb(bidRequest.bidderRequestId);\n      adapter.callBids(bidRequest, addBidResponse, done, ajax);\n    } else {\n      utils.logError('Adapter trying to be called which does not exist: ' + bidRequest.bidderCode + ' adaptermanager.callBids');\n    }\n  });\n};\n\nfunction doingS2STesting() {\n  return _s2sConfig && _s2sConfig.enabled && _s2sConfig.testing && s2sTestingModule;\n}\n\nfunction getSupportedMediaTypes(bidderCode) {\n  var result = [];\n  if ((0, _includes2.default)(exports.videoAdapters, bidderCode)) result.push('video');\n  if ((0, _includes2.default)(_native.nativeAdapters, bidderCode)) result.push('native');\n  return result;\n}\n\nexports.videoAdapters = []; // added by adapterLoader for now\n\nexports.registerBidAdapter = function (bidAdaptor, bidderCode) {\n  var _ref2 = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {},\n      _ref2$supportedMediaT = _ref2.supportedMediaTypes,\n      supportedMediaTypes = _ref2$supportedMediaT === undefined ? [] : _ref2$supportedMediaT;\n\n  if (bidAdaptor && bidderCode) {\n    if (typeof bidAdaptor.callBids === 'function') {\n      _bidderRegistry[bidderCode] = bidAdaptor;\n\n      if ((0, _includes2.default)(supportedMediaTypes, 'video')) {\n        exports.videoAdapters.push(bidderCode);\n      }\n      if ((0, _includes2.default)(supportedMediaTypes, 'native')) {\n        _native.nativeAdapters.push(bidderCode);\n      }\n    } else {\n      utils.logError('Bidder adaptor error for bidder code: ' + bidderCode + 'bidder must implement a callBids() function');\n    }\n  } else {\n    utils.logError('bidAdaptor or bidderCode not specified');\n  }\n};\n\nexports.aliasBidAdapter = function (bidderCode, alias) {\n  var existingAlias = _bidderRegistry[alias];\n\n  if (typeof existingAlias === 'undefined') {\n    var bidAdaptor = _bidderRegistry[bidderCode];\n    if (typeof bidAdaptor === 'undefined') {\n      utils.logError('bidderCode \"' + bidderCode + '\" is not an existing bidder.', 'adaptermanager.aliasBidAdapter');\n    } else {\n      try {\n        var newAdapter = void 0;\n        var supportedMediaTypes = getSupportedMediaTypes(bidderCode);\n        // Have kept old code to support backward compatibilitiy.\n        // Remove this if loop when all adapters are supporting bidderFactory. i.e When Prebid.js is 1.0\n        if (bidAdaptor.constructor.prototype != Object.prototype) {\n          newAdapter = new bidAdaptor.constructor();\n          newAdapter.setBidderCode(alias);\n        } else {\n          var spec = bidAdaptor.getSpec();\n          newAdapter = (0, _bidderFactory.newBidder)(_extends({}, spec, { code: alias }));\n          exports.aliasRegistry[alias] = bidderCode;\n        }\n        this.registerBidAdapter(newAdapter, alias, {\n          supportedMediaTypes: supportedMediaTypes\n        });\n      } catch (e) {\n        utils.logError(bidderCode + ' bidder does not currently support aliasing.', 'adaptermanager.aliasBidAdapter');\n      }\n    }\n  } else {\n    utils.logMessage('alias name \"' + alias + '\" has been already specified.');\n  }\n};\n\nexports.registerAnalyticsAdapter = function (_ref3) {\n  var adapter = _ref3.adapter,\n      code = _ref3.code;\n\n  if (adapter && code) {\n    if (typeof adapter.enableAnalytics === 'function') {\n      adapter.code = code;\n      _analyticsRegistry[code] = adapter;\n    } else {\n      utils.logError('Prebid Error: Analytics adaptor error for analytics \"' + code + '\"\\n        analytics adapter must implement an enableAnalytics() function');\n    }\n  } else {\n    utils.logError('Prebid Error: analyticsAdapter or analyticsCode not specified');\n  }\n};\n\nexports.enableAnalytics = function (config) {\n  if (!utils.isArray(config)) {\n    config = [config];\n  }\n\n  utils._each(config, function (adapterConfig) {\n    var adapter = _analyticsRegistry[adapterConfig.provider];\n    if (adapter) {\n      adapter.enableAnalytics(adapterConfig);\n    } else {\n      utils.logError('Prebid Error: no analytics adapter found in registry for\\n        ' + adapterConfig.provider + '.');\n    }\n  });\n};\n\nexports.getBidAdapter = function (bidder) {\n  return _bidderRegistry[bidder];\n};\n\n// the s2sTesting module is injected when it's loaded rather than being imported\n// importing it causes the packager to include it even when it's not explicitly included in the build\nexports.setS2STestingModule = function (module) {\n  s2sTestingModule = module;\n};\n\nexports.callTimedOutBidders = function (adUnits, timedOutBidders, cbTimeout) {\n  timedOutBidders = timedOutBidders.map(function (timedOutBidder) {\n    // Adding user configured params & timeout to timeout event data\n    timedOutBidder.params = utils.getUserConfiguredParams(adUnits, timedOutBidder.adUnitCode, timedOutBidder.bidder);\n    timedOutBidder.timeout = cbTimeout;\n    return timedOutBidder;\n  });\n  timedOutBidders = utils.groupBy(timedOutBidders, 'bidder');\n\n  Object.keys(timedOutBidders).forEach(function (bidder) {\n    try {\n      var adapter = _bidderRegistry[bidder];\n      var spec = adapter.getSpec();\n      if (spec && spec.onTimeout && typeof spec.onTimeout === 'function') {\n        utils.logInfo('Invoking ' + bidder + '.onTimeout');\n        spec.onTimeout(timedOutBidders[bidder]);\n      }\n    } catch (e) {\n      utils.logWarn('Error calling onTimeout of ' + bidder);\n    }\n  });\n};\n\n/***/ }),\n\n/***/ 9:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\n/**\n * events.js\n */\nvar utils = __webpack_require__(0);\nvar CONSTANTS = __webpack_require__(2);\nvar slice = Array.prototype.slice;\nvar push = Array.prototype.push;\n\n// define entire events\n// var allEvents = ['bidRequested','bidResponse','bidWon','bidTimeout'];\nvar allEvents = utils._map(CONSTANTS.EVENTS, function (v) {\n  return v;\n});\n\nvar idPaths = CONSTANTS.EVENT_ID_PATHS;\n\n// keep a record of all events fired\nvar eventsFired = [];\n\nmodule.exports = function () {\n  var _handlers = {};\n  var _public = {};\n\n  /**\n   *\n   * @param {String} eventString  The name of the event.\n   * @param {Array} args  The payload emitted with the event.\n   * @private\n   */\n  function _dispatch(eventString, args) {\n    utils.logMessage('Emitting event for: ' + eventString);\n\n    var eventPayload = args[0] || {};\n    var idPath = idPaths[eventString];\n    var key = eventPayload[idPath];\n    var event = _handlers[eventString] || { que: [] };\n    var eventKeys = utils._map(event, function (v, k) {\n      return k;\n    });\n\n    var callbacks = [];\n\n    // record the event:\n    eventsFired.push({\n      eventType: eventString,\n      args: eventPayload,\n      id: key\n    });\n\n    /** Push each specific callback to the `callbacks` array.\n     * If the `event` map has a key that matches the value of the\n     * event payload id path, e.g. `eventPayload[idPath]`, then apply\n     * each function in the `que` array as an argument to push to the\n     * `callbacks` array\n     * */\n    if (key && utils.contains(eventKeys, key)) {\n      push.apply(callbacks, event[key].que);\n    }\n\n    /** Push each general callback to the `callbacks` array. */\n    push.apply(callbacks, event.que);\n\n    /** call each of the callbacks */\n    utils._each(callbacks, function (fn) {\n      if (!fn) return;\n      try {\n        fn.apply(null, args);\n      } catch (e) {\n        utils.logError('Error executing handler:', 'events.js', e);\n      }\n    });\n  }\n\n  function _checkAvailableEvent(event) {\n    return utils.contains(allEvents, event);\n  }\n\n  _public.on = function (eventString, handler, id) {\n    // check whether available event or not\n    if (_checkAvailableEvent(eventString)) {\n      var event = _handlers[eventString] || { que: [] };\n\n      if (id) {\n        event[id] = event[id] || { que: [] };\n        event[id].que.push(handler);\n      } else {\n        event.que.push(handler);\n      }\n\n      _handlers[eventString] = event;\n    } else {\n      utils.logError('Wrong event name : ' + eventString + ' Valid event names :' + allEvents);\n    }\n  };\n\n  _public.emit = function (event) {\n    var args = slice.call(arguments, 1);\n    _dispatch(event, args);\n  };\n\n  _public.off = function (eventString, handler, id) {\n    var event = _handlers[eventString];\n\n    if (utils.isEmpty(event) || utils.isEmpty(event.que) && utils.isEmpty(event[id])) {\n      return;\n    }\n\n    if (id && (utils.isEmpty(event[id]) || utils.isEmpty(event[id].que))) {\n      return;\n    }\n\n    if (id) {\n      utils._each(event[id].que, function (_handler) {\n        var que = event[id].que;\n        if (_handler === handler) {\n          que.splice(utils.indexOf.call(que, _handler), 1);\n        }\n      });\n    } else {\n      utils._each(event.que, function (_handler) {\n        var que = event.que;\n        if (_handler === handler) {\n          que.splice(utils.indexOf.call(que, _handler), 1);\n        }\n      });\n    }\n\n    _handlers[eventString] = event;\n  };\n\n  _public.get = function () {\n    return _handlers;\n  };\n\n  /**\n   * This method can return a copy of all the events fired\n   * @return {Array} array of events fired\n   */\n  _public.getEvents = function () {\n    var arrayCopy = [];\n    utils._each(eventsFired, function (value) {\n      var newProp = _extends({}, value);\n      arrayCopy.push(newProp);\n    });\n\n    return arrayCopy;\n  };\n\n  return _public;\n}();\n\n/***/ })\n\n/******/ });\n\npbjsChunk([111],{\n\n/***/ 113:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(114);\nmodule.exports = __webpack_require__(115);\n\n\n/***/ }),\n\n/***/ 114:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.spec = undefined;\n\nvar _templateObject = _taggedTemplateLiteral(['//', '/pubapi/3.0/', '/', '/', '/', '/ADTECH;v=2;cmd=bid;cors=yes;alias=', ';misc=', '', '', '', ''], ['//', '/pubapi/3.0/', '/', '/', '/', '/ADTECH;v=2;cmd=bid;cors=yes;alias=', ';misc=', '', '', '', '']),\n    _templateObject2 = _taggedTemplateLiteral(['//', '/bidRequest?'], ['//', '/bidRequest?']),\n    _templateObject3 = _taggedTemplateLiteral(['dcn=', '&pos=', '&cmd=bid', ''], ['dcn=', '&pos=', '&cmd=bid', '']);\n\nvar _utils = __webpack_require__(0);\n\nvar utils = _interopRequireWildcard(_utils);\n\nvar _bidderFactory = __webpack_require__(1);\n\nvar _config = __webpack_require__(4);\n\nvar _constants = __webpack_require__(2);\n\nvar _mediaTypes = __webpack_require__(3);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _taggedTemplateLiteral(strings, raw) { return Object.freeze(Object.defineProperties(strings, { raw: { value: Object.freeze(raw) } })); }\n\nvar AOL_BIDDERS_CODES = {\n  AOL: 'aol',\n  ONEMOBILE: 'onemobile',\n  ONEDISPLAY: 'onedisplay'\n};\n\nvar AOL_ENDPOINTS = {\n  DISPLAY: {\n    GET: 'display-get'\n  },\n  MOBILE: {\n    GET: 'mobile-get',\n    POST: 'mobile-post'\n  }\n};\n\nvar SYNC_TYPES = {\n  IFRAME: {\n    TAG: 'iframe',\n    TYPE: 'iframe'\n  },\n  IMAGE: {\n    TAG: 'img',\n    TYPE: 'image'\n  }\n};\n\nvar pubapiTemplate = template(_templateObject, 'host', 'network', 'placement', 'pageid', 'sizeid', 'alias', 'misc', 'bidfloor', 'keyValues', 'consentData');\nvar nexageBaseApiTemplate = template(_templateObject2, 'host');\nvar nexageGetApiTemplate = template(_templateObject3, 'dcn', 'pos', 'dynamicParams');\nvar MP_SERVER_MAP = {\n  us: 'adserver-us.adtech.advertising.com',\n  eu: 'adserver-eu.adtech.advertising.com',\n  as: 'adserver-as.adtech.advertising.com'\n};\nvar NEXAGE_SERVER = 'hb.nexage.com';\nvar ONE_DISPLAY_TTL = 60;\nvar ONE_MOBILE_TTL = 3600;\n\npbjs.aolGlobals = {\n  pixelsDropped: false\n};\n\nvar showCpmAdjustmentWarning = function () {\n  var showCpmWarning = true;\n\n  return function () {\n    var bidderSettings = pbjs.bidderSettings;\n    if (showCpmWarning && bidderSettings && bidderSettings.aol && typeof bidderSettings.aol.bidCpmAdjustment === 'function') {\n      utils.logWarn('bidCpmAdjustment is active for the AOL adapter. ' + 'As of Prebid 0.14, AOL can bid in net – please contact your accounts team to enable.');\n      showCpmWarning = false; // warning is shown at most once\n    }\n  };\n}();\n\nfunction template(strings) {\n  for (var _len = arguments.length, keys = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {\n    keys[_key - 1] = arguments[_key];\n  }\n\n  return function () {\n    for (var _len2 = arguments.length, values = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n      values[_key2] = arguments[_key2];\n    }\n\n    var dict = values[values.length - 1] || {};\n    var result = [strings[0]];\n    keys.forEach(function (key, i) {\n      var value = utils.isInteger(key) ? values[key] : dict[key];\n      result.push(value, strings[i + 1]);\n    });\n    return result.join('');\n  };\n}\n\nfunction parsePixelItems(pixels) {\n  var itemsRegExp = /(img|iframe)[\\s\\S]*?src\\s*=\\s*(\"|')(.*?)\\2/gi;\n  var tagNameRegExp = /\\w*(?=\\s)/;\n  var srcRegExp = /src=(\"|')(.*?)\\1/;\n  var pixelsItems = [];\n\n  if (pixels) {\n    var matchedItems = pixels.match(itemsRegExp);\n    if (matchedItems) {\n      matchedItems.forEach(function (item) {\n        var tagName = item.match(tagNameRegExp)[0];\n        var url = item.match(srcRegExp)[2];\n\n        if (tagName && tagName) {\n          pixelsItems.push({\n            type: tagName === SYNC_TYPES.IMAGE.TAG ? SYNC_TYPES.IMAGE.TYPE : SYNC_TYPES.IFRAME.TYPE,\n            url: url\n          });\n        }\n      });\n    }\n  }\n\n  return pixelsItems;\n}\n\nfunction formatMarketplaceBidFloor(bidFloor) {\n  return typeof bidFloor !== 'undefined' ? ';bidfloor=' + bidFloor.toString() : '';\n}\n\nfunction formatMarketplaceKeyValues(keyValues) {\n  var formattedKeyValues = '';\n\n  utils._each(keyValues, function (value, key) {\n    formattedKeyValues += ';kv' + key + '=' + encodeURIComponent(value);\n  });\n\n  return formattedKeyValues;\n}\n\nfunction _isMarketplaceBidder(bidder) {\n  return bidder === AOL_BIDDERS_CODES.AOL || bidder === AOL_BIDDERS_CODES.ONEDISPLAY;\n}\n\nfunction _isOneMobileBidder(bidderCode) {\n  return bidderCode === AOL_BIDDERS_CODES.AOL || bidderCode === AOL_BIDDERS_CODES.ONEMOBILE;\n}\n\nfunction _isNexageRequestPost(bid) {\n  if (_isOneMobileBidder(bid.bidder) && bid.params.id && bid.params.imp && bid.params.imp[0]) {\n    var imp = bid.params.imp[0];\n    return imp.id && imp.tagid && (imp.banner && imp.banner.w && imp.banner.h || imp.video && imp.video.mimes && imp.video.minduration && imp.video.maxduration);\n  }\n}\n\nfunction _isNexageRequestGet(bid) {\n  return _isOneMobileBidder(bid.bidder) && bid.params.dcn && bid.params.pos;\n}\n\nfunction isMarketplaceBid(bid) {\n  return _isMarketplaceBidder(bid.bidder) && bid.params.placement && bid.params.network;\n}\n\nfunction isMobileBid(bid) {\n  return _isNexageRequestGet(bid) || _isNexageRequestPost(bid);\n}\n\nfunction resolveEndpointCode(bid) {\n  if (_isNexageRequestGet(bid)) {\n    return AOL_ENDPOINTS.MOBILE.GET;\n  } else if (_isNexageRequestPost(bid)) {\n    return AOL_ENDPOINTS.MOBILE.POST;\n  } else if (isMarketplaceBid(bid)) {\n    return AOL_ENDPOINTS.DISPLAY.GET;\n  }\n}\n\nvar spec = exports.spec = {\n  code: AOL_BIDDERS_CODES.AOL,\n  aliases: [AOL_BIDDERS_CODES.ONEMOBILE, AOL_BIDDERS_CODES.ONEDISPLAY],\n  supportedMediaTypes: [_mediaTypes.BANNER],\n  isBidRequestValid: function isBidRequestValid(bid) {\n    return isMarketplaceBid(bid) || isMobileBid(bid);\n  },\n  buildRequests: function buildRequests(bids, bidderRequest) {\n    var _this = this;\n\n    var consentData = bidderRequest ? bidderRequest.gdprConsent : null;\n\n    return bids.map(function (bid) {\n      var endpointCode = resolveEndpointCode(bid);\n\n      if (endpointCode) {\n        return _this.formatBidRequest(endpointCode, bid, consentData);\n      }\n    });\n  },\n  interpretResponse: function interpretResponse(_ref, bidRequest) {\n    var body = _ref.body;\n\n    showCpmAdjustmentWarning();\n\n    if (!body) {\n      utils.logError('Empty bid response', bidRequest.bidderCode, body);\n    } else {\n      var _bid = this._parseBidResponse(body, bidRequest);\n\n      if (_bid) {\n        return _bid;\n      }\n    }\n  },\n  getUserSyncs: function getUserSyncs(options, bidResponses) {\n    var bidResponse = bidResponses[0];\n\n    if (_config.config.getConfig('aol.userSyncOn') === _constants.EVENTS.BID_RESPONSE) {\n      if (!pbjs.aolGlobals.pixelsDropped && bidResponse && bidResponse.ext && bidResponse.ext.pixels) {\n        pbjs.aolGlobals.pixelsDropped = true;\n\n        return parsePixelItems(bidResponse.ext.pixels);\n      }\n    }\n\n    return [];\n  },\n  formatBidRequest: function formatBidRequest(endpointCode, bid, consentData) {\n    var bidRequest = void 0;\n\n    switch (endpointCode) {\n      case AOL_ENDPOINTS.DISPLAY.GET:\n        bidRequest = {\n          url: this.buildMarketplaceUrl(bid, consentData),\n          method: 'GET',\n          ttl: ONE_DISPLAY_TTL\n        };\n        break;\n\n      case AOL_ENDPOINTS.MOBILE.GET:\n        bidRequest = {\n          url: this.buildOneMobileGetUrl(bid, consentData),\n          method: 'GET',\n          ttl: ONE_MOBILE_TTL\n        };\n        break;\n\n      case AOL_ENDPOINTS.MOBILE.POST:\n        bidRequest = {\n          url: this.buildOneMobileBaseUrl(bid),\n          method: 'POST',\n          ttl: ONE_MOBILE_TTL,\n          data: this.buildOpenRtbRequestData(bid, consentData),\n          options: {\n            contentType: 'application/json',\n            customHeaders: {\n              'x-openrtb-version': '2.2'\n            }\n          }\n        };\n        break;\n    }\n\n    bidRequest.bidderCode = bid.bidder;\n    bidRequest.bidId = bid.bidId;\n    bidRequest.userSyncOn = bid.params.userSyncOn;\n\n    return bidRequest;\n  },\n  buildMarketplaceUrl: function buildMarketplaceUrl(bid, consentData) {\n    var params = bid.params;\n    var serverParam = params.server;\n    var regionParam = params.region || 'us';\n    var server = void 0;\n\n    if (!MP_SERVER_MAP.hasOwnProperty(regionParam)) {\n      utils.logWarn('Unknown region \\'' + regionParam + '\\' for AOL bidder.');\n      regionParam = 'us'; // Default region.\n    }\n\n    if (serverParam) {\n      server = serverParam;\n    } else {\n      server = MP_SERVER_MAP[regionParam];\n    }\n\n    // Set region param, used by AOL analytics.\n    params.region = regionParam;\n\n    return pubapiTemplate({\n      host: server,\n      network: params.network,\n      placement: parseInt(params.placement),\n      pageid: params.pageId || 0,\n      sizeid: params.sizeId || 0,\n      alias: params.alias || utils.getUniqueIdentifierStr(),\n      misc: new Date().getTime(), // cache busting,\n      bidfloor: formatMarketplaceBidFloor(params.bidFloor),\n      keyValues: formatMarketplaceKeyValues(params.keyValues),\n      consentData: this.formatMarketplaceConsentData(consentData)\n    });\n  },\n  buildOneMobileGetUrl: function buildOneMobileGetUrl(bid, consentData) {\n    var _bid$params = bid.params,\n        dcn = _bid$params.dcn,\n        pos = _bid$params.pos,\n        ext = _bid$params.ext;\n\n    var nexageApi = this.buildOneMobileBaseUrl(bid);\n    if (dcn && pos) {\n      var dynamicParams = this.formatOneMobileDynamicParams(ext, consentData);\n      nexageApi += nexageGetApiTemplate({ dcn: dcn, pos: pos, dynamicParams: dynamicParams });\n    }\n    return nexageApi;\n  },\n  buildOneMobileBaseUrl: function buildOneMobileBaseUrl(bid) {\n    return nexageBaseApiTemplate({\n      host: bid.params.host || NEXAGE_SERVER\n    });\n  },\n  formatOneMobileDynamicParams: function formatOneMobileDynamicParams() {\n    var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var consentData = arguments[1];\n\n    if (this.isSecureProtocol()) {\n      params.secure = 1;\n    }\n\n    if (this.isConsentRequired(consentData)) {\n      params.euconsent = consentData.consentString;\n      params.gdpr = 1;\n    }\n\n    var paramsFormatted = '';\n    utils._each(params, function (value, key) {\n      paramsFormatted += '&' + key + '=' + encodeURIComponent(value);\n    });\n\n    return paramsFormatted;\n  },\n  buildOpenRtbRequestData: function buildOpenRtbRequestData(bid, consentData) {\n    var openRtbObject = {\n      id: bid.params.id,\n      imp: bid.params.imp\n    };\n\n    if (this.isConsentRequired(consentData)) {\n      openRtbObject.user = {\n        ext: {\n          consent: consentData.consentString\n        }\n      };\n      openRtbObject.regs = {\n        ext: {\n          gdpr: 1\n        }\n      };\n    }\n\n    return openRtbObject;\n  },\n  isConsentRequired: function isConsentRequired(consentData) {\n    return !!(consentData && consentData.consentString && consentData.gdprApplies);\n  },\n  formatMarketplaceConsentData: function formatMarketplaceConsentData(consentData) {\n    var consentRequired = this.isConsentRequired(consentData);\n\n    return consentRequired ? ';euconsent=' + consentData.consentString + ';gdpr=1' : '';\n  },\n  _parseBidResponse: function _parseBidResponse(response, bidRequest) {\n    var bidData = void 0;\n\n    try {\n      bidData = response.seatbid[0].bid[0];\n    } catch (e) {\n      return;\n    }\n\n    var cpm = void 0;\n\n    if (bidData.ext && bidData.ext.encp) {\n      cpm = bidData.ext.encp;\n    } else {\n      cpm = bidData.price;\n\n      if (cpm === null || isNaN(cpm)) {\n        utils.logError('Invalid price in bid response', AOL_BIDDERS_CODES.AOL, bid);\n        return;\n      }\n    }\n\n    var bidResponse = {\n      bidderCode: bidRequest.bidderCode,\n      requestId: bidRequest.bidId,\n      ad: bidData.adm,\n      cpm: cpm,\n      width: bidData.w,\n      height: bidData.h,\n      creativeId: bidData.crid,\n      pubapiId: response.id,\n      currency: response.cur,\n      dealId: bidData.dealid,\n      netRevenue: true,\n      ttl: bidRequest.ttl\n    };\n\n    if (response.ext && response.ext.pixels) {\n      if (_config.config.getConfig('aol.userSyncOn') !== _constants.EVENTS.BID_RESPONSE) {\n        bidResponse.ad += this.formatPixels(response.ext.pixels);\n      }\n    }\n\n    return bidResponse;\n  },\n  formatPixels: function formatPixels(pixels) {\n    var formattedPixels = pixels.replace(/<\\/?script( type=('|\")text\\/javascript('|\")|)?>/g, '');\n\n    return '<script>var w=window,prebid;' + 'for(var i=0;i<10;i++){w = w.parent;prebid=w.pbjs;' + 'if(prebid && prebid.aolGlobals && !prebid.aolGlobals.pixelsDropped){' + 'try{prebid.aolGlobals.pixelsDropped=true;' + formattedPixels + 'break;}' + 'catch(e){continue;}' + '}}</script>';\n  },\n\n  isOneMobileBidder: _isOneMobileBidder,\n  isSecureProtocol: function isSecureProtocol() {\n    return document.location.protocol === 'https:';\n  }\n};\n\n(0, _bidderFactory.registerBidder)(spec);\n\n/***/ }),\n\n/***/ 115:\n/***/ (function(module, exports) {\n\n\n\n/***/ })\n\n},[113]);\n\npbjsChunk([109],{\n\n/***/ 118:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(119);\nmodule.exports = __webpack_require__(120);\n\n\n/***/ }),\n\n/***/ 119:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.spec = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _Renderer = __webpack_require__(14);\n\nvar _utils = __webpack_require__(0);\n\nvar utils = _interopRequireWildcard(_utils);\n\nvar _bidderFactory = __webpack_require__(1);\n\nvar _mediaTypes = __webpack_require__(3);\n\nvar _find = __webpack_require__(10);\n\nvar _find2 = _interopRequireDefault(_find);\n\nvar _includes = __webpack_require__(7);\n\nvar _includes2 = _interopRequireDefault(_includes);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nvar BIDDER_CODE = 'appnexus';\nvar URL = '//ib.adnxs.com/ut/v3/prebid';\nvar VIDEO_TARGETING = ['id', 'mimes', 'minduration', 'maxduration', 'startdelay', 'skippable', 'playback_method', 'frameworks'];\nvar USER_PARAMS = ['age', 'external_uid', 'segments', 'gender', 'dnt', 'language'];\nvar NATIVE_MAPPING = {\n  body: 'description',\n  cta: 'ctatext',\n  image: {\n    serverName: 'main_image',\n    requiredParams: { required: true },\n    minimumParams: { sizes: [{}] }\n  },\n  icon: {\n    serverName: 'icon',\n    requiredParams: { required: true },\n    minimumParams: { sizes: [{}] }\n  },\n  sponsoredBy: 'sponsored_by'\n};\nvar SOURCE = 'pbjs';\nvar ENABLE_VIDEO_RENDERER = false;\n\nvar spec = exports.spec = {\n  code: BIDDER_CODE,\n  aliases: ['appnexusAst', 'brealtime', 'pagescience', 'defymedia', 'gourmetads', 'matomy', 'featureforward', 'oftmedia', 'districtm'],\n  supportedMediaTypes: [_mediaTypes.BANNER, _mediaTypes.VIDEO, _mediaTypes.NATIVE],\n\n  /**\n   * Determines whether or not the given bid request is valid.\n   *\n   * @param {object} bid The bid to validate.\n   * @return boolean True if this is a valid bid, and false otherwise.\n   */\n  isBidRequestValid: function isBidRequestValid(bid) {\n    return !!(bid.params.placementId || bid.params.member && bid.params.invCode);\n  },\n\n  /**\n   * Make a server request from the list of BidRequests.\n   *\n   * @param {BidRequest[]} bidRequests A non-empty list of bid requests which should be sent to the Server.\n   * @return ServerRequest Info describing the request to the server.\n   */\n  buildRequests: function buildRequests(bidRequests, bidderRequest) {\n    var tags = bidRequests.map(bidToTag);\n    var userObjBid = (0, _find2.default)(bidRequests, hasUserInfo);\n    var userObj = void 0;\n    if (userObjBid) {\n      userObj = {};\n      Object.keys(userObjBid.params.user).filter(function (param) {\n        return (0, _includes2.default)(USER_PARAMS, param);\n      }).forEach(function (param) {\n        return userObj[param] = userObjBid.params.user[param];\n      });\n    }\n\n    var memberIdBid = (0, _find2.default)(bidRequests, hasMemberId);\n    var member = memberIdBid ? parseInt(memberIdBid.params.member, 10) : 0;\n\n    var payload = {\n      tags: [].concat(_toConsumableArray(tags)),\n      user: userObj,\n      sdk: {\n        source: SOURCE,\n        version: '1.11.0'\n      }\n    };\n    if (member > 0) {\n      payload.member_id = member;\n    }\n\n    if (bidderRequest && bidderRequest.gdprConsent) {\n      // note - objects for impbus use underscore instead of camelCase\n      payload.gdpr_consent = {\n        consent_string: bidderRequest.gdprConsent.consentString,\n        consent_required: bidderRequest.gdprConsent.gdprApplies\n      };\n    }\n\n    var payloadString = JSON.stringify(payload);\n    return {\n      method: 'POST',\n      url: URL,\n      data: payloadString,\n      bidderRequest: bidderRequest\n    };\n  },\n\n  /**\n   * Unpack the response from the server into a list of bids.\n   *\n   * @param {*} serverResponse A successful response from the server.\n   * @return {Bid[]} An array of bids which were nested inside the server.\n   */\n  interpretResponse: function interpretResponse(serverResponse, _ref) {\n    var _this = this;\n\n    var bidderRequest = _ref.bidderRequest;\n\n    serverResponse = serverResponse.body;\n    var bids = [];\n    if (!serverResponse || serverResponse.error) {\n      var errorMessage = 'in response for ' + bidderRequest.bidderCode + ' adapter';\n      if (serverResponse && serverResponse.error) {\n        errorMessage += ': ' + serverResponse.error;\n      }\n      utils.logError(errorMessage);\n      return bids;\n    }\n\n    if (serverResponse.tags) {\n      serverResponse.tags.forEach(function (serverBid) {\n        var rtbBid = getRtbBid(serverBid);\n        if (rtbBid) {\n          // WIKIA_CHANGE: 0 is also a valid information for us\n          if (isFinite(rtbBid.cpm) && (0, _includes2.default)(_this.supportedMediaTypes, rtbBid.ad_type)) {\n            var bid = newBid(serverBid, rtbBid, bidderRequest);\n            bid.mediaType = parseMediaType(rtbBid);\n            bids.push(bid);\n          }\n        }\n      });\n    }\n    return bids;\n  },\n\n  getUserSyncs: function getUserSyncs(syncOptions) {\n    if (syncOptions.iframeEnabled) {\n      return [{\n        type: 'iframe',\n        url: '//acdn.adnxs.com/ib/static/usersync/v3/async_usersync.html'\n      }];\n    }\n  }\n};\n\nfunction newRenderer(adUnitCode, rtbBid) {\n  var rendererOptions = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  var renderer = _Renderer.Renderer.install({\n    id: rtbBid.renderer_id,\n    url: rtbBid.renderer_url,\n    config: rendererOptions,\n    loaded: false\n  });\n\n  try {\n    renderer.setRender(outstreamRender);\n  } catch (err) {\n    utils.logWarn('Prebid Error calling setRender on renderer', err);\n  }\n\n  renderer.setEventHandlers({\n    impression: function impression() {\n      return utils.logMessage('AppNexus outstream video impression event');\n    },\n    loaded: function loaded() {\n      return utils.logMessage('AppNexus outstream video loaded event');\n    },\n    ended: function ended() {\n      utils.logMessage('AppNexus outstream renderer video event');\n      document.querySelector('#' + adUnitCode).style.display = 'none';\n    }\n  });\n  return renderer;\n}\n\n/* Turn keywords parameter into ut-compatible format */\nfunction getKeywords(keywords) {\n  var arrs = [];\n\n  utils._each(keywords, function (v, k) {\n    if (utils.isArray(v)) {\n      var values = [];\n      utils._each(v, function (val) {\n        val = utils.getValueString('keywords.' + k, val);\n        if (val) {\n          values.push(val);\n        }\n      });\n      v = values;\n    } else {\n      v = utils.getValueString('keywords.' + k, v);\n      if (utils.isStr(v)) {\n        v = [v];\n      } else {\n        return;\n      } // unsuported types - don't send a key\n    }\n    arrs.push({ key: k, value: v });\n  });\n\n  return arrs;\n}\n\n/**\n * Unpack the Server's Bid into a Prebid-compatible one.\n * @param serverBid\n * @param rtbBid\n * @param bidderRequest\n * @return Bid\n */\nfunction newBid(serverBid, rtbBid, bidderRequest) {\n  var bid = {\n    requestId: serverBid.uuid,\n    cpm: rtbBid.cpm,\n    creativeId: rtbBid.creative_id,\n    dealId: rtbBid.deal_id,\n    currency: 'USD',\n    netRevenue: true,\n    ttl: 300,\n    appnexus: {\n      buyerMemberId: rtbBid.buyer_member_id\n    }\n  };\n\n  if (rtbBid.rtb.video) {\n    _extends(bid, {\n      // WIKIA_CHANGE: When 0 is returned by AppNexus size is not set - we want to fallback to 0 instead of undefined\n      width: rtbBid.rtb.video.player_width || 0,\n      height: rtbBid.rtb.video.player_height || 0,\n      vastUrl: rtbBid.rtb.video.asset_url,\n      vastImpUrl: rtbBid.notify_url,\n      // WIKIA_CHANGE: Expose VAST content\n      vastContent: rtbBid.rtb.video.content,\n      ttl: 3600\n    });\n    // This supports Outstream Video\n    // WIKIA_CHANGE: we want to disable ANOutstreamVideo renderer\n    if (rtbBid.renderer_url && ENABLE_VIDEO_RENDERER) {\n      var rendererOptions = utils.deepAccess(bidderRequest.bids[0], 'renderer.options');\n\n      _extends(bid, {\n        adResponse: serverBid,\n        renderer: newRenderer(bid.adUnitCode, rtbBid, rendererOptions)\n      });\n      bid.adResponse.ad = bid.adResponse.ads[0];\n      bid.adResponse.ad.video = bid.adResponse.ad.rtb.video;\n    }\n  } else if (rtbBid.rtb[_mediaTypes.NATIVE]) {\n    var nativeAd = rtbBid.rtb[_mediaTypes.NATIVE];\n    bid[_mediaTypes.NATIVE] = {\n      title: nativeAd.title,\n      body: nativeAd.desc,\n      cta: nativeAd.ctatext,\n      sponsoredBy: nativeAd.sponsored,\n      clickUrl: nativeAd.link.url,\n      clickTrackers: nativeAd.link.click_trackers,\n      impressionTrackers: nativeAd.impression_trackers,\n      javascriptTrackers: nativeAd.javascript_trackers\n    };\n    if (nativeAd.main_img) {\n      bid['native'].image = {\n        url: nativeAd.main_img.url,\n        height: nativeAd.main_img.height,\n        width: nativeAd.main_img.width\n      };\n    }\n    if (nativeAd.icon) {\n      bid['native'].icon = {\n        url: nativeAd.icon.url,\n        height: nativeAd.icon.height,\n        width: nativeAd.icon.width\n      };\n    }\n  } else {\n    _extends(bid, {\n      // WIKIA_CHANGE: When 0 is returned by AppNexus size is not set - we want to fallback to 0 instead of undefined\n      width: rtbBid.rtb.banner.width || 0,\n      height: rtbBid.rtb.banner.height || 0,\n      ad: rtbBid.rtb.banner.content\n    });\n    try {\n      var url = rtbBid.rtb.trackers[0].impression_urls[0];\n      var tracker = utils.createTrackPixelHtml(url);\n      bid.ad += tracker;\n    } catch (error) {\n      utils.logError('Error appending tracking pixel', error);\n    }\n  }\n\n  return bid;\n}\n\nfunction bidToTag(bid) {\n  var tag = {};\n  tag.sizes = transformSizes(bid.sizes);\n  tag.primary_size = tag.sizes[0];\n  tag.ad_types = [];\n  tag.uuid = bid.bidId;\n  if (bid.params.placementId) {\n    tag.id = parseInt(bid.params.placementId, 10);\n  } else {\n    tag.code = bid.params.invCode;\n  }\n  tag.allow_smaller_sizes = bid.params.allowSmallerSizes || false;\n  tag.use_pmt_rule = bid.params.usePaymentRule || false;\n  tag.prebid = true;\n  tag.disable_psa = true;\n  if (bid.params.reserve) {\n    tag.reserve = bid.params.reserve;\n  }\n  if (bid.params.position) {\n    tag.position = { 'above': 1, 'below': 2 }[bid.params.position] || 0;\n  }\n  if (bid.params.trafficSourceCode) {\n    tag.traffic_source_code = bid.params.trafficSourceCode;\n  }\n  if (bid.params.privateSizes) {\n    tag.private_sizes = transformSizes(bid.params.privateSizes);\n  }\n  if (bid.params.supplyType) {\n    tag.supply_type = bid.params.supplyType;\n  }\n  if (bid.params.pubClick) {\n    tag.pubclick = bid.params.pubClick;\n  }\n  if (bid.params.extInvCode) {\n    tag.ext_inv_code = bid.params.extInvCode;\n  }\n  if (bid.params.externalImpId) {\n    tag.external_imp_id = bid.params.externalImpId;\n  }\n  if (!utils.isEmpty(bid.params.keywords)) {\n    tag.keywords = getKeywords(bid.params.keywords);\n  }\n\n  if (bid.mediaType === _mediaTypes.NATIVE || utils.deepAccess(bid, 'mediaTypes.' + _mediaTypes.NATIVE)) {\n    tag.ad_types.push(_mediaTypes.NATIVE);\n\n    if (bid.nativeParams) {\n      var nativeRequest = buildNativeRequest(bid.nativeParams);\n      tag[_mediaTypes.NATIVE] = { layouts: [nativeRequest] };\n    }\n  }\n\n  var videoMediaType = utils.deepAccess(bid, 'mediaTypes.' + _mediaTypes.VIDEO);\n  var context = utils.deepAccess(bid, 'mediaTypes.video.context');\n\n  if (bid.mediaType === _mediaTypes.VIDEO || videoMediaType) {\n    tag.ad_types.push(_mediaTypes.VIDEO);\n  }\n\n  // instream gets vastUrl, outstream gets vastXml\n  if (bid.mediaType === _mediaTypes.VIDEO || videoMediaType && context !== 'outstream') {\n    tag.require_asset_url = true;\n  }\n\n  if (bid.params.video) {\n    tag.video = {};\n    // place any valid video params on the tag\n    Object.keys(bid.params.video).filter(function (param) {\n      return (0, _includes2.default)(VIDEO_TARGETING, param);\n    }).forEach(function (param) {\n      return tag.video[param] = bid.params.video[param];\n    });\n  }\n\n  if (utils.isEmpty(bid.mediaType) && utils.isEmpty(bid.mediaTypes) || bid.mediaType === _mediaTypes.BANNER || bid.mediaTypes && bid.mediaTypes[_mediaTypes.BANNER]) {\n    tag.ad_types.push(_mediaTypes.BANNER);\n  }\n\n  return tag;\n}\n\n/* Turn bid request sizes into ut-compatible format */\nfunction transformSizes(requestSizes) {\n  var sizes = [];\n  var sizeObj = {};\n\n  if (utils.isArray(requestSizes) && requestSizes.length === 2 && !utils.isArray(requestSizes[0])) {\n    sizeObj.width = parseInt(requestSizes[0], 10);\n    sizeObj.height = parseInt(requestSizes[1], 10);\n    sizes.push(sizeObj);\n  } else if ((typeof requestSizes === 'undefined' ? 'undefined' : _typeof(requestSizes)) === 'object') {\n    for (var i = 0; i < requestSizes.length; i++) {\n      var size = requestSizes[i];\n      sizeObj = {};\n      sizeObj.width = parseInt(size[0], 10);\n      sizeObj.height = parseInt(size[1], 10);\n      sizes.push(sizeObj);\n    }\n  }\n\n  return sizes;\n}\n\nfunction hasUserInfo(bid) {\n  return !!bid.params.user;\n}\n\nfunction hasMemberId(bid) {\n  return !!parseInt(bid.params.member, 10);\n}\n\nfunction getRtbBid(tag) {\n  return tag && tag.ads && tag.ads.length && (0, _find2.default)(tag.ads, function (ad) {\n    return ad.rtb;\n  });\n}\n\nfunction buildNativeRequest(params) {\n  var request = {};\n\n  // map standard prebid native asset identifier to /ut parameters\n  // e.g., tag specifies `body` but /ut only knows `description`.\n  // mapping may be in form {tag: '<server name>'} or\n  // {tag: {serverName: '<server name>', requiredParams: {...}}}\n  Object.keys(params).forEach(function (key) {\n    // check if one of the <server name> forms is used, otherwise\n    // a mapping wasn't specified so pass the key straight through\n    var requestKey = NATIVE_MAPPING[key] && NATIVE_MAPPING[key].serverName || NATIVE_MAPPING[key] || key;\n\n    // required params are always passed on request\n    var requiredParams = NATIVE_MAPPING[key] && NATIVE_MAPPING[key].requiredParams;\n    request[requestKey] = _extends({}, requiredParams, params[key]);\n\n    // minimum params are passed if no non-required params given on adunit\n    var minimumParams = NATIVE_MAPPING[key] && NATIVE_MAPPING[key].minimumParams;\n\n    if (requiredParams && minimumParams) {\n      // subtract required keys from adunit keys\n      var adunitKeys = Object.keys(params[key]);\n      var requiredKeys = Object.keys(requiredParams);\n      var remaining = adunitKeys.filter(function (key) {\n        return !(0, _includes2.default)(requiredKeys, key);\n      });\n\n      // if none are left over, the minimum params needs to be sent\n      if (remaining.length === 0) {\n        request[requestKey] = _extends({}, request[requestKey], minimumParams);\n      }\n    }\n  });\n\n  return request;\n}\n\nfunction outstreamRender(bid) {\n  // push to render queue because ANOutstreamVideo may not be loaded yet\n  bid.renderer.push(function () {\n    window.ANOutstreamVideo.renderAd({\n      tagId: bid.adResponse.tag_id,\n      sizes: [bid.getSize().split('x')],\n      targetId: bid.adUnitCode, // target div id to render video\n      uuid: bid.adResponse.uuid,\n      adResponse: bid.adResponse,\n      rendererOptions: bid.renderer.getConfig()\n    }, handleOutstreamRendererEvents.bind(null, bid));\n  });\n}\n\nfunction handleOutstreamRendererEvents(bid, id, eventName) {\n  bid.renderer.handleVideoEvent({ id: id, eventName: eventName });\n}\n\nfunction parseMediaType(rtbBid) {\n  var adType = rtbBid.ad_type;\n  if (adType === _mediaTypes.VIDEO) {\n    return _mediaTypes.VIDEO;\n  } else if (adType === _mediaTypes.NATIVE) {\n    return _mediaTypes.NATIVE;\n  } else {\n    return _mediaTypes.BANNER;\n  }\n}\n\n(0, _bidderFactory.registerBidder)(spec);\n\n/***/ }),\n\n/***/ 120:\n/***/ (function(module, exports) {\n\n\n\n/***/ })\n\n},[118]);\n\npbjsChunk([106],{\n\n/***/ 127:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(128);\nmodule.exports = __webpack_require__(129);\n\n\n/***/ }),\n\n/***/ 128:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.spec = undefined;\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; /**\n                                                                                                                                                                                                                                                                               * @file AudienceNetwork adapter.\n                                                                                                                                                                                                                                                                               */\n\n\nvar _bidderFactory = __webpack_require__(1);\n\nvar _config = __webpack_require__(4);\n\nvar _url = __webpack_require__(12);\n\nvar _utils = __webpack_require__(0);\n\nvar _findIndex = __webpack_require__(22);\n\nvar _findIndex2 = _interopRequireDefault(_findIndex);\n\nvar _includes = __webpack_require__(7);\n\nvar _includes2 = _interopRequireDefault(_includes);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nvar code = 'audienceNetwork';\nvar currency = 'USD';\nvar method = 'GET';\nvar url = 'https://an.facebook.com/v2/placementbid.json';\nvar supportedMediaTypes = ['banner', 'video'];\nvar netRevenue = true;\nvar hb_bidder = 'fan';\nvar pbv = '1.11.0';\n\n/**\n * Does this bid request contain valid parameters?\n * @param {Object} bid\n * @returns {Boolean}\n */\nvar isBidRequestValid = function isBidRequestValid(bid) {\n  return _typeof(bid.params) === 'object' && typeof bid.params.placementId === 'string' && bid.params.placementId.length > 0 && Array.isArray(bid.sizes) && bid.sizes.length > 0 && (isFullWidth(bid.params.format) ? bid.sizes.map(flattenSize).some(function (size) {\n    return size === '300x250';\n  }) : true) && (isValidNonSizedFormat(bid.params.format) || bid.sizes.map(flattenSize).some(isValidSize));\n};\n\n/**\n * Flattens a 2-element [W, H] array as a 'WxH' string,\n * otherwise passes value through.\n * @param {Array|String} size\n * @returns {String}\n */\nvar flattenSize = function flattenSize(size) {\n  return Array.isArray(size) && size.length === 2 ? size[0] + 'x' + size[1] : size;\n};\n\n/**\n * Expands a 'WxH' string as a 2-element [W, H] array\n * @param {String} size\n * @returns {Array}\n */\nvar expandSize = function expandSize(size) {\n  return size.split('x').map(Number);\n};\n\n/**\n * Is this a valid slot size?\n * @param {String} size\n * @returns {Boolean}\n */\nvar isValidSize = function isValidSize(size) {\n  return (0, _includes2.default)(['300x250', '320x50'], size);\n};\n\n/**\n * Is this a valid, non-sized format?\n * @param {String} size\n * @returns {Boolean}\n */\nvar isValidNonSizedFormat = function isValidNonSizedFormat(format) {\n  return (0, _includes2.default)(['video', 'native'], format);\n};\n\n/**\n * Is this a valid size and format?\n * @param {String} size\n * @returns {Boolean}\n */\nvar isValidSizeAndFormat = function isValidSizeAndFormat(size, format) {\n  return isFullWidth(format) && flattenSize(size) === '300x250' || isValidNonSizedFormat(format) || isValidSize(flattenSize(size));\n};\n\n/**\n * Is this a video format?\n * @param {String} format\n * @returns {Boolean}\n */\nvar isVideo = function isVideo(format) {\n  return format === 'video';\n};\n\n/**\n * Is this a fullwidth format?\n * @param {String} format\n * @returns {Boolean}\n */\nvar isFullWidth = function isFullWidth(format) {\n  return format === 'fullwidth';\n};\n\n/**\n * Which SDK version should be used for this format?\n * @param {String} format\n * @returns {String}\n */\nvar sdkVersion = function sdkVersion(format) {\n  return isVideo(format) ? '' : '5.5.web';\n};\n\n/**\n * Does the search part of the URL contain \"anhb_testmode\"\n * and therefore indicate testmode should be used?\n * @returns {String} \"true\" or \"false\"\n */\nvar isTestmode = function isTestmode() {\n  return Boolean(window && window.location && typeof window.location.search === 'string' && window.location.search.indexOf('anhb_testmode') !== -1).toString();\n};\n\n/**\n * Generate ad HTML for injection into an iframe\n * @param {String} placementId\n * @param {String} format\n * @param {String} bidId\n * @returns {String} HTML\n */\nvar createAdHtml = function createAdHtml(placementId, format, bidId) {\n  var nativeStyle = format === 'native' ? '<script>window.onload=function(){if(parent){var o=document.getElementsByTagName(\"head\")[0];var s=parent.document.getElementsByTagName(\"style\");for(var i=0;i<s.length;i++)o.appendChild(s[i].cloneNode(true));}}</script>' : '';\n  var nativeContainer = format === 'native' ? '<div class=\"thirdPartyRoot\"><a class=\"fbAdLink\"><div class=\"fbAdMedia thirdPartyMediaClass\"></div><div class=\"fbAdSubtitle thirdPartySubtitleClass\"></div><div class=\"fbDefaultNativeAdWrapper\"><div class=\"fbAdCallToAction thirdPartyCallToActionClass\"></div><div class=\"fbAdTitle thirdPartyTitleClass\"></div></div></a></div>' : '';\n  return '<html><head>' + nativeStyle + '</head><body><div style=\"display:none;position:relative;\">\\n<script type=\\'text/javascript\\'>var data = {placementid:\\'' + placementId + '\\',format:\\'' + format + '\\',bidid:\\'' + bidId + '\\',onAdLoaded:function(e){console.log(\\'Audience Network [' + placementId + '] ad loaded\\');e.style.display = \\'block\\';},onAdError:function(c,m){console.log(\\'Audience Network [' + placementId + '] error (\\' + c + \\') \\' + m);}};\\n(function(a,b,c){var d=\\'https://www.facebook.com\\',e=\\'https://connect.facebook.net/en_US/fbadnw55.js\\',f={iframeLoaded:true,xhrLoaded:true},g=a.data,h=function(){if(Date.now){return Date.now();}else return +new Date();},i=function(aa){var ba=d+\\'/audience_network/client_event\\',ca={cb:h(),event_name:\\'ADNW_ADERROR\\',ad_pivot_type:\\'audience_network_mobile_web\\',sdk_version:\\'5.5.web\\',app_id:g.placementid.split(\\'_\\')[0],publisher_id:g.placementid.split(\\'_\\')[1],error_message:aa},da=[];for(var ea in ca)da.push(encodeURIComponent(ea)+\\'=\\'+encodeURIComponent(ca[ea]));var fa=ba+\\'?\\'+da.join(\\'&\\'),ga=new XMLHttpRequest();ga.open(\\'GET\\',fa,true);ga.send();if(g.onAdError)g.onAdError(\\'1000\\',\\'Internal error.\\');},j=function(){if(b.currentScript){return b.currentScript;}else{var aa=b.getElementsByTagName(\\'script\\');return aa[aa.length-1];}},k=function(aa){try{return aa.document.referrer;}catch(ba){}return \\'\\';},l=function(){var aa=a,ba=[aa];try{while(aa!==aa.parent&&aa.parent.document)ba.push(aa=aa.parent);}catch(ca){}return ba.reverse();},m=function(){var aa=l();for(var ba=0;ba<aa.length;ba++){var ca=aa[ba],da=ca.ADNW||{};ca.ADNW=da;if(!ca.ADNW)continue;return da.v55=da.v55||{ads:[],window:ca};}throw new Error(\\'no_writable_global\\');},n=function(aa){var ba=aa.indexOf(\\'/\\',aa.indexOf(\\'://\\')+3);if(ba===-1)return aa;return aa.substring(0,ba);},o=function(aa){return aa.location.href||k(aa);},p=function(aa){if(aa.sdkLoaded)return;var ba=aa.window.document,ca=ba.createElement(\\'iframe\\');ca.name=\\'fbadnw\\';ca.style.display=\\'none\\';ba.body.appendChild(ca);var da=ca.contentDocument.createElement(\\'script\\');da.src=e;da.async=true;ca.contentDocument.body.appendChild(da);aa.sdkLoaded=true;},q=function(aa){var ba=/^https?:\\\\/\\\\/www\\\\.google(\\\\.com?)?\\\\.\\\\w{2,3}$/;return !!aa.match(ba);},r=function(aa){return !!aa.match(/cdn\\\\.ampproject\\\\.org$/);},s=function(){var aa=c.ancestorOrigins||[],ba=aa[aa.length-1]||c.origin,ca=aa[aa.length-2]||c.origin;if(q(ba)&&r(ca)){return n(ca);}else return n(ba);},t=function(aa){try{return JSON.parse(aa);}catch(ba){i(ba.message);throw ba;}},u=function(aa,ba,ca){if(!aa.iframe){var da=ca.createElement(\\'iframe\\');da.src=d+\\'/audiencenetwork/iframe/\\';da.style.display=\\'none\\';ca.body.appendChild(da);aa.iframe=da;aa.iframeAppendedTime=h();aa.iframeData={};}ba.iframe=aa.iframe;ba.iframeData=aa.iframeData;ba.tagJsIframeAppendedTime=aa.iframeAppendedTime||0;},v=function(aa){var ba=d+\\'/audiencenetwork/xhr/?sdk=5.5.web\\';for(var ca in aa)if(typeof aa[ca]!==\\'function\\')ba+=\\'&\\'+ca+\\'=\\'+encodeURIComponent(aa[ca]);var da=new XMLHttpRequest();da.open(\\'GET\\',ba,true);da.withCredentials=true;da.onreadystatechange=function(){if(da.readyState===4){var ea=t(da.response);aa.events.push({name:\\'xhrLoaded\\',source:aa.iframe.contentWindow,data:ea,postMessageTimestamp:h(),receivedTimestamp:h()});}};da.send();},w=function(aa,ba){var ca=d+\\'/audiencenetwork/xhriframe/?sdk=5.5.web\\';for(var da in ba)if(typeof ba[da]!==\\'function\\')ca+=\\'&\\'+da+\\'=\\'+encodeURIComponent(ba[da]);var ea=b.createElement(\\'iframe\\');ea.src=ca;ea.style.display=\\'none\\';b.body.appendChild(ea);ba.iframe=ea;ba.iframeData={};ba.tagJsIframeAppendedTime=h();},x=function(aa){var ba=function(event){try{var da=event.data;if(da.name in f)aa.events.push({name:da.name,source:event.source,data:da.data});}catch(ea){}},ca=aa.iframe.contentWindow.parent;ca.addEventListener(\\'message\\',ba,false);},y=function(aa){if(aa.context&&aa.context.sourceUrl)return true;try{return !!JSON.parse(decodeURI(aa.name)).ampcontextVersion;}catch(ba){return false;}},z=function(aa){var ba=h(),ca=l()[0],da=j().parentElement,ea=ca!=a.top,fa=ca.$sf&&ca.$sf.ext,ga=o(ca),ha=m();p(ha);var ia={amp:y(ca),events:[],tagJsInitTime:ba,rootElement:da,iframe:null,tagJsIframeAppendedTime:ha.iframeAppendedTime||0,url:ga,domain:s(),channel:n(o(ca)),width:screen.width,height:screen.height,pixelratio:a.devicePixelRatio,placementindex:ha.ads.length,crossdomain:ea,safeframe:!!fa,placementid:g.placementid,format:g.format||\\'300x250\\',testmode:!!g.testmode,onAdLoaded:g.onAdLoaded,onAdError:g.onAdError};if(g.bidid)ia.bidid=g.bidid;if(ea){w(ha,ia);}else{u(ha,ia,ca.document);v(ia);}; x(ia);ia.rootElement.dataset.placementid=ia.placementid;ha.ads.push(ia);};try{z();}catch(aa){i(aa.message||aa);throw aa;}})(window,document,location);\\n</script>\\n' + nativeContainer + '</div></body></html>';\n};\n\n/**\n * Get the current window location URL correctly encoded for use in a URL query string.\n * @returns {String} URI-encoded URL\n */\nvar getTopWindowUrlEncoded = function getTopWindowUrlEncoded() {\n  return encodeURIComponent((0, _utils.getTopWindowUrl)());\n};\n\n/**\n * Convert each bid request to a single URL to fetch those bids.\n * @param {Array} bids - list of bids\n * @param {String} bids[].placementCode - Prebid placement identifier\n * @param {Object} bids[].params\n * @param {String} bids[].params.placementId - Audience Network placement identifier\n * @param {String} bids[].params.format - Optional format, one of 'video', 'native' or 'fullwidth' if set\n * @param {Array} bids[].sizes - list of desired advert sizes\n * @param {Array} bids[].sizes[] - Size arrays [h,w]: should include one of [300, 250], [320, 50]: first matched size is used\n * @returns {Array<Object>} List of URLs to fetch, plus formats and sizes for later use with interpretResponse\n */\nvar buildRequests = function buildRequests(bids) {\n  // Build lists of placementids, adformats, sizes and SDK versions\n  var placementids = [];\n  var adformats = [];\n  var sizes = [];\n  var sdk = [];\n  var requestIds = [];\n\n  bids.forEach(function (bid) {\n    return bid.sizes.map(flattenSize).filter(function (size) {\n      return isValidSizeAndFormat(size, bid.params.format);\n    }).slice(0, 1).forEach(function (size) {\n      placementids.push(bid.params.placementId);\n      adformats.push(bid.params.format || size);\n      sizes.push(size);\n      sdk.push(sdkVersion(bid.params.format));\n      requestIds.push(bid.bidId);\n    });\n  });\n\n  // Build URL\n  var testmode = isTestmode();\n  var pageurl = getTopWindowUrlEncoded();\n  var search = {\n    placementids: placementids,\n    adformats: adformats,\n    testmode: testmode,\n    pageurl: pageurl,\n    sdk: sdk,\n    pbv: pbv\n  };\n  var video = (0, _findIndex2.default)(adformats, isVideo);\n  if (video !== -1) {\n    var _expandSize = expandSize(sizes[video]);\n\n    var _expandSize2 = _slicedToArray(_expandSize, 2);\n\n    search.playerwidth = _expandSize2[0];\n    search.playerheight = _expandSize2[1];\n  }\n  if ((0, _utils.isSafariBrowser)()) {\n    search.cb = (0, _utils.generateUUID)();\n  }\n  var data = (0, _url.formatQS)(search);\n\n  return [{ adformats: adformats, data: data, method: method, requestIds: requestIds, sizes: sizes, url: url }];\n};\n\n/**\n * Convert a server response to a bid response.\n * @param {Object} response - object representing the response\n * @param {Object} response.body - response body, already converted from JSON\n * @param {Object} bidRequests - the original bid requests\n * @param {Array} bidRequest.adformats - list of formats for the original bid requests\n * @param {Array} bidRequest.sizes - list of sizes fot the original bid requests\n * @returns {Array<Object>} A list of bid response objects\n */\nvar interpretResponse = function interpretResponse(_ref, _ref2) {\n  var body = _ref.body;\n  var adformats = _ref2.adformats,\n      requestIds = _ref2.requestIds,\n      sizes = _ref2.sizes;\n\n  var ttl = Number(_config.config.getConfig().bidderTimeout);\n\n  var _body$bids = body.bids,\n      bids = _body$bids === undefined ? {} : _body$bids;\n\n  return Object.keys(bids)\n  // extract Array of bid responses\n  .map(function (placementId) {\n    return bids[placementId];\n  })\n  // flatten\n  .reduce(function (a, b) {\n    return a.concat(b);\n  }, [])\n  // transform to bidResponse\n  .map(function (bid, i) {\n    var fb_bidid = bid.bid_id,\n        creativeId = bid.placement_id,\n        cpm = bid.bid_price_cents;\n\n\n    var format = adformats[i];\n\n    var _expandSize3 = expandSize(flattenSize(sizes[i])),\n        _expandSize4 = _slicedToArray(_expandSize3, 2),\n        width = _expandSize4[0],\n        height = _expandSize4[1];\n\n    var ad = createAdHtml(creativeId, format, fb_bidid);\n    var requestId = requestIds[i];\n\n    var bidResponse = {\n      // Prebid attributes\n      requestId: requestId,\n      cpm: cpm / 100,\n      width: width,\n      height: height,\n      ad: ad,\n      ttl: ttl,\n      creativeId: creativeId,\n      netRevenue: netRevenue,\n      currency: currency,\n      // Audience Network attributes\n      hb_bidder: hb_bidder,\n      fb_bidid: fb_bidid,\n      fb_format: format,\n      fb_placementid: creativeId\n    };\n    // Video attributes\n    if (isVideo(format)) {\n      var pageurl = getTopWindowUrlEncoded();\n      bidResponse.mediaType = 'video';\n      bidResponse.vastUrl = 'https://an.facebook.com/v1/instream/vast.xml?placementid=' + creativeId + '&pageurl=' + pageurl + '&playerwidth=' + width + '&playerheight=' + height + '&bidid=' + fb_bidid;\n    }\n    return bidResponse;\n  });\n};\n\nvar spec = exports.spec = {\n  code: code,\n  supportedMediaTypes: supportedMediaTypes,\n  isBidRequestValid: isBidRequestValid,\n  buildRequests: buildRequests,\n  interpretResponse: interpretResponse\n};\n\n(0, _bidderFactory.registerBidder)(spec);\n\n/***/ }),\n\n/***/ 129:\n/***/ (function(module, exports) {\n\n\n\n/***/ })\n\n},[127]);\n\npbjsChunk([105],{\n\n/***/ 130:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(131);\nmodule.exports = __webpack_require__(132);\n\n\n/***/ }),\n\n/***/ 131:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.spec = exports.DEFAULT_MIMES = exports.VIDEO_TARGETING = exports.OUTSTREAM_SRC = exports.BANNER_ENDPOINT = exports.VIDEO_ENDPOINT = undefined;\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _utils = __webpack_require__(0);\n\nvar utils = _interopRequireWildcard(_utils);\n\nvar _bidderFactory = __webpack_require__(1);\n\nvar _Renderer = __webpack_require__(14);\n\nvar _mediaTypes = __webpack_require__(3);\n\nvar _find = __webpack_require__(10);\n\nvar _find2 = _interopRequireDefault(_find);\n\nvar _includes = __webpack_require__(7);\n\nvar _includes2 = _interopRequireDefault(_includes);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nvar ADAPTER_VERSION = '1.1';\nvar ADAPTER_NAME = 'BFIO_PREBID';\nvar OUTSTREAM = 'outstream';\n\nvar VIDEO_ENDPOINT = exports.VIDEO_ENDPOINT = '//reachms.bfmio.com/bid.json?exchange_id=';\nvar BANNER_ENDPOINT = exports.BANNER_ENDPOINT = '//display.bfmio.com/prebid_display';\nvar OUTSTREAM_SRC = exports.OUTSTREAM_SRC = '//player-cdn.beachfrontmedia.com/playerapi/loader/outstream.js';\n\nvar VIDEO_TARGETING = exports.VIDEO_TARGETING = ['mimes'];\nvar DEFAULT_MIMES = exports.DEFAULT_MIMES = ['video/mp4', 'application/javascript'];\n\nvar spec = exports.spec = {\n  code: 'beachfront',\n  supportedMediaTypes: [_mediaTypes.VIDEO, _mediaTypes.BANNER],\n\n  isBidRequestValid: function isBidRequestValid(bid) {\n    return !!(bid && bid.params && bid.params.appId && bid.params.bidfloor);\n  },\n  buildRequests: function buildRequests(bids, bidderRequest) {\n    var requests = [];\n    var videoBids = bids.filter(function (bid) {\n      return isVideoBid(bid);\n    });\n    var bannerBids = bids.filter(function (bid) {\n      return !isVideoBid(bid);\n    });\n    videoBids.forEach(function (bid) {\n      requests.push({\n        method: 'POST',\n        url: VIDEO_ENDPOINT + bid.params.appId,\n        data: createVideoRequestData(bid, bidderRequest),\n        bidRequest: bid\n      });\n    });\n    if (bannerBids.length) {\n      requests.push({\n        method: 'POST',\n        url: BANNER_ENDPOINT,\n        data: createBannerRequestData(bannerBids, bidderRequest),\n        bidRequest: bannerBids\n      });\n    }\n    return requests;\n  },\n  interpretResponse: function interpretResponse(response, _ref) {\n    var bidRequest = _ref.bidRequest;\n\n    response = response.body;\n\n    if (isVideoBid(bidRequest)) {\n      if (!response || !response.url || !response.bidPrice) {\n        utils.logWarn('No valid video bids from ' + spec.code + ' bidder');\n        return [];\n      }\n      var size = getFirstSize(bidRequest);\n      var context = utils.deepAccess(bidRequest, 'mediaTypes.video.context');\n      return {\n        requestId: bidRequest.bidId,\n        bidderCode: spec.code,\n        vastUrl: response.url,\n        cpm: response.bidPrice,\n        width: size.w,\n        height: size.h,\n        creativeId: response.cmpId,\n        renderer: context === OUTSTREAM ? createRenderer(bidRequest) : null,\n        mediaType: _mediaTypes.VIDEO,\n        currency: 'USD',\n        netRevenue: true,\n        ttl: 300\n      };\n    } else {\n      if (!response || !response.length) {\n        utils.logWarn('No valid banner bids from ' + spec.code + ' bidder');\n        return [];\n      }\n      return response.map(function (bid) {\n        var request = (0, _find2.default)(bidRequest, function (req) {\n          return req.adUnitCode === bid.slot;\n        });\n        return {\n          requestId: request.bidId,\n          bidderCode: spec.code,\n          ad: bid.adm,\n          creativeId: bid.crid,\n          cpm: bid.price,\n          width: bid.w,\n          height: bid.h,\n          mediaType: _mediaTypes.BANNER,\n          currency: 'USD',\n          netRevenue: true,\n          ttl: 300\n        };\n      });\n    }\n  }\n};\n\nfunction createRenderer(bidRequest) {\n  var renderer = _Renderer.Renderer.install({\n    id: bidRequest.bidId,\n    url: OUTSTREAM_SRC,\n    loaded: false\n  });\n\n  renderer.setRender(outstreamRender);\n\n  return renderer;\n}\n\nfunction outstreamRender(bid) {\n  bid.renderer.push(function () {\n    window.Beachfront.Player(bid.adUnitCode, {\n      ad_tag_url: bid.vastUrl,\n      width: bid.width,\n      height: bid.height,\n      expand_in_view: false,\n      collapse_on_complete: true\n    });\n  });\n}\n\nfunction getSizes(bid) {\n  var sizes = (isVideoBid(bid) ? utils.deepAccess(bid, 'mediaTypes.video.playerSize') : utils.deepAccess(bid, 'mediaTypes.banner.sizes')) || bid.sizes;\n  return utils.parseSizesInput(sizes).map(function (size) {\n    var _size$split = size.split('x'),\n        _size$split2 = _slicedToArray(_size$split, 2),\n        width = _size$split2[0],\n        height = _size$split2[1];\n\n    return {\n      w: parseInt(width, 10) || undefined,\n      h: parseInt(height, 10) || undefined\n    };\n  });\n}\n\nfunction getFirstSize(bid) {\n  var sizes = getSizes(bid);\n  return sizes.length ? sizes[0] : { w: undefined, h: undefined };\n}\n\nfunction getOsVersion() {\n  var clientStrings = [{ s: 'Android', r: /Android/ }, { s: 'iOS', r: /(iPhone|iPad|iPod)/ }, { s: 'Mac OS X', r: /Mac OS X/ }, { s: 'Mac OS', r: /(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/ }, { s: 'Linux', r: /(Linux|X11)/ }, { s: 'Windows 10', r: /(Windows 10.0|Windows NT 10.0)/ }, { s: 'Windows 8.1', r: /(Windows 8.1|Windows NT 6.3)/ }, { s: 'Windows 8', r: /(Windows 8|Windows NT 6.2)/ }, { s: 'Windows 7', r: /(Windows 7|Windows NT 6.1)/ }, { s: 'Windows Vista', r: /Windows NT 6.0/ }, { s: 'Windows Server 2003', r: /Windows NT 5.2/ }, { s: 'Windows XP', r: /(Windows NT 5.1|Windows XP)/ }, { s: 'UNIX', r: /UNIX/ }, { s: 'Search Bot', r: /(nuhk|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask Jeeves\\/Teoma|ia_archiver)/ }];\n  var cs = (0, _find2.default)(clientStrings, function (cs) {\n    return cs.r.test(navigator.userAgent);\n  });\n  return cs ? cs.s : 'unknown';\n}\n\nfunction isMobile() {\n  return (/(ios|ipod|ipad|iphone|android)/i.test(navigator.userAgent)\n  );\n}\n\nfunction isConnectedTV() {\n  return (/(smart[-]?tv|hbbtv|appletv|googletv|hdmi|netcast\\.tv|viera|nettv|roku|\\bdtv\\b|sonydtv|inettvbrowser|\\btv\\b)/i.test(navigator.userAgent)\n  );\n}\n\nfunction getDoNotTrack() {\n  return navigator.doNotTrack === '1' || window.doNotTrack === '1' || navigator.msDoNoTrack === '1' || navigator.doNotTrack === 'yes';\n}\n\nfunction isVideoBid(bid) {\n  return bid.mediaTypes && bid.mediaTypes.video;\n}\n\nfunction getVideoParams(bid) {\n  return Object.keys(Object(bid.params.video)).filter(function (param) {\n    return (0, _includes2.default)(VIDEO_TARGETING, param);\n  }).reduce(function (obj, param) {\n    obj[param] = bid.params.video[param];\n    return obj;\n  }, {});\n}\n\nfunction createVideoRequestData(bid, bidderRequest) {\n  var size = getFirstSize(bid);\n  var video = getVideoParams(bid);\n  var topLocation = utils.getTopWindowLocation();\n  var payload = {\n    isPrebid: true,\n    appId: bid.params.appId,\n    domain: document.location.hostname,\n    id: utils.getUniqueIdentifierStr(),\n    imp: [{\n      video: _extends({\n        w: size.w,\n        h: size.h,\n        mimes: DEFAULT_MIMES\n      }, video),\n      bidfloor: bid.params.bidfloor,\n      secure: topLocation.protocol === 'https:' ? 1 : 0\n    }],\n    site: {\n      page: topLocation.href,\n      domain: topLocation.hostname\n    },\n    device: {\n      ua: navigator.userAgent,\n      language: navigator.language,\n      devicetype: isMobile() ? 1 : isConnectedTV() ? 3 : 2,\n      dnt: getDoNotTrack() ? 1 : 0,\n      js: 1,\n      geo: {}\n    },\n    regs: {},\n    user: {},\n    cur: ['USD']\n  };\n\n  if (bidderRequest && bidderRequest.gdprConsent) {\n    var _bidderRequest$gdprCo = bidderRequest.gdprConsent,\n        consentRequired = _bidderRequest$gdprCo.consentRequired,\n        consentString = _bidderRequest$gdprCo.consentString;\n\n    payload.regs.ext = { gdpr: consentRequired ? 1 : 0 };\n    payload.user.ext = { consent: consentString };\n  }\n\n  return payload;\n}\n\nfunction createBannerRequestData(bids, bidderRequest) {\n  var topLocation = utils.getTopWindowLocation();\n  var referrer = utils.getTopWindowReferrer();\n  var slots = bids.map(function (bid) {\n    return {\n      slot: bid.adUnitCode,\n      id: bid.params.appId,\n      bidfloor: bid.params.bidfloor,\n      sizes: getSizes(bid)\n    };\n  });\n  var payload = {\n    slots: slots,\n    page: topLocation.href,\n    domain: topLocation.hostname,\n    search: topLocation.search,\n    secure: topLocation.protocol === 'https:' ? 1 : 0,\n    referrer: referrer,\n    ua: navigator.userAgent,\n    deviceOs: getOsVersion(),\n    isMobile: isMobile() ? 1 : 0,\n    dnt: getDoNotTrack() ? 1 : 0,\n    adapterVersion: ADAPTER_VERSION,\n    adapterName: ADAPTER_NAME\n  };\n\n  if (bidderRequest && bidderRequest.gdprConsent) {\n    var _bidderRequest$gdprCo2 = bidderRequest.gdprConsent,\n        consentRequired = _bidderRequest$gdprCo2.consentRequired,\n        consentString = _bidderRequest$gdprCo2.consentString;\n\n    payload.gdpr = consentRequired ? 1 : 0;\n    payload.gdprConsent = consentString;\n  }\n\n  return payload;\n}\n\n(0, _bidderFactory.registerBidder)(spec);\n\n/***/ }),\n\n/***/ 132:\n/***/ (function(module, exports) {\n\n\n\n/***/ })\n\n},[130]);\n\npbjsChunk([135],{\n\n/***/ 148:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__(149);\n\n\n/***/ }),\n\n/***/ 149:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.allowAuction = exports.consentTimeout = exports.userCMP = undefined;\nexports.requestBidsHook = requestBidsHook;\nexports.resetConsentData = resetConsentData;\nexports.setConfig = setConfig;\n\nvar _utils = __webpack_require__(0);\n\nvar utils = _interopRequireWildcard(_utils);\n\nvar _config = __webpack_require__(4);\n\nvar _adaptermanager = __webpack_require__(8);\n\nvar _includes = __webpack_require__(7);\n\nvar _includes2 = _interopRequireDefault(_includes);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\n/**\n * This module adds GDPR consentManagement support to prebid.js.  It interacts with\n * supported CMPs (Consent Management Platforms) to grab the user's consent information\n * and make it available for any GDPR supported adapters to read/pass this information to\n * their system.\n */\nvar DEFAULT_CMP = 'iab';\nvar DEFAULT_CONSENT_TIMEOUT = 10000;\nvar DEFAULT_ALLOW_AUCTION_WO_CONSENT = true;\n\nvar userCMP = exports.userCMP = void 0;\nvar consentTimeout = exports.consentTimeout = void 0;\nvar allowAuction = exports.allowAuction = void 0;\n\nvar consentData = void 0;\n\nvar context = void 0;\nvar args = void 0;\nvar nextFn = void 0;\n\nvar timer = void 0;\nvar haveExited = void 0;\n\n// add new CMPs here, with their dedicated lookup function\nvar cmpCallMap = {\n  'iab': lookupIabConsent\n};\n\n/**\n * This function handles interacting with an IAB compliant CMP to obtain the consentObject value of the user.\n * Given the async nature of the CMP's API, we pass in acting success/error callback functions to exit this function\n * based on the appropriate result.\n * @param {function(string)} cmpSuccess acts as a success callback when CMP returns a value; pass along consentObject (string) from CMP\n * @param {function(string)} cmpError acts as an error callback while interacting with CMP; pass along an error message (string)\n * @param {[objects]} adUnits used in the safeframe workflow to know what sizes to include in the $sf.ext.register call\n */\nfunction lookupIabConsent(cmpSuccess, cmpError, adUnits) {\n  var cmpCallbacks = void 0;\n\n  // check if the CMP is located on the same window level as the prebid code.\n  // if it's found, directly call the CMP via it's API and call the cmpSuccess callback.\n  // if it's not found, assume the prebid code may be inside an iframe and the CMP code is located in a higher parent window.\n  // in this case, use the IAB's iframe locator sample code (which is slightly cutomized) to try to find the CMP and use postMessage() to communicate with the CMP.\n  if (utils.isFn(window.__cmp)) {\n    window.__cmp('getVendorConsents', null, cmpSuccess);\n  } else if (inASafeFrame() && typeof window.$sf.ext.cmp === 'function') {\n    callCmpWhileInSafeFrame();\n  } else {\n    callCmpWhileInIframe();\n  }\n\n  function inASafeFrame() {\n    return !!(window.$sf && window.$sf.ext);\n  }\n\n  function callCmpWhileInSafeFrame() {\n    function sfCallback(msgName, data) {\n      if (msgName === 'cmpReturn') {\n        cmpSuccess(data.vendorConsents);\n      }\n    }\n\n    // find sizes from adUnits object\n    var width = 1;\n    var height = 1;\n\n    if (Array.isArray(adUnits) && adUnits.length > 0) {\n      var sizes = utils.getAdUnitSizes(adUnits[0]);\n      width = sizes[0][0];\n      height = sizes[0][1];\n    }\n\n    window.$sf.ext.register(width, height, sfCallback);\n    window.$sf.ext.cmp('getVendorConsents');\n  }\n\n  function callCmpWhileInIframe() {\n    /**\n     * START OF STOCK CODE FROM IAB 1.1 CMP SPEC\n    */\n\n    // find the CMP frame\n    var f = window;\n    var cmpFrame = void 0;\n    while (!cmpFrame) {\n      try {\n        if (f.frames['__cmpLocator']) cmpFrame = f;\n      } catch (e) {}\n      if (f === window.top) break;\n      f = f.parent;\n    }\n\n    cmpCallbacks = {};\n\n    /* Setup up a __cmp function to do the postMessage and stash the callback.\n      This function behaves (from the caller's perspective identicially to the in-frame __cmp call */\n    window.__cmp = function (cmd, arg, callback) {\n      if (!cmpFrame) {\n        removePostMessageListener();\n\n        var errmsg = 'CMP not found';\n        // small customization to properly return error\n        return cmpError(errmsg);\n      }\n      var callId = Math.random() + '';\n      var msg = { __cmpCall: {\n          command: cmd,\n          parameter: arg,\n          callId: callId\n        } };\n      cmpCallbacks[callId] = callback;\n      cmpFrame.postMessage(msg, '*');\n    };\n\n    /** when we get the return message, call the stashed callback */\n    // small customization to remove this eventListener later in module\n    window.addEventListener('message', readPostMessageResponse, false);\n\n    /**\n     * END OF STOCK CODE FROM IAB 1.1 CMP SPEC\n     */\n\n    // call CMP\n    window.__cmp('getVendorConsents', null, cmpIframeCallback);\n  }\n\n  function readPostMessageResponse(event) {\n    // small customization to prevent reading strings from other sources that aren't JSON.stringified\n    var json = typeof event.data === 'string' && (0, _includes2.default)(event.data, 'cmpReturn') ? JSON.parse(event.data) : event.data;\n    if (json.__cmpReturn) {\n      var i = json.__cmpReturn;\n      cmpCallbacks[i.callId](i.returnValue, i.success);\n      delete cmpCallbacks[i.callId];\n    }\n  }\n\n  function removePostMessageListener() {\n    window.removeEventListener('message', readPostMessageResponse, false);\n  }\n\n  function cmpIframeCallback(consentObject) {\n    removePostMessageListener();\n    cmpSuccess(consentObject);\n  }\n}\n\n/**\n * If consentManagement module is enabled (ie included in setConfig), this hook function will attempt to fetch the\n * user's encoded consent string from the supported CMP.  Once obtained, the module will store this\n * data as part of a gdprConsent object which gets transferred to adaptermanager's gdprDataHandler object.\n * This information is later added into the bidRequest object for any supported adapters to read/pass along to their system.\n * @param {object} config required; This is the same param that's used in pbjs.requestBids.\n * @param {function} fn required; The next function in the chain, used by hook.js\n */\nfunction requestBidsHook(config, fn) {\n  context = this;\n  args = arguments;\n  nextFn = fn;\n  haveExited = false;\n  var adUnits = config.adUnits || pbjs.adUnits;\n\n  // in case we already have consent (eg during bid refresh)\n  if (consentData) {\n    return exitModule();\n  }\n\n  if (!(0, _includes2.default)(Object.keys(cmpCallMap), userCMP)) {\n    utils.logWarn('CMP framework (' + userCMP + ') is not a supported framework.  Aborting consentManagement module and resuming auction.');\n    return nextFn.apply(context, args);\n  }\n\n  cmpCallMap[userCMP].call(this, processCmpData, cmpFailed, adUnits);\n\n  // only let this code run if module is still active (ie if the callbacks used by CMPs haven't already finished)\n  if (!haveExited) {\n    if (consentTimeout === 0) {\n      processCmpData(undefined);\n    } else {\n      timer = setTimeout(cmpTimedOut, consentTimeout);\n    }\n  }\n}\n\n/**\n * This function checks the consent data provided by CMP to ensure it's in an expected state.\n * If it's bad, we exit the module depending on config settings.\n * If it's good, then we store the value and exits the module.\n * @param {object} consentObject required; object returned by CMP that contains user's consent choices\n */\nfunction processCmpData(consentObject) {\n  if (!utils.isPlainObject(consentObject) || !utils.isStr(consentObject.metadata) || consentObject.metadata === '') {\n    cmpFailed('CMP returned unexpected value during lookup process; returned value was (' + consentObject + ').');\n  } else {\n    clearTimeout(timer);\n    storeConsentData(consentObject);\n\n    exitModule();\n  }\n}\n\n/**\n * General timeout callback when interacting with CMP takes too long.\n */\nfunction cmpTimedOut() {\n  cmpFailed('CMP workflow exceeded timeout threshold.');\n}\n\n/**\n * This function contains the controlled steps to perform when there's a problem with CMP.\n * @param {string} errMsg required; should be a short descriptive message for why the failure/issue happened.\n*/\nfunction cmpFailed(errMsg) {\n  clearTimeout(timer);\n\n  // still set the consentData to undefined when there is a problem as per config options\n  if (allowAuction) {\n    storeConsentData(undefined);\n  }\n  exitModule(errMsg);\n}\n\n/**\n * Stores CMP data locally in module and then invokes gdprDataHandler.setConsentData() to make information available in adaptermanger.js for later in the auction\n * @param {object} cmpConsentObject required; an object representing user's consent choices (can be undefined in certain use-cases for this function only)\n */\nfunction storeConsentData(cmpConsentObject) {\n  consentData = {\n    consentString: cmpConsentObject ? cmpConsentObject.metadata : undefined,\n    vendorData: cmpConsentObject,\n    gdprApplies: cmpConsentObject ? cmpConsentObject.gdprApplies : undefined\n  };\n  _adaptermanager.gdprDataHandler.setConsentData(consentData);\n}\n\n/**\n * This function handles the exit logic for the module.\n * There are several paths in the module's logic to call this function and we only allow 1 of the 3 potential exits to happen before suppressing others.\n *\n * We prevent multiple exits to avoid conflicting messages in the console depending on certain scenarios.\n * One scenario could be auction was canceled due to timeout with CMP being reached.\n * While the timeout is the accepted exit and runs first, the CMP's callback still tries to process the user's data (which normally leads to a good exit).\n * In this case, the good exit will be suppressed since we already decided to cancel the auction.\n *\n * Three exit paths are:\n * 1. good exit where auction runs (CMP data is processed normally).\n * 2. bad exit but auction still continues (warning message is logged, CMP data is undefined and still passed along).\n * 3. bad exit with auction canceled (error message is logged).\n * @param {string} errMsg optional; only to be used when there was a 'bad' exit.  String is a descriptive message for the failure/issue encountered.\n */\nfunction exitModule(errMsg) {\n  if (haveExited === false) {\n    haveExited = true;\n\n    if (errMsg) {\n      if (allowAuction) {\n        utils.logWarn(errMsg + ' Resuming auction without consent data as per consentManagement config.');\n        nextFn.apply(context, args);\n      } else {\n        utils.logError(errMsg + ' Canceling auction as per consentManagement config.');\n      }\n    } else {\n      nextFn.apply(context, args);\n    }\n  }\n}\n\n/**\n * Simply resets the module's consentData variable back to undefined, mainly for testing purposes\n */\nfunction resetConsentData() {\n  consentData = undefined;\n  _adaptermanager.gdprDataHandler.setConsentData(null);\n}\n\n/**\n * A configuration function that initializes some module variables, as well as add a hook into the requestBids function\n * @param {object} config required; consentManagement module config settings; cmp (string), timeout (int), allowAuctionWithoutConsent (boolean)\n */\nfunction setConfig(config) {\n  if (utils.isStr(config.cmpApi)) {\n    exports.userCMP = userCMP = config.cmpApi;\n  } else {\n    exports.userCMP = userCMP = DEFAULT_CMP;\n    utils.logInfo('consentManagement config did not specify cmp.  Using system default setting (' + DEFAULT_CMP + ').');\n  }\n\n  if (utils.isNumber(config.timeout)) {\n    exports.consentTimeout = consentTimeout = config.timeout;\n  } else {\n    exports.consentTimeout = consentTimeout = DEFAULT_CONSENT_TIMEOUT;\n    utils.logInfo('consentManagement config did not specify timeout.  Using system default setting (' + DEFAULT_CONSENT_TIMEOUT + ').');\n  }\n\n  if (typeof config.allowAuctionWithoutConsent === 'boolean') {\n    exports.allowAuction = allowAuction = config.allowAuctionWithoutConsent;\n  } else {\n    exports.allowAuction = allowAuction = DEFAULT_ALLOW_AUCTION_WO_CONSENT;\n    utils.logInfo('consentManagement config did not specify allowAuctionWithoutConsent.  Using system default setting (' + DEFAULT_ALLOW_AUCTION_WO_CONSENT + ').');\n  }\n\n  pbjs.requestBids.addHook(requestBidsHook, 50);\n}\n_config.config.getConfig('consentManagement', function (config) {\n  return setConfig(config.consentManagement);\n});\n\n/***/ })\n\n},[148]);\n\npbjsChunk([0],{\n\n/***/ 230:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(231);\nmodule.exports = __webpack_require__(237);\n\n\n/***/ }),\n\n/***/ 231:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.spec = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _utils = __webpack_require__(0);\n\nvar utils = _interopRequireWildcard(_utils);\n\nvar _mediaTypes = __webpack_require__(3);\n\nvar _config = __webpack_require__(4);\n\nvar _isArray = __webpack_require__(232);\n\nvar _isArray2 = _interopRequireDefault(_isArray);\n\nvar _isInteger = __webpack_require__(234);\n\nvar _isInteger2 = _interopRequireDefault(_isInteger);\n\nvar _bidderFactory = __webpack_require__(1);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nvar BIDDER_CODE = 'ix';\nvar BANNER_SECURE_BID_URL = 'https://as-sec.casalemedia.com/cygnus';\nvar BANNER_INSECURE_BID_URL = 'http://as.casalemedia.com/cygnus';\nvar SUPPORTED_AD_TYPES = [_mediaTypes.BANNER];\nvar ENDPOINT_VERSION = 7.2;\nvar CENT_TO_DOLLAR_FACTOR = 100;\nvar TIME_TO_LIVE = 60;\nvar NET_REVENUE = true;\n\n// Always start by assuming the protocol is HTTPS. This way, it will work\n// whether the page protocol is HTTP or HTTPS. Then check if the page is\n// actually HTTP.If we can guarantee it is, then, and only then, set protocol to\n// HTTP.\nvar isSecureWeb = true;\nif (utils.getTopWindowLocation().protocol.indexOf('https') !== 0) {\n  isSecureWeb = false;\n}\nvar baseUrl = isSecureWeb ? BANNER_SECURE_BID_URL : BANNER_INSECURE_BID_URL;\n\nvar PRICE_TO_DOLLAR_FACTOR = {\n  JPY: 1\n};\n\n/**\n * Transform valid bid request config object to impression object that will be sent to ad server.\n *\n * @param  {object} bid A valid bid request config object.\n * @return {object}     A impression object that will be sent to ad server.\n */\nfunction bidToBannerImp(bid) {\n  var imp = {};\n\n  imp.id = bid.bidId;\n\n  imp.banner = {};\n  imp.banner.w = bid.params.size[0];\n  imp.banner.h = bid.params.size[1];\n  imp.banner.topframe = utils.inIframe() ? 0 : 1;\n\n  imp.ext = {};\n  imp.ext.sid = bid.params.size[0] + 'x' + bid.params.size[1];\n  imp.ext.siteID = bid.params.siteId;\n\n  if (bid.params.hasOwnProperty('bidFloor') && bid.params.hasOwnProperty('bidFloorCur')) {\n    imp.bidfloor = bid.params.bidFloor;\n    imp.bidfloorcur = bid.params.bidFloorCur;\n  }\n\n  return imp;\n}\n\n/**\n * Parses a raw bid for the relevant information.\n *\n * @param  {object} rawBid   The bid to be parsed.\n * @param  {string} currency Global currency in bid response.\n * @return {object} bid      The parsed bid.\n */\nfunction parseBid(rawBid, currency) {\n  var bid = {};\n\n  if (PRICE_TO_DOLLAR_FACTOR.hasOwnProperty(currency)) {\n    bid.cpm = rawBid.price / PRICE_TO_DOLLAR_FACTOR[currency];\n  } else {\n    bid.cpm = rawBid.price / CENT_TO_DOLLAR_FACTOR;\n  }\n\n  bid.requestId = rawBid.impid;\n  bid.width = rawBid.w;\n  bid.height = rawBid.h;\n  bid.ad = rawBid.adm;\n  bid.dealId = utils.deepAccess(rawBid, 'ext.dealid');\n  bid.ttl = TIME_TO_LIVE;\n  bid.netRevenue = NET_REVENUE;\n  bid.currency = currency;\n  bid.creativeId = rawBid.hasOwnProperty('crid') ? rawBid.crid : '-';\n\n  return bid;\n}\n\n/**\n * Determines whether or not the given object is valid size format.\n *\n * @param  {*}       size The object to be validated.\n * @return {boolean}      True if this is a valid size format, and false otherwise.\n */\nfunction isValidSize(size) {\n  return (0, _isArray2.default)(size) && size.length === 2 && (0, _isInteger2.default)(size[0]) && (0, _isInteger2.default)(size[1]);\n}\n\n/**\n * Determines whether or not the given size object is an element of the size\n * array.\n *\n * @param  {array}  sizeArray The size array.\n * @param  {object} size      The size object.\n * @return {boolean}          True if the size object is an element of the size array, and false\n *                            otherwise.\n */\nfunction includesSize(sizeArray, size) {\n  if (isValidSize(sizeArray)) {\n    return sizeArray[0] === size[0] && sizeArray[1] === size[1];\n  }\n\n  for (var i = 0; i < sizeArray.length; i++) {\n    if (sizeArray[i][0] === size[0] && sizeArray[i][1] === size[1]) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\n/**\n * Determines whether or not the given bidFloor parameters are valid.\n *\n * @param  {*}       bidFloor    The bidFloor parameter inside bid request config.\n * @param  {*}       bidFloorCur The bidFloorCur parameter inside bid request config.\n * @return {boolean}             True if this is a valid biFfloor parameters format, and false\n *                               otherwise.\n */\nfunction isValidBidFloorParams(bidFloor, bidFloorCur) {\n  var curRegex = /^[A-Z]{3}$/;\n\n  return Boolean(typeof bidFloor === 'number' && typeof bidFloorCur === 'string' && bidFloorCur.match(curRegex));\n}\n\nvar spec = exports.spec = {\n\n  code: BIDDER_CODE,\n  supportedMediaTypes: SUPPORTED_AD_TYPES,\n\n  /**\n   * Determines whether or not the given bid request is valid.\n   *\n   * @param  {object}  bid The bid to validate.\n   * @return {boolean}     True if this is a valid bid, and false otherwise.\n   */\n  isBidRequestValid: function isBidRequestValid(bid) {\n    if (!isValidSize(bid.params.size)) {\n      return false;\n    }\n\n    if (!includesSize(bid.sizes, bid.params.size)) {\n      return false;\n    }\n\n    if (typeof bid.params.siteId !== 'string') {\n      return false;\n    }\n\n    var hasBidFloor = bid.params.hasOwnProperty('bidFloor');\n    var hasBidFloorCur = bid.params.hasOwnProperty('bidFloorCur');\n\n    if (hasBidFloor || hasBidFloorCur) {\n      return hasBidFloor && hasBidFloorCur && isValidBidFloorParams(bid.params.bidFloor, bid.params.bidFloorCur);\n    }\n\n    return true;\n  },\n\n  /**\n   * Make a server request from the list of BidRequests.\n   *\n   * @param  {array}  validBidRequests A list of valid bid request config objects.\n   * @param  {object} options          A object contains bids and other info like gdprConsent.\n   * @return {object}                  Info describing the request to the server.\n   */\n  buildRequests: function buildRequests(validBidRequests, options) {\n    var bannerImps = [];\n    var validBidRequest = null;\n    var bannerImp = null;\n\n    for (var i = 0; i < validBidRequests.length; i++) {\n      validBidRequest = validBidRequests[i];\n\n      // If the bid request is for banner, then transform the bid request based on banner format.\n      if (utils.deepAccess(validBidRequest, 'mediaTypes.banner') || validBidRequest.mediaType === 'banner') {\n        bannerImp = bidToBannerImp(validBidRequest);\n        bannerImps.push(bannerImp);\n      }\n    }\n\n    var r = {};\n\n    // Since bidderRequestId are the same for different bid request, just use the first one.\n    r.id = validBidRequests[0].bidderRequestId;\n\n    r.imp = bannerImps;\n    r.site = {};\n    r.site.page = utils.getTopWindowUrl();\n    r.site.ref = utils.getTopWindowReferrer();\n    r.ext = {};\n    r.ext.source = 'prebid';\n\n    // Apply GDPR information to the request if GDPR is enabled.\n    if (options && options.gdprConsent) {\n      var gdprConsent = options.gdprConsent;\n\n      if (gdprConsent.hasOwnProperty('gdprApplies')) {\n        r.regs = {\n          ext: {\n            gdpr: gdprConsent.gdprApplies ? 1 : 0\n          }\n        };\n      }\n\n      if (gdprConsent.hasOwnProperty('consentString')) {\n        r.user = {\n          ext: {\n            consent: gdprConsent.consentString || ''\n          }\n        };\n      }\n    }\n\n    var payload = {};\n\n    // Parse additional runtime configs.\n    var otherIxConfig = _config.config.getConfig('ix');\n    if (otherIxConfig) {\n      // Append firstPartyData to r.site.page if firstPartyData exists.\n      if (_typeof(otherIxConfig.firstPartyData) === 'object') {\n        var firstPartyData = otherIxConfig.firstPartyData;\n        var firstPartyString = '?';\n        for (var key in firstPartyData) {\n          if (firstPartyData.hasOwnProperty(key)) {\n            firstPartyString += encodeURIComponent(key) + '=' + encodeURIComponent(firstPartyData[key]) + '&';\n          }\n        }\n        firstPartyString = firstPartyString.slice(0, -1);\n\n        r.site.page += firstPartyString;\n      }\n\n      // Create t in payload if timeout is configured.\n      if (typeof otherIxConfig.timeout === 'number') {\n        payload.t = otherIxConfig.timeout;\n      }\n    }\n\n    // Use the siteId in the first bid request as the main siteId.\n    payload.s = validBidRequests[0].params.siteId;\n\n    payload.v = ENDPOINT_VERSION;\n    payload.r = JSON.stringify(r);\n    payload.ac = 'j';\n    payload.sd = 1;\n\n    return {\n      method: 'GET',\n      url: baseUrl,\n      data: payload\n    };\n  },\n\n  /**\n   * Unpack the response from the server into a list of bids.\n   *\n   * @param  {object} serverResponse A successful response from the server.\n   * @return {array}                 An array of bids which were nested inside the server.\n   */\n  interpretResponse: function interpretResponse(serverResponse) {\n    var bids = [];\n    var bid = null;\n\n    if (!serverResponse.hasOwnProperty('body') || !serverResponse.body.hasOwnProperty('seatbid')) {\n      return bids;\n    }\n\n    var responseBody = serverResponse.body;\n    var seatbid = responseBody.seatbid;\n    for (var i = 0; i < seatbid.length; i++) {\n      if (!seatbid[i].hasOwnProperty('bid')) {\n        continue;\n      }\n\n      // Transform rawBid in bid response to the format that will be accepted by prebid.\n      var innerBids = seatbid[i].bid;\n      for (var j = 0; j < innerBids.length; j++) {\n        bid = parseBid(innerBids[j], responseBody.cur);\n        bids.push(bid);\n      }\n    }\n\n    return bids;\n  }\n};\n\n(0, _bidderFactory.registerBidder)(spec);\n\n/***/ }),\n\n/***/ 232:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(233);\nmodule.exports = __webpack_require__(15).Array.isArray;\n\n\n/***/ }),\n\n/***/ 233:\n/***/ (function(module, exports, __webpack_require__) {\n\n// 22.1.2.2 / 15.4.3.2 Array.isArray(arg)\nvar $export = __webpack_require__(16);\n\n$export($export.S, 'Array', { isArray: __webpack_require__(36) });\n\n\n/***/ }),\n\n/***/ 234:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(235);\nmodule.exports = __webpack_require__(15).Number.isInteger;\n\n\n/***/ }),\n\n/***/ 235:\n/***/ (function(module, exports, __webpack_require__) {\n\n// 20.1.2.3 Number.isInteger(number)\nvar $export = __webpack_require__(16);\n\n$export($export.S, 'Number', { isInteger: __webpack_require__(236) });\n\n\n/***/ }),\n\n/***/ 236:\n/***/ (function(module, exports, __webpack_require__) {\n\n// 20.1.2.3 Number.isInteger(number)\nvar isObject = __webpack_require__(17);\nvar floor = Math.floor;\nmodule.exports = function isInteger(it) {\n  return !isObject(it) && isFinite(it) && floor(it) === it;\n};\n\n\n/***/ }),\n\n/***/ 237:\n/***/ (function(module, exports) {\n\n\n\n/***/ })\n\n},[230]);\n\npbjsChunk([58],{\n\n/***/ 291:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(292);\nmodule.exports = __webpack_require__(293);\n\n\n/***/ }),\n\n/***/ 292:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.spec = undefined;\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nexports.resetBoPixel = resetBoPixel;\n\nvar _config = __webpack_require__(4);\n\nvar _bidderFactory = __webpack_require__(1);\n\nvar _utils = __webpack_require__(0);\n\nvar utils = _interopRequireWildcard(_utils);\n\nvar _userSync = __webpack_require__(13);\n\nvar _mediaTypes = __webpack_require__(3);\n\nvar _url = __webpack_require__(12);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nvar SUPPORTED_AD_TYPES = [_mediaTypes.BANNER, _mediaTypes.VIDEO];\nvar BIDDER_CODE = 'openx';\nvar BIDDER_CONFIG = 'hb_pb';\nvar BIDDER_VERSION = '2.1.0';\n\nvar shouldSendBoPixel = true;\nfunction resetBoPixel() {\n  shouldSendBoPixel = true;\n}\n\nvar spec = exports.spec = {\n  code: BIDDER_CODE,\n  supportedMediaTypes: SUPPORTED_AD_TYPES,\n  isBidRequestValid: function isBidRequestValid(bidRequest) {\n    return !!(bidRequest.params.unit && bidRequest.params.delDomain);\n  },\n  buildRequests: function buildRequests(bidRequests, bidderRequest) {\n    if (bidRequests.length === 0) {\n      return [];\n    }\n\n    var requests = [];\n\n    var _partitionByVideoBids = partitionByVideoBids(bidRequests),\n        _partitionByVideoBids2 = _slicedToArray(_partitionByVideoBids, 2),\n        videoBids = _partitionByVideoBids2[0],\n        bannerBids = _partitionByVideoBids2[1];\n\n    // build banner requests\n\n\n    if (bannerBids.length > 0) {\n      requests.push(buildOXBannerRequest(bannerBids, bidderRequest));\n    }\n    // build video requests\n    if (videoBids.length > 0) {\n      videoBids.forEach(function (videoBid) {\n        requests.push(buildOXVideoRequest(videoBid, bidderRequest));\n      });\n    }\n\n    return requests;\n  },\n  interpretResponse: function interpretResponse(_ref, serverRequest) {\n    var oxResponseObj = _ref.body;\n\n    var mediaType = getMediaTypeFromRequest(serverRequest);\n\n    return mediaType === _mediaTypes.VIDEO ? createVideoBidResponses(oxResponseObj, serverRequest.payload) : createBannerBidResponses(oxResponseObj, serverRequest.payload);\n  },\n  getUserSyncs: function getUserSyncs(syncOptions, responses) {\n    if (syncOptions.iframeEnabled) {\n      var url = utils.deepAccess(responses, '0.body.ads.pixels') || utils.deepAccess(responses, '0.body.pixels') || '//u.openx.net/w/1.0/pd';\n      return [{\n        type: 'iframe',\n        url: url\n      }];\n    }\n  }\n};\n\nfunction isVideoRequest(bidRequest) {\n  return utils.deepAccess(bidRequest, 'mediaTypes.video') || bidRequest.mediaType === _mediaTypes.VIDEO;\n}\n\nfunction createBannerBidResponses(oxResponseObj, _ref2) {\n  var bids = _ref2.bids,\n      startTime = _ref2.startTime;\n\n  var adUnits = oxResponseObj.ads.ad;\n  var bidResponses = [];\n  for (var i = 0; i < adUnits.length; i++) {\n    var adUnit = adUnits[i];\n    var adUnitIdx = parseInt(adUnit.idx, 10);\n    var bidResponse = {};\n\n    bidResponse.requestId = bids[adUnitIdx].bidId;\n\n    if (adUnit.pub_rev) {\n      bidResponse.cpm = Number(adUnit.pub_rev) / 1000;\n    } else {\n      // No fill, do not add the bidresponse\n      continue;\n    }\n    var creative = adUnit.creative[0];\n    if (creative) {\n      bidResponse.width = creative.width;\n      bidResponse.height = creative.height;\n    }\n    bidResponse.creativeId = creative.id;\n    bidResponse.ad = adUnit.html;\n    if (adUnit.deal_id) {\n      bidResponse.dealId = adUnit.deal_id;\n    }\n    // default 5 mins\n    bidResponse.ttl = 300;\n    // true is net, false is gross\n    bidResponse.netRevenue = true;\n    bidResponse.currency = adUnit.currency;\n\n    // additional fields to add\n    if (adUnit.tbd) {\n      bidResponse.tbd = adUnit.tbd;\n    }\n    bidResponse.ts = adUnit.ts;\n\n    bidResponses.push(bidResponse);\n\n    registerBeacon(_mediaTypes.BANNER, adUnit, startTime);\n  }\n  return bidResponses;\n}\n\nfunction buildQueryStringFromParams(params) {\n  for (var key in params) {\n    if (params.hasOwnProperty(key)) {\n      if (!params[key]) {\n        delete params[key];\n      }\n    }\n  }\n  return utils._map(Object.keys(params), function (key) {\n    return key + '=' + params[key];\n  }).join('&');\n}\n\nfunction getViewportDimensions(isIfr) {\n  var width = void 0;\n  var height = void 0;\n  var tWin = window;\n  var tDoc = document;\n  var docEl = tDoc.documentElement;\n  var body = void 0;\n\n  if (isIfr) {\n    try {\n      tWin = window.top;\n      tDoc = window.top.document;\n    } catch (e) {\n      return;\n    }\n    docEl = tDoc.documentElement;\n    body = tDoc.body;\n\n    width = tWin.innerWidth || docEl.clientWidth || body.clientWidth;\n    height = tWin.innerHeight || docEl.clientHeight || body.clientHeight;\n  } else {\n    docEl = tDoc.documentElement;\n    width = tWin.innerWidth || docEl.clientWidth;\n    height = tWin.innerHeight || docEl.clientHeight;\n  }\n\n  return width + 'x' + height;\n}\n\nfunction formatCustomParms(customKey, customParams) {\n  var value = customParams[customKey];\n  if (utils.isArray(value)) {\n    // if value is an array, join them with commas first\n    value = value.join(',');\n  }\n  // return customKey=customValue format, escaping + to . and / to _\n  return (customKey.toLowerCase() + '=' + value.toLowerCase()).replace('+', '.').replace('/', '_');\n}\n\nfunction partitionByVideoBids(bidRequests) {\n  return bidRequests.reduce(function (acc, bid) {\n    // Fallback to banner ads if nothing specified\n    if (isVideoRequest(bid)) {\n      acc[0].push(bid);\n    } else {\n      acc[1].push(bid);\n    }\n    return acc;\n  }, [[], []]);\n}\n\nfunction getMediaTypeFromRequest(serverRequest) {\n  return (/avjp$/.test(serverRequest.url) ? _mediaTypes.VIDEO : _mediaTypes.BANNER\n  );\n}\n\nfunction buildCommonQueryParamsFromBids(bids, bidderRequest) {\n  var isInIframe = utils.inIframe();\n  var defaultParams = void 0;\n\n  defaultParams = {\n    ju: _config.config.getConfig('pageUrl') || utils.getTopWindowUrl(),\n    jr: utils.getTopWindowReferrer(),\n    ch: document.charSet || document.characterSet,\n    res: screen.width + 'x' + screen.height + 'x' + screen.colorDepth,\n    ifr: isInIframe,\n    tz: new Date().getTimezoneOffset(),\n    tws: getViewportDimensions(isInIframe),\n    be: 1,\n    dddid: utils._map(bids, function (bid) {\n      return bid.transactionId;\n    }).join(','),\n    nocache: new Date().getTime()\n  };\n\n  if (utils.deepAccess(bidderRequest, 'gdprConsent')) {\n    var gdprConsentConfig = bidderRequest.gdprConsent;\n\n    if (gdprConsentConfig.consentString !== undefined) {\n      defaultParams.gdpr_consent = gdprConsentConfig.consentString;\n    }\n\n    if (gdprConsentConfig.gdprApplies !== undefined) {\n      defaultParams.gdpr = gdprConsentConfig.gdprApplies ? 1 : 0;\n    }\n\n    if (_config.config.getConfig('consentManagement.cmpApi') === 'iab') {\n      defaultParams.x_gdpr_f = 1;\n    }\n  }\n\n  return defaultParams;\n}\n\nfunction buildOXBannerRequest(bids, bidderRequest) {\n  var queryParams = buildCommonQueryParamsFromBids(bids, bidderRequest);\n\n  queryParams.auid = utils._map(bids, function (bid) {\n    return bid.params.unit;\n  }).join(',');\n  queryParams.aus = utils._map(bids, function (bid) {\n    return utils.parseSizesInput(bid.sizes).join(',');\n  }).join('|');\n  queryParams.bc = bids[0].params.bc || BIDDER_CONFIG + '_' + BIDDER_VERSION;\n\n  var customParamsForAllBids = [];\n  var hasCustomParam = false;\n  bids.forEach(function (bid) {\n    if (bid.params.customParams) {\n      var customParamsForBid = utils._map(Object.keys(bid.params.customParams), function (customKey) {\n        return formatCustomParms(customKey, bid.params.customParams);\n      });\n      var formattedCustomParams = window.btoa(customParamsForBid.join('&'));\n      hasCustomParam = true;\n      customParamsForAllBids.push(formattedCustomParams);\n    } else {\n      customParamsForAllBids.push('');\n    }\n  });\n  if (hasCustomParam) {\n    queryParams.tps = customParamsForAllBids.join(',');\n  }\n\n  var customFloorsForAllBids = [];\n  var hasCustomFloor = false;\n  bids.forEach(function (bid) {\n    if (bid.params.customFloor) {\n      customFloorsForAllBids.push(bid.params.customFloor * 1000);\n      hasCustomFloor = true;\n    } else {\n      customFloorsForAllBids.push(0);\n    }\n  });\n  if (hasCustomFloor) {\n    queryParams.aumfs = customFloorsForAllBids.join(',');\n  }\n\n  var url = '//' + bids[0].params.delDomain + '/w/1.0/arj';\n  return {\n    method: 'GET',\n    url: url,\n    data: queryParams,\n    payload: { 'bids': bids, 'startTime': new Date() }\n  };\n}\n\nfunction buildOXVideoRequest(bid, bidderRequest) {\n  var url = '//' + bid.params.delDomain + '/v/1.0/avjp';\n  var oxVideoParams = generateVideoParameters(bid, bidderRequest);\n  return {\n    method: 'GET',\n    url: url,\n    data: oxVideoParams,\n    payload: { 'bid': bid, 'startTime': new Date() }\n  };\n}\n\nfunction generateVideoParameters(bid, bidderRequest) {\n  var queryParams = buildCommonQueryParamsFromBids([bid], bidderRequest);\n  var oxVideoConfig = utils.deepAccess(bid, 'params.video') || {};\n  var context = utils.deepAccess(bid, 'mediaTypes.video.context');\n  var playerSize = utils.deepAccess(bid, 'mediaTypes.video.playerSize');\n  var width = void 0;\n  var height = void 0;\n\n  // normalize config for video size\n  if (utils.isArray(bid.sizes) && bid.sizes.length === 2 && !utils.isArray(bid.sizes[0])) {\n    width = parseInt(bid.sizes[0], 10);\n    height = parseInt(bid.sizes[1], 10);\n  } else if (utils.isArray(bid.sizes) && utils.isArray(bid.sizes[0]) && bid.sizes[0].length === 2) {\n    width = parseInt(bid.sizes[0][0], 10);\n    height = parseInt(bid.sizes[0][1], 10);\n  } else if (utils.isArray(playerSize) && playerSize.length === 2) {\n    width = parseInt(playerSize[0], 10);\n    height = parseInt(playerSize[1], 10);\n  }\n\n  Object.keys(oxVideoConfig).forEach(function (key) {\n    if (key === 'openrtb') {\n      oxVideoConfig[key].w = width || oxVideoConfig[key].w;\n      oxVideoConfig[key].v = height || oxVideoConfig[key].v;\n      queryParams[key] = JSON.stringify(oxVideoConfig[key]);\n    } else if (!(key in queryParams) && key !== 'url') {\n      // only allow video-related attributes\n      queryParams[key] = oxVideoConfig[key];\n    }\n  });\n\n  queryParams.auid = bid.params.unit;\n  // override prebid config with openx config if available\n  queryParams.vwd = width || oxVideoConfig.vwd;\n  queryParams.vht = height || oxVideoConfig.vht;\n\n  if (context === 'outstream') {\n    queryParams.vos = '101';\n  }\n\n  if (oxVideoConfig.mimes) {\n    queryParams.vmimes = oxVideoConfig.mimes;\n  }\n\n  return queryParams;\n}\n\nfunction createVideoBidResponses(response, _ref3) {\n  var bid = _ref3.bid,\n      startTime = _ref3.startTime;\n\n  var bidResponses = [];\n\n  if (response !== undefined && response.vastUrl !== '' && response.pub_rev !== '') {\n    var vastQueryParams = (0, _url.parse)(response.vastUrl).search || {};\n    var bidResponse = {};\n    bidResponse.requestId = bid.bidId;\n    bidResponse.bidderCode = BIDDER_CODE;\n    // default 5 mins\n    bidResponse.ttl = 300;\n    // true is net, false is gross\n    bidResponse.netRevenue = true;\n    bidResponse.currency = response.currency;\n    bidResponse.cpm = Number(response.pub_rev) / 1000;\n    bidResponse.width = response.width;\n    bidResponse.height = response.height;\n    bidResponse.creativeId = response.adid;\n    bidResponse.vastUrl = response.vastUrl;\n    bidResponse.mediaType = _mediaTypes.VIDEO;\n\n    // enrich adunit with vast parameters\n    response.ph = vastQueryParams.ph;\n    response.colo = vastQueryParams.colo;\n    response.ts = vastQueryParams.ts;\n\n    bidResponses.push(bidResponse);\n\n    registerBeacon(_mediaTypes.VIDEO, response, startTime);\n  }\n\n  return bidResponses;\n}\n\nfunction registerBeacon(mediaType, adUnit, startTime) {\n  // only register beacon once\n  if (!shouldSendBoPixel) {\n    return;\n  }\n  shouldSendBoPixel = false;\n\n  var bt = _config.config.getConfig('bidderTimeout');\n  var beaconUrl = void 0;\n  if (window.PREBID_TIMEOUT) {\n    bt = Math.min(window.PREBID_TIMEOUT, bt);\n  }\n\n  var beaconParams = {\n    bd: +new Date() - startTime,\n    bp: adUnit.pub_rev,\n    br: '0', // may be 0, t, or p\n    bs: utils.getTopWindowLocation().hostname,\n    bt: bt,\n    ts: adUnit.ts\n  };\n\n  beaconParams.br = beaconParams.bt < beaconParams.bd ? 't' : 'p';\n\n  if (mediaType === _mediaTypes.VIDEO) {\n    var url = (0, _url.parse)(adUnit.colo);\n    beaconParams.ph = adUnit.ph;\n    beaconUrl = '//' + url.hostname + '/w/1.0/bo?' + buildQueryStringFromParams(beaconParams);\n  } else {\n    var recordPixel = utils.deepAccess(adUnit, 'creative.0.tracking.impression');\n    var boBase = recordPixel.match(/([^?]+\\/)ri\\?/);\n\n    if (boBase && boBase.length > 1) {\n      beaconUrl = boBase[1] + 'bo?' + buildQueryStringFromParams(beaconParams);\n    }\n  }\n\n  if (beaconUrl) {\n    _userSync.userSync.registerSync('image', BIDDER_CODE, beaconUrl);\n  }\n}\n\n(0, _bidderFactory.registerBidder)(spec);\n\n/***/ }),\n\n/***/ 293:\n/***/ (function(module, exports) {\n\n\n\n/***/ })\n\n},[291]);\n\npbjsChunk([50],{\n\n/***/ 319:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(320);\nmodule.exports = __webpack_require__(321);\n\n\n/***/ }),\n\n/***/ 320:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.spec = undefined;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nvar _utils = __webpack_require__(0);\n\nvar utils = _interopRequireWildcard(_utils);\n\nvar _bidderFactory = __webpack_require__(1);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nvar constants = __webpack_require__(2);\n\nvar BIDDER_CODE = 'pubmatic';\nvar ENDPOINT = '//hbopenbid.pubmatic.com/translator?source=prebid-client';\nvar USYNCURL = '//ads.pubmatic.com/AdServer/js/showad.js#PIX&kdntuid=1&p=';\nvar CURRENCY = 'USD';\nvar AUCTION_TYPE = 1;\nvar UNDEFINED = undefined;\nvar CUSTOM_PARAMS = {\n  'kadpageurl': '', // Custom page url\n  'gender': '', // User gender\n  'yob': '', // User year of birth\n  'lat': '', // User location - Latitude\n  'lon': '', // User Location - Longitude\n  'wiid': '', // OpenWrap Wrapper Impression ID\n  'profId': '', // OpenWrap Legacy: Profile ID\n  'verId': '' // OpenWrap Legacy: version ID\n};\nvar NET_REVENUE = false;\nvar dealChannelValues = {\n  1: 'PMP',\n  5: 'PREF',\n  6: 'PMPG'\n};\n\nvar publisherId = 0;\n\nfunction _getDomainFromURL(url) {\n  var anchor = document.createElement('a');\n  anchor.href = url;\n  return anchor.hostname;\n}\n\nfunction _parseSlotParam(paramName, paramValue) {\n  if (!utils.isStr(paramValue)) {\n    paramValue && utils.logWarn('PubMatic: Ignoring param key: ' + paramName + ', expects string-value, found ' + (typeof paramValue === 'undefined' ? 'undefined' : _typeof(paramValue)));\n    return UNDEFINED;\n  }\n\n  switch (paramName) {\n    case 'pmzoneid':\n      return paramValue.split(',').slice(0, 50).map(function (id) {\n        return id.trim();\n      }).join();\n    case 'kadfloor':\n      return parseFloat(paramValue) || UNDEFINED;\n    case 'lat':\n      return parseFloat(paramValue) || UNDEFINED;\n    case 'lon':\n      return parseFloat(paramValue) || UNDEFINED;\n    case 'yob':\n      return parseInt(paramValue) || UNDEFINED;\n    default:\n      return paramValue;\n  }\n}\n\nfunction _cleanSlot(slotName) {\n  if (utils.isStr(slotName)) {\n    return slotName.replace(/^\\s+/g, '').replace(/\\s+$/g, '');\n  }\n  return '';\n}\n\nfunction _parseAdSlot(bid) {\n  bid.params.adUnit = '';\n  bid.params.adUnitIndex = '0';\n  bid.params.width = 0;\n  bid.params.height = 0;\n\n  bid.params.adSlot = _cleanSlot(bid.params.adSlot);\n\n  var slot = bid.params.adSlot;\n  var splits = slot.split(':');\n\n  slot = splits[0];\n  if (splits.length == 2) {\n    bid.params.adUnitIndex = splits[1];\n  }\n  splits = slot.split('@');\n  if (splits.length != 2) {\n    utils.logWarn('AdSlot Error: adSlot not in required format');\n    return;\n  }\n  bid.params.adUnit = splits[0];\n  splits = splits[1].split('x');\n  if (splits.length != 2) {\n    utils.logWarn('AdSlot Error: adSlot not in required format');\n    return;\n  }\n  bid.params.width = parseInt(splits[0]);\n  bid.params.height = parseInt(splits[1]);\n}\n\nfunction _initConf() {\n  var conf = {};\n  conf.pageURL = utils.getTopWindowUrl();\n  conf.refURL = utils.getTopWindowReferrer();\n  return conf;\n}\n\nfunction _handleCustomParams(params, conf) {\n  if (!conf.kadpageurl) {\n    conf.kadpageurl = conf.pageURL;\n  }\n\n  var key, value, entry;\n  for (key in CUSTOM_PARAMS) {\n    if (CUSTOM_PARAMS.hasOwnProperty(key)) {\n      value = params[key];\n      if (value) {\n        entry = CUSTOM_PARAMS[key];\n\n        if ((typeof entry === 'undefined' ? 'undefined' : _typeof(entry)) === 'object') {\n          // will be used in future when we want to process a custom param before using\n          // 'keyname': {f: function() {}}\n          value = entry.f(value, conf);\n        }\n\n        if (utils.isStr(value)) {\n          conf[key] = value;\n        } else {\n          utils.logWarn('PubMatic: Ignoring param : ' + key + ' with value : ' + CUSTOM_PARAMS[key] + ', expects string-value, found ' + (typeof value === 'undefined' ? 'undefined' : _typeof(value)));\n        }\n      }\n    }\n  }\n  return conf;\n}\n\nfunction _createOrtbTemplate(conf) {\n  return {\n    id: '' + new Date().getTime(),\n    at: AUCTION_TYPE,\n    cur: [CURRENCY],\n    imp: [],\n    site: {\n      page: conf.pageURL,\n      ref: conf.refURL,\n      publisher: {}\n    },\n    device: {\n      ua: navigator.userAgent,\n      js: 1,\n      dnt: navigator.doNotTrack == 'yes' || navigator.doNotTrack == '1' || navigator.msDoNotTrack == '1' ? 1 : 0,\n      h: screen.height,\n      w: screen.width,\n      language: navigator.language\n    },\n    user: {},\n    ext: {}\n  };\n}\n\nfunction _createImpressionObject(bid, conf) {\n  return {\n    id: bid.bidId,\n    tagid: bid.params.adUnit,\n    bidfloor: _parseSlotParam('kadfloor', bid.params.kadfloor),\n    secure: window.location.protocol === 'https:' ? 1 : 0,\n    banner: {\n      pos: 0,\n      w: bid.params.width,\n      h: bid.params.height,\n      topframe: utils.inIframe() ? 0 : 1\n    },\n    ext: {\n      pmZoneId: _parseSlotParam('pmzoneid', bid.params.pmzoneid)\n    }\n  };\n}\n\nvar spec = exports.spec = {\n  code: BIDDER_CODE,\n\n  /**\n  * Determines whether or not the given bid request is valid. Valid bid request must have placementId and hbid\n  *\n  * @param {BidRequest} bid The bid params to validate.\n  * @return boolean True if this is a valid bid, and false otherwise.\n  */\n  isBidRequestValid: function isBidRequestValid(bid) {\n    if (bid && bid.params) {\n      if (!utils.isStr(bid.params.publisherId)) {\n        utils.logWarn('PubMatic Error: publisherId is mandatory and cannot be numeric. Call to OpenBid will not be sent.');\n        return false;\n      }\n      if (!utils.isStr(bid.params.adSlot)) {\n        utils.logWarn('PubMatic: adSlotId is mandatory and cannot be numeric. Call to OpenBid will not be sent.');\n        return false;\n      }\n      return true;\n    }\n    return false;\n  },\n\n  /**\n  * Make a server request from the list of BidRequests.\n  *\n  * @param {validBidRequests[]} - an array of bids\n  * @return ServerRequest Info describing the request to the server.\n  */\n  buildRequests: function buildRequests(validBidRequests, bidderRequest) {\n    var conf = _initConf();\n    var payload = _createOrtbTemplate(conf);\n    validBidRequests.forEach(function (bid) {\n      _parseAdSlot(bid);\n      if (!(bid.params.adSlot && bid.params.adUnit && bid.params.adUnitIndex && bid.params.width && bid.params.height)) {\n        utils.logWarn('PubMatic: Skipping the non-standard adslot:', bid.params.adSlot, bid);\n        return;\n      }\n      conf.pubId = conf.pubId || bid.params.publisherId;\n      conf = _handleCustomParams(bid.params, conf);\n      conf.transactionId = bid.transactionId;\n      payload.imp.push(_createImpressionObject(bid, conf));\n    });\n\n    if (payload.imp.length == 0) {\n      return;\n    }\n\n    payload.site.publisher.id = conf.pubId.trim();\n    publisherId = conf.pubId.trim();\n    payload.ext.wrapper = {};\n    payload.ext.wrapper.profile = parseInt(conf.profId) || UNDEFINED;\n    payload.ext.wrapper.version = parseInt(conf.verId) || UNDEFINED;\n    payload.ext.wrapper.wiid = conf.wiid || UNDEFINED;\n    payload.ext.wrapper.wv = constants.REPO_AND_VERSION;\n    payload.ext.wrapper.transactionId = conf.transactionId;\n    payload.ext.wrapper.wp = 'pbjs';\n    payload.user.gender = conf.gender ? conf.gender.trim() : UNDEFINED;\n    payload.user.geo = {};\n\n    // Attaching GDPR Consent Params\n    if (bidderRequest && bidderRequest.gdprConsent) {\n      payload.user.ext = {\n        consent: bidderRequest.gdprConsent.consentString\n      };\n\n      payload.regs = {\n        ext: {\n          gdpr: bidderRequest.gdprConsent.gdprApplies ? 1 : 0\n        }\n      };\n    }\n\n    payload.user.geo.lat = _parseSlotParam('lat', conf.lat);\n    payload.user.geo.lon = _parseSlotParam('lon', conf.lon);\n    payload.user.yob = _parseSlotParam('yob', conf.yob);\n    payload.device.geo = {};\n    payload.device.geo.lat = _parseSlotParam('lat', conf.lat);\n    payload.device.geo.lon = _parseSlotParam('lon', conf.lon);\n    payload.site.page = conf.kadpageurl.trim() || payload.site.page.trim();\n    payload.site.domain = _getDomainFromURL(payload.site.page);\n    return {\n      method: 'POST',\n      url: ENDPOINT,\n      data: JSON.stringify(payload)\n    };\n  },\n\n  /**\n  * Unpack the response from the server into a list of bids.\n  *\n  * @param {*} response A successful response from the server.\n  * @return {Bid[]} An array of bids which were nested inside the server.\n  */\n  interpretResponse: function interpretResponse(response, request) {\n    var bidResponses = [];\n    try {\n      if (response.body && response.body.seatbid && utils.isArray(response.body.seatbid)) {\n        // Supporting multiple bid responses for same adSize\n        response.body.seatbid.forEach(function (seatbidder) {\n          seatbidder.bid && utils.isArray(seatbidder.bid) && seatbidder.bid.forEach(function (bid) {\n            var newBid = {\n              requestId: bid.impid,\n              cpm: (parseFloat(bid.price) || 0).toFixed(2),\n              width: bid.w,\n              height: bid.h,\n              creativeId: bid.crid || bid.id,\n              dealId: bid.dealid,\n              currency: CURRENCY,\n              netRevenue: NET_REVENUE,\n              ttl: 300,\n              referrer: utils.getTopWindowUrl(),\n              ad: bid.adm\n            };\n\n            if (bid.ext && bid.ext.deal_channel) {\n              newBid['dealChannel'] = dealChannelValues[bid.ext.deal_channel] || null;\n            }\n\n            bidResponses.push(newBid);\n          });\n        });\n      }\n    } catch (error) {\n      utils.logError(error);\n    }\n    return bidResponses;\n  },\n\n  /**\n  * Register User Sync.\n  */\n  getUserSyncs: function getUserSyncs(syncOptions, responses, gdprConsent) {\n    var syncurl = USYNCURL + publisherId;\n\n    // Attaching GDPR Consent Params in UserSync url\n    if (gdprConsent) {\n      syncurl += '&gdpr=' + (gdprConsent.gdprApplies ? 1 : 0);\n      syncurl += '&gdpr_consent=' + encodeURIComponent(gdprConsent.consentString || '');\n    }\n\n    if (syncOptions.iframeEnabled) {\n      return [{\n        type: 'iframe',\n        url: syncurl\n      }];\n    } else {\n      utils.logWarn('PubMatic: Please enable iframe based user sync.');\n    }\n  }\n};\n\n(0, _bidderFactory.registerBidder)(spec);\n\n/***/ }),\n\n/***/ 321:\n/***/ (function(module, exports) {\n\n\n\n/***/ })\n\n},[319]);\n\npbjsChunk([36],{\n\n/***/ 360:\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(361);\nmodule.exports = __webpack_require__(362);\n\n\n/***/ }),\n\n/***/ 361:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.spec = undefined;\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\nexports.masSizeOrdering = masSizeOrdering;\nexports.resetUserSync = resetUserSync;\n\nvar _utils = __webpack_require__(0);\n\nvar utils = _interopRequireWildcard(_utils);\n\nvar _bidderFactory = __webpack_require__(1);\n\nvar _config = __webpack_require__(4);\n\nvar _mediaTypes = __webpack_require__(3);\n\nfunction _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }\n\nvar INTEGRATION = 'pbjs_lite_v1.11.0';\n\nfunction isSecure() {\n  return location.protocol === 'https:';\n}\n\n// use protocol relative urls for http or https\nvar FASTLANE_ENDPOINT = '//fastlane.rubiconproject.com/a/api/fastlane.json';\nvar VIDEO_ENDPOINT = '//fastlane-adv.rubiconproject.com/v1/auction/video';\nvar SYNC_ENDPOINT = 'https://eus.rubiconproject.com/usync.html';\n\nvar TIMEOUT_BUFFER = 500;\n\nvar sizeMap = {\n  1: '468x60',\n  2: '728x90',\n  5: '120x90',\n  8: '120x600',\n  9: '160x600',\n  10: '300x600',\n  13: '200x200',\n  14: '250x250',\n  15: '300x250',\n  16: '336x280',\n  19: '300x100',\n  31: '980x120',\n  32: '250x360',\n  33: '180x500',\n  35: '980x150',\n  37: '468x400',\n  38: '930x180',\n  43: '320x50',\n  44: '300x50',\n  48: '300x300',\n  53: '1024x768',\n  54: '300x1050',\n  55: '970x90',\n  57: '970x250',\n  58: '1000x90',\n  59: '320x80',\n  60: '320x150',\n  61: '1000x1000',\n  65: '640x480',\n  67: '320x480',\n  68: '1800x1000',\n  72: '320x320',\n  73: '320x160',\n  78: '980x240',\n  79: '980x300',\n  80: '980x400',\n  83: '480x300',\n  94: '970x310',\n  96: '970x210',\n  101: '480x320',\n  102: '768x1024',\n  103: '480x280',\n  108: '320x240',\n  113: '1000x300',\n  117: '320x100',\n  125: '800x250',\n  126: '200x600',\n  144: '980x600',\n  195: '600x300',\n  199: '640x200',\n  213: '1030x590',\n  214: '980x360'\n};\nutils._each(sizeMap, function (item, key) {\n  return sizeMap[item] = key;\n});\n\nvar spec = exports.spec = {\n  code: 'rubicon',\n  aliases: ['rubiconLite'],\n  supportedMediaTypes: [_mediaTypes.BANNER, _mediaTypes.VIDEO],\n  /**\n   * @param {object} bid\n   * @return boolean\n   */\n  isBidRequestValid: function isBidRequestValid(bid) {\n    if (_typeof(bid.params) !== 'object') {\n      return false;\n    }\n    var params = bid.params;\n\n    if (!/^\\d+$/.test(params.accountId)) {\n      return false;\n    }\n\n    // Log warning if context is 'outstream', is not currently supported\n    if (utils.deepAccess(bid, 'mediaTypes.' + _mediaTypes.VIDEO + '.context') === 'outstream') {\n      utils.logWarn('Warning: outstream video for Rubicon Client Adapter is not supported yet');\n    }\n\n    // Log warning if mediaTypes contains both 'banner' and 'video'\n    if (spec.hasVideoMediaType(bid) && typeof utils.deepAccess(bid, 'mediaTypes.' + _mediaTypes.BANNER) !== 'undefined') {\n      utils.logWarn('Warning: instream video and banner requested for same ad unit, continuing with video instream request');\n    }\n\n    // Bid is invalid if legacy video is set but params video is missing size_id\n    if (bid.mediaType === 'video' && typeof utils.deepAccess(bid, 'params.video.size_id') === 'undefined') {\n      return false;\n    }\n\n    // Bid is invalid if mediaTypes video is invalid and a mediaTypes banner property is not defined\n    if (bid.mediaTypes && !spec.hasVideoMediaType(bid) && typeof bid.mediaTypes.banner === 'undefined') {\n      return false;\n    }\n\n    var parsedSizes = parseSizes(bid);\n    if (parsedSizes.length < 1) {\n      return false;\n    }\n\n    return true;\n  },\n  /**\n   * @param {BidRequest[]} bidRequests\n   * @param bidderRequest\n   * @return ServerRequest[]\n   */\n  buildRequests: function buildRequests(bidRequests, bidderRequest) {\n    return bidRequests.map(function (bidRequest) {\n      bidRequest.startTime = new Date().getTime();\n\n      var page_url = _config.config.getConfig('pageUrl');\n      if (bidRequest.params.referrer) {\n        page_url = bidRequest.params.referrer;\n      } else if (!page_url) {\n        page_url = utils.getTopWindowUrl();\n      }\n\n      // GDPR reference, for use by 'banner' and 'video'\n      var gdprConsent = bidderRequest.gdprConsent;\n\n      if (spec.hasVideoMediaType(bidRequest)) {\n        var params = bidRequest.params;\n        var size = parseSizes(bidRequest);\n\n        var _data = {\n          page_url: page_url,\n          resolution: _getScreenResolution(),\n          account_id: params.accountId,\n          integration: INTEGRATION,\n          'x_source.tid': bidRequest.transactionId,\n          timeout: bidderRequest.timeout - (Date.now() - bidderRequest.auctionStart + TIMEOUT_BUFFER),\n          stash_creatives: true,\n          ae_pass_through_parameters: params.video.aeParams,\n          rp_secure: bidRequest.params.secure !== false,\n          slots: []\n        };\n\n        // Define the slot object\n        var slotData = {\n          site_id: params.siteId,\n          zone_id: params.zoneId,\n          position: parsePosition(params.position),\n          floor: parseFloat(params.floor) > 0.01 ? params.floor : 0.01,\n          element_id: bidRequest.adUnitCode,\n          name: bidRequest.adUnitCode,\n          language: params.video.language,\n          width: size[0],\n          height: size[1],\n          size_id: params.video.size_id\n        };\n\n        if (params.inventory && _typeof(params.inventory) === 'object') {\n          slotData.inventory = params.inventory;\n        }\n\n        if (params.keywords && Array.isArray(params.keywords)) {\n          slotData.keywords = params.keywords;\n        }\n\n        if (params.visitor && _typeof(params.visitor) === 'object') {\n          slotData.visitor = params.visitor;\n        }\n\n        _data.slots.push(slotData);\n\n        if (gdprConsent) {\n          // add 'gdpr' only if 'gdprApplies' is defined\n          if (typeof gdprConsent.gdprApplies === 'boolean') {\n            _data.gdpr = Number(gdprConsent.gdprApplies);\n          }\n          _data.gdpr_consent = gdprConsent.consentString;\n        }\n\n        return {\n          method: 'POST',\n          url: VIDEO_ENDPOINT,\n          data: _data,\n          bidRequest: bidRequest\n        };\n      }\n\n      // non-video request builder\n      var _bidRequest$params = bidRequest.params,\n          accountId = _bidRequest$params.accountId,\n          siteId = _bidRequest$params.siteId,\n          zoneId = _bidRequest$params.zoneId,\n          position = _bidRequest$params.position,\n          floor = _bidRequest$params.floor,\n          keywords = _bidRequest$params.keywords,\n          visitor = _bidRequest$params.visitor,\n          inventory = _bidRequest$params.inventory,\n          userId = _bidRequest$params.userId,\n          _bidRequest$params$la = _bidRequest$params.latLong;\n      _bidRequest$params$la = _bidRequest$params$la === undefined ? [] : _bidRequest$params$la;\n\n      var _bidRequest$params$la2 = _slicedToArray(_bidRequest$params$la, 2),\n          latitude = _bidRequest$params$la2[0],\n          longitude = _bidRequest$params$la2[1];\n\n      // defaults\n\n\n      floor = (floor = parseFloat(floor)) > 0.01 ? floor : 0.01;\n      position = position || 'btf';\n\n      // use rubicon sizes if provided, otherwise adUnit.sizes\n      var parsedSizes = parseSizes(bidRequest);\n\n      // using array to honor ordering. if order isn't important (it shouldn't be), an object would probably be preferable\n      var data = ['account_id', accountId, 'site_id', siteId, 'zone_id', zoneId, 'size_id', parsedSizes[0], 'alt_size_ids', parsedSizes.slice(1).join(',') || undefined, 'p_pos', position, 'rp_floor', floor, 'rp_secure', isSecure() ? '1' : '0', 'tk_flint', INTEGRATION, 'x_source.tid', bidRequest.transactionId, 'p_screen_res', _getScreenResolution(), 'kw', keywords, 'tk_user_key', userId, 'p_geo.latitude', isNaN(parseFloat(latitude)) ? undefined : parseFloat(latitude).toFixed(4), 'p_geo.longitude', isNaN(parseFloat(longitude)) ? undefined : parseFloat(longitude).toFixed(4)];\n\n      if (gdprConsent) {\n        // add 'gdpr' only if 'gdprApplies' is defined\n        if (typeof gdprConsent.gdprApplies === 'boolean') {\n          data.push('gdpr', Number(gdprConsent.gdprApplies));\n        }\n        data.push('gdpr_consent', gdprConsent.consentString);\n      }\n\n      if (visitor !== null && (typeof visitor === 'undefined' ? 'undefined' : _typeof(visitor)) === 'object') {\n        utils._each(visitor, function (item, key) {\n          return data.push('tg_v.' + key, item);\n        });\n      }\n\n      if (inventory !== null && (typeof inventory === 'undefined' ? 'undefined' : _typeof(inventory)) === 'object') {\n        utils._each(inventory, function (item, key) {\n          return data.push('tg_i.' + key, item);\n        });\n      }\n\n      data.push('rand', Math.random(), 'rf', page_url);\n\n      data = data.concat(_getDigiTrustQueryParams());\n\n      data = data.reduce(function (memo, curr, index) {\n        return index % 2 === 0 && data[index + 1] !== undefined && !isNaN(data[index + 1]) ? memo + curr + '=' + encodeURIComponent(data[index + 1]) + '&' : memo;\n      }, '').slice(0, -1); // remove trailing &\n\n      return {\n        method: 'GET',\n        url: FASTLANE_ENDPOINT,\n        data: data,\n        bidRequest: bidRequest\n      };\n    });\n  },\n  /**\n   * Test if bid has mediaType or mediaTypes set for video.\n   * note: 'mediaType' has been deprecated, however support will remain for a transitional period\n   * @param {BidRequest} bidRequest\n   * @returns {boolean}\n   */\n  hasVideoMediaType: function hasVideoMediaType(bidRequest) {\n    return typeof utils.deepAccess(bidRequest, 'params.video.size_id') !== 'undefined' && (bidRequest.mediaType === _mediaTypes.VIDEO || utils.deepAccess(bidRequest, 'mediaTypes.' + _mediaTypes.VIDEO + '.context') === 'instream');\n  },\n  /**\n   * @param {*} responseObj\n   * @param {BidRequest} bidRequest\n   * @return {Bid[]} An array of bids which\n   */\n  interpretResponse: function interpretResponse(responseObj, _ref) {\n    var bidRequest = _ref.bidRequest;\n\n    responseObj = responseObj.body;\n    var ads = responseObj.ads;\n\n    // check overall response\n    if ((typeof responseObj === 'undefined' ? 'undefined' : _typeof(responseObj)) !== 'object' || responseObj.status !== 'ok') {\n      return [];\n    }\n\n    // video ads array is wrapped in an object\n    if ((typeof bidRequest === 'undefined' ? 'undefined' : _typeof(bidRequest)) === 'object' && spec.hasVideoMediaType(bidRequest) && (typeof ads === 'undefined' ? 'undefined' : _typeof(ads)) === 'object') {\n      ads = ads[bidRequest.adUnitCode];\n    }\n\n    // check the ad response\n    if (!Array.isArray(ads) || ads.length < 1) {\n      return [];\n    }\n\n    // if there are multiple ads, sort by CPM\n    ads = ads.sort(_adCpmSort);\n\n    return ads.reduce(function (bids, ad) {\n      if (ad.status !== 'ok') {\n        return [];\n      }\n\n      var bid = {\n        requestId: bidRequest.bidId,\n        currency: 'USD',\n        creativeId: ad.creative_id,\n        cpm: ad.cpm || 0,\n        dealId: ad.deal,\n        ttl: 300, // 5 minutes\n        netRevenue: _config.config.getConfig('rubicon.netRevenue') || false,\n        rubicon: {\n          advertiserId: ad.advertiser,\n          networkId: ad.network\n        }\n      };\n\n      if (ad.creative_type) {\n        bid.mediaType = ad.creative_type;\n      }\n\n      if (ad.creative_type === _mediaTypes.VIDEO) {\n        bid.width = bidRequest.params.video.playerWidth;\n        bid.height = bidRequest.params.video.playerHeight;\n        bid.vastUrl = ad.creative_depot_url;\n        // WIKIA_CHANGE: Extend Rubicon bid\n        bid.rubiconAdId = ad.ad_id;\n        bid.rubiconAdvertiserId = ad.advertiser;\n        bid.descriptionUrl = ad.impression_id;\n        bid.impression_id = ad.impression_id;\n        bid.videoCacheKey = ad.impression_id;\n      } else {\n        bid.ad = _renderCreative(ad.script, ad.impression_id);\n\n        var _sizeMap$ad$size_id$s = sizeMap[ad.size_id].split('x').map(function (num) {\n          return Number(num);\n        });\n\n        var _sizeMap$ad$size_id$s2 = _slicedToArray(_sizeMap$ad$size_id$s, 2);\n\n        bid.width = _sizeMap$ad$size_id$s2[0];\n        bid.height = _sizeMap$ad$size_id$s2[1];\n      }\n\n      // add server-side targeting\n      bid.rubiconTargeting = (Array.isArray(ad.targeting) ? ad.targeting : []).reduce(function (memo, item) {\n        memo[item.key] = item.values[0];\n        return memo;\n      }, { 'rpfl_elemid': bidRequest.adUnitCode });\n\n      bids.push(bid);\n\n      return bids;\n    }, []);\n  },\n  getUserSyncs: function getUserSyncs(syncOptions, responses, gdprConsent) {\n    if (!hasSynced && syncOptions.iframeEnabled) {\n      // data is only assigned if params are available to pass to SYNC_ENDPOINT\n      var params = '';\n\n      if (gdprConsent && typeof gdprConsent.consentString === 'string') {\n        // add 'gdpr' only if 'gdprApplies' is defined\n        if (typeof gdprConsent.gdprApplies === 'boolean') {\n          params += '?gdpr=' + Number(gdprConsent.gdprApplies) + '&gdpr_consent=' + gdprConsent.consentString;\n        } else {\n          params += '?gdpr_consent=' + gdprConsent.consentString;\n        }\n      }\n\n      hasSynced = true;\n      return {\n        type: 'iframe',\n        url: SYNC_ENDPOINT + params\n      };\n    }\n  }\n};\n\nfunction _adCpmSort(adA, adB) {\n  return (adB.cpm || 0.0) - (adA.cpm || 0.0);\n}\n\nfunction _getScreenResolution() {\n  return [window.screen.width, window.screen.height].join('x');\n}\n\nfunction _getDigiTrustQueryParams() {\n  function getDigiTrustId() {\n    var digiTrustUser = window.DigiTrust && (_config.config.getConfig('digiTrustId') || window.DigiTrust.getUser({ member: 'T9QSFKPDN9' }));\n    return digiTrustUser && digiTrustUser.success && digiTrustUser.identity || null;\n  }\n\n  var digiTrustId = getDigiTrustId();\n  // Verify there is an ID and this user has not opted out\n  if (!digiTrustId || digiTrustId.privacy && digiTrustId.privacy.optout) {\n    return [];\n  }\n  return ['dt.id', digiTrustId.id, 'dt.keyv', digiTrustId.keyv, 'dt.pref', 0];\n}\n\nfunction _renderCreative(script, impId) {\n  return '<html>\\n<head><script type=\\'text/javascript\\'>inDapIF=true;</script></head>\\n<body style=\\'margin : 0; padding: 0;\\'>\\n<!-- Rubicon Project Ad Tag -->\\n<div data-rp-impression-id=\\'' + impId + '\\'>\\n<script type=\\'text/javascript\\'>' + script + '</script>\\n</div>\\n</body>\\n</html>';\n}\n\nfunction parseSizes(bid) {\n  var params = bid.params;\n  if (spec.hasVideoMediaType(bid)) {\n    var size = [];\n    if (params.video && params.video.playerWidth && params.video.playerHeight) {\n      size = [params.video.playerWidth, params.video.playerHeight];\n    } else if (Array.isArray(bid.sizes) && bid.sizes.length > 0 && Array.isArray(bid.sizes[0]) && bid.sizes[0].length > 1) {\n      size = bid.sizes[0];\n    }\n    return size;\n  }\n\n  // deprecated: temp legacy support\n  var sizes = Array.isArray(params.sizes) ? params.sizes : mapSizes(bid.sizes);\n\n  return masSizeOrdering(sizes);\n}\n\nfunction mapSizes(sizes) {\n  return utils.parseSizesInput(sizes)\n  // map sizes while excluding non-matches\n  .reduce(function (result, size) {\n    var mappedSize = parseInt(sizeMap[size], 10);\n    if (mappedSize) {\n      result.push(mappedSize);\n    }\n    return result;\n  }, []);\n}\n\nfunction parsePosition(position) {\n  if (position === 'atf' || position === 'btf') {\n    return position;\n  }\n  return 'unknown';\n}\n\nfunction masSizeOrdering(sizes) {\n  var MAS_SIZE_PRIORITY = [15, 2, 9];\n\n  return sizes.sort(function (first, second) {\n    // sort by MAS_SIZE_PRIORITY priority order\n    var firstPriority = MAS_SIZE_PRIORITY.indexOf(first);\n    var secondPriority = MAS_SIZE_PRIORITY.indexOf(second);\n\n    if (firstPriority > -1 || secondPriority > -1) {\n      if (firstPriority === -1) {\n        return 1;\n      }\n      if (secondPriority === -1) {\n        return -1;\n      }\n      return firstPriority - secondPriority;\n    }\n\n    // and finally ascending order\n    return first - second;\n  });\n}\n\nvar hasSynced = false;\n\nfunction resetUserSync() {\n  hasSynced = false;\n}\n\nfunction isNaN(value) {\n  // eslint-disable-next-line no-self-compare\n  return value !== value;\n}\n\n(0, _bidderFactory.registerBidder)(spec);\n\n/***/ }),\n\n/***/ 362:\n/***/ (function(module, exports) {\n\n\n\n/***/ })\n\n},[360]);\n\npbjs.processQueue();\n//# sourceMappingURL=prebid.js.map\n"],"sourceRoot":""}